_borschik("fgB3F")&&(window.MOUSE_TRACKING=function(){function t(t){return function(){try{return t.apply(this,arguments)}catch(t){}}}function e(e,n){return window.setTimeout(t(e),n)}function n(e,n){return window.setInterval(t(e),n)}var i=$(window),r=$(document),s=$.extend({ATTENTION_MIN_DURATION:1e3,ATTENTION_MAX_INTERRUPT:6e4,VIEWPORT_CHANGE_TIMEOUT:500,REQID_CHECK_INTERVAL:1e3,ALIVE_PACKET_ENABLED:!0,ALIVE_PACKET_INTERVAL:3e3,SENDER_MAX_REQUEST_COUNT:60,SENDER_MAX_PACKET_SIZE:1e3,SENDER_REQUEST_INTERVAL:1e4,SENDER_REQUEST_CACHE_TIMEOUT:3e4,COORDINATES_SCALE:1,MOUSEMOVE_LOG:1},window.MOUSE_TRACKING_SETTINGS||{});i.one("load",t(function(){function o(){return(new Date).getTime()}function u(){return Math.round((o()-g)/l)}function a(t,e){t.push(255&e)}function h(t,e){for(e=Math.max(0,0|e);e>127;)t.push(127&e|128),e>>=7;t.push(e)}function c(t,e){for(var n=!1,i=0,r=e.length;i<r;i++){var s=e.charCodeAt(i);s<128?t.push(s):n=!0}if(n){var o=new Error("Mouse tracking: baobabId must be US-ASCII");o.additional={baobabId:e},window.logSerpJsError(o)}t.push(0)}function _(t){try{return window.BEM&&BEM.blocks["i-global"].param(t)}catch(t){return""}}function d(t){return Math.floor(t*s.COORDINATES_SCALE)}function E(t){var e=[];return a(e,t),h(e,u()),e}var l=50,f=10,g=o(),p=101,m=102,T=103,S=104,I=105,A=106,v=107,R=108,w={attention:function(t,e,n){var i=[];return a(i,m),h(i,t),h(i,e),h(i,n),i},serpItem:function(t,e,n,i){t=$(t);var r=[],s=t.offset();return i?c(r,e):h(r,e),h(r,n),h(r,d(s.left)),h(r,d(s.top)),h(r,d(t.outerWidth())),h(r,d(t.outerHeight())),r},serpItems:function(t,e,n,i){var r=[];a(r,i?R:p),h(r,u()),h(r,t),h(r,e),h(r,n.length);for(var s=0,o=n.length;s<o;s++)$.merge(r,w.serpItem(n[s][0],n[s][1],n[s][2],i));return r},viewport:function(t){var e=[];return a(e,T),h(e,u()),h(e,d(t[0])),h(e,d(t[1])),h(e,d(t[2])),h(e,d(t[3])),e},mouseClick:function(t,e,n,i){var r=[];return a(r,S),h(r,u()),h(r,d(t)),h(r,d(e)),h(r,n),h(r,i),r},alive:function(){return E(I)},windowFocus:function(){return E(v)},windowBlur:function(){return E(A)}},N=function(t){$.extend(this,t||{}),this._active=!0,this._timeLast=this.timeStart,this.mouseMove(this.serpItem,this.timeStart)};N.prototype={grabberDom:null,sender:null,serpItem:null,timeStart:0,mouseMove:function(t,e){return this.serpItem&&t===this.serpItem&&(e-this._timeLast)*l<s.ATTENTION_MAX_INTERRUPT?(this._timeLast=e,!0):(this.close(),!1)},close:function(){if(this._active&&(this._active=!1,"undefined"!=typeof this._timeLast&&"undefined"!=typeof this.timeStart&&this.serpItem&&this.sender)){var t=this._timeLast-this.timeStart;if(t*l>s.ATTENTION_MIN_DURATION){var e=this.grabberDom.elements.index(this.serpItem);e>-1&&this.sender.enqueue(w.attention,[this.timeStart,t,e])}}}};var M=function(t){this.sender=t,this._pageTimestamp=o(),this.updateDom(),n(this.updateDom.bind(this),s.REQID_CHECK_INTERVAL)};M.prototype={reqid:"",updateDom:$.throttle(function(){var t=_("reqid");this.reqid!==t&&(this.reqid=t,s.USE_LOG_NODE&&this._grabDOM(!0),s.NOT_USE_CID||this._grabDOM(!1),this.grabViewport())}),_grabDOM:function(t){this.elements=$("[data-cid]");var e=this.elements.toArray().map(function(e){return e=$(e),t?[e,e.attr("data-log-node"),0]:[e,parseInt(e.attr("data-cid"))+1,0]},this);e.length>0&&this.sender.enqueue(w.serpItems,[l,this._pageTimestamp,e,t])},grabViewport:$.throttle(function(){var t=[i.scrollLeft(),i.scrollTop(),i.width(),i.height()];this.sender.enqueue(w.viewport,[t])},f)};var C=function(){this._ls=null;try{this._ls=localStorage}catch(t){}};C.prototype={set:function(t,e){if(this.isEnabled())try{!e||$.isArray(e)&&!e.length?this.remove(t):this._ls.setItem(this._getLsKey(t),JSON.stringify(e))}catch(t){}},get:function(t){if(this.isEnabled())try{return JSON.parse(this._ls.getItem(this._getLsKey(t)))}catch(t){}return null},remove:function(t){if(this.isEnabled())try{this._ls.removeItem(this._getLsKey(t))}catch(t){}},isEnabled:function(){return this._ls&&"object"==typeof this._ls&&"object"==typeof JSON},_getLsKey:function(t){return"_mt__"+t}};var O={abc:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%-_",encode:function(t){for(var e,n=O.abc,i=t.length,r=[],s=i-i%3,o=0;o<s;o+=3)e=(t[o]<<16)+(t[o+1]<<8)+t[o+2],r.push(n[e>>18&63],n[e>>12&63],n[e>>6&63],n[63&e]);switch(i-s){case 1:e=t[s]<<4,r.push(n[e>>6&63],n[63&e],n[64],n[64]);break;case 2:e=(t[s]<<10)+(t[s+1]<<2),r.push(n[e>>12&63],n[e>>6&63],n[63&e],n[64])}return r.join("")}},D=function(t){$.extend(this,t||{}),this._started=!1,this._countRequestSent=this.countRequestSentInit||0,this._packetQueue=this.packetQueueInit||[]};D.prototype={requestsTimeout:s.SENDER_REQUEST_INTERVAL,reqid:"",countRequestSentInit:0,packetQueueInit:null,enqueue:function(t,e){if(this.reqid&&this.hasQuota()&&this._packetQueue.length<s.SENDER_MAX_PACKET_SIZE){var n=t.apply(this,e);if(n)return $.merge(this._packetQueue,n),this._dumpToStorage(),this.start(),!0}return!1},flush:function(){if(this.reqid){var t=this._packetQueue.slice(0,s.SENDER_MAX_PACKET_SIZE),e=O.encode(t);s.USE_BAOBAB?b(null,{nodeId:Ya.SerpContext.clckId,event:"tech",type:"mousetracking",data:{no:this._countRequestSent+1,blob:e}}):this._sendRedir(this.reqid,"690.491.59","-no="+(this._countRequestSent+1)+",-blob="+e),this._packetQueue=[],this._dumpToStorage(),this._countRequestSent++}},send:function(t,e){var n=new Image;n.onload=e||$.noop,n.src=t},start:function(){if(!this._started){this._started=!0;var t=this;e(function(){t.flush(),t._started=!1,t.hasQuota()&&t._packetQueue.length>0&&t.start()},this.requestsTimeout)}},hasQuota:function(){return this._countRequestSent<s.SENDER_MAX_REQUEST_COUNT},_sendRedir:function(t,e,n){var i=_("click-host");if(t&&i){var r=i+"/click/reqid="+t+"/path="+e+(n?"/vars="+n:"")+"/*"+(_("retpath")||"http://yandex.ru/");this.send(r)}},_dumpToStorage:$.throttle(function(){if(this.storage&&this.storage.isEnabled()){var t=this.storage.get("data")||{};if(this._packetQueue.length>0){var e=this._packetQueue.slice(0,s.SENDER_MAX_PACKET_SIZE);t[this.reqid]=[e,o(),this._countRequestSent]}else delete t[this.reqid];this.storage.set("data",t)}},f)};var q=function(){this._senders={},this.storage=new C,this.sendAllFromStorage(),e(this.sendAllFromStorage.bind(this),s.SENDER_REQUEST_CACHE_TIMEOUT)};q.prototype={enqueue:function(t,e){var n=_("reqid");return!!n&&("object"!=typeof this._senders[n]&&(this._senders[n]=new D({reqid:n,storage:this.storage})),this._senders[n].enqueue(t,e))},sendAllFromStorage:function(){if(this.storage&&this.storage.isEnabled()){var t=this.storage.get("data")||{},e={};this.storage.set("data",{}),$.each(t,function(t,n){if($.isArray(n)){var i=n[0],r=n[1],u=n[2],a=o()-r;if(!(a<0||u<0||u>=s.SENDER_MAX_REQUEST_COUNT||!$.isArray(i)||i.length<1))if(a>s.SENDER_REQUEST_CACHE_TIMEOUT){var h=new D({reqid:t,requestsTimeout:0,countRequestSentInit:u,packetQueueInit:i});h.flush()}else n[0]=i.slice(0,s.SENDER_MAX_PACKET_SIZE),e[t]=n}}),this.storage.set("data",e)}}};var y=function(){this.grabberAttention=null,this.sender=new q,this.grabberDom=new M(this.sender),s.ALIVE_PACKET_ENABLED&&n(function(){this.sender.enqueue(w.alive)}.bind(this),s.ALIVE_PACKET_INTERVAL)};y.prototype={onMouseMove:function(t){var e=$(t).closest(this.grabberDom.elements).first(),n=u();e&&e.length>0?this.grabberAttention&&this.grabberAttention.mouseMove(e[0],n)||(this.grabberAttention=new N({serpItem:e[0],timeStart:n,sender:this.sender,grabberDom:this.grabberDom})):(this.grabberAttention&&this.grabberAttention.close(),this.grabberAttention=null)},onMouseClick:function(t,e,n,i){var r=$(t).closest(this.grabberDom.elements).first(),s=r?this.grabberDom.elements.index(r)+1:0;this.sender.enqueue(w.mouseClick,[e,n,s,i])},onWindowFocus:function(){this.sender.enqueue(w.windowFocus)},onWindowBlur:function(){this.sender.enqueue(w.windowBlur)}};var U=new y;s.MOUSEMOVE_LOG&&r.on("mousemove",$.throttle(t(function(t){U.onMouseMove(t.target)}),f)),r.on("click",t(function(t){U.onMouseClick(t.target,t.pageX,t.pageY,t.which)})),i.on("scroll resize",$.debounce(t(function(){U.grabberDom.grabViewport()}),s.VIEWPORT_CHANGE_TIMEOUT)).on("focus",t(function(){U.onWindowFocus()})).on("blur",t(function(){U.onWindowBlur()}))}))},window.$&&window.BEM?MOUSE_TRACKING():window.Ya&&Ya.define?Ya.define("mouse-tracking",["jquery","BEM"],MOUSE_TRACKING):!function(){function t(){var t,e=[],n=document.getElementsByTagName("script");for(t=0;t<n.length;t++){var i=n[t],r=i.src,s=i.id,o={};r&&(o.src=r),s&&(o.id=s),e.push(o)}return e}if(window.logSerpJsError){var e=new Error("Mouse tracking requires global $ and BEM, or Ya.define");e.additional={scripts:t()},logSerpJsError(e)}}());