(function(){try{(function(){var n={L_Fdbk_Submit:"Send feedback",L_Fdbk_GeneralCardInputHeader:"Share your likes, dislikes and suggestions about Bing Maps here…",L_Fdbk_GeneralCardTextWatermark:"To protect your privacy, don't include any personal information.",L_Fdbk_Exit:"Previous Version",L_Fdbk_Reminder:"Let us know what you think about Bing Maps.",L_Fdbk_Link:"Feedback",L_Fdbk_DlgHdr:"Help us improve this site by rating your experience and sharing your comments.",L_Fdbk_EmailWatermark:"Allows us to follow-up with you, if needed.",L_Fdbk_Comments:"Tell us more about your experience.",L_Fdbk_Other:"Something else",L_Fdbk_Email:"Email (optional)",L_Fdbk_PrivacyPolicyLink:"See our Privacy Policy",L_Fdbk_Business_More_Details:"Tell us more about the business",L_Fdbk_MapIssueDescription:"Tell us more about the problem",L_Fdbk_Problem:"Tell us the problem area",L_Fdbk_SubProblem:"Tell us the specific issue",L_Fdbk_AddressZipIncorrect:"Postal code is incorrect",L_Fdbk_AddressMissing:"Address is missing from road",L_Fdbk_AddressLocationIncorrect:"Address is in the wrong location",L_Fdbk_AddressSideIncorrect:"Address is on the wrong side of the road",L_Fdbk_AddressZipMissing:"Postal code is missing",L_Fdbk_AdminDistrictsCountryBoundary:"The boundary between countries/regions is incorrect",L_Fdbk_AdminDistrictsCountryName:"Country/Region has incorrect or missing name",L_Fdbk_AdminDistrictsCountyBoundary:"County boundaries incorrect.",L_Fdbk_AdminDistrictsCountyName:"County has missing or incorrect name",L_Fdbk_AdminDistrictsEntityMissing:"A political entity is missing (country/region, state/province, county...)",L_Fdbk_AdminDistrictsStateBoundary:"The boundary between states/provinces is incorrect",L_Fdbk_AdminDistrictsStateName:"State/province has incorrect or missing name",L_Fdbk_AdminDistrictsWrongEntity:"Political entity is wrong type",L_Fdbk_AirportIncorrect:"Airport is missing",L_Fdbk_AirportMissing:"Airport has incorrect or missing name",L_Fdbk_nameIncorrect:"Name is incorrect",L_Fdbk_MarkIncorrect:"Mark Incorrect",L_Fdbk_locationIncorrect:"Location is incorrect",L_Fdbk_AddressOfLocationIncorrect:"Address of this location is incorrect.",L_Fdbk_AirportWrongLocation:"Airport is in the wrong location",L_Fdbk_BridgeClosed:"Bridge is closed",L_Fdbk_BridgeMissing:"Bridge is missing",L_Fdbk_BridgeNameIncorrect:"Bridge name is incorrect or missing",L_Fdbk_BridgeRemoved:"Bridge needs to be removed",L_Fdbk_BridgeLocationIncorrect:"Bridge is in the wrong location",L_Fdbk_CityLocationIncorrect:"City location is incorrect",L_Fdbk_CityMissing:"City is missing",L_Fdbk_CityNameIncorrect:"City name is incorrect",L_Fdbk_CityNeighborhood:"City should be neighborhood",L_Fdbk_LandFeatureMissing:"Land feature is missing",L_Fdbk_LandFeatureNameIncorrect:"Name of land feature is incorrect",L_Fdbk_LandLocationIncorrect:"Land feature is in the wrong location",L_Fdbk_LandTypeIncorrect:"Land feature is the wrong type (eg: forest should be desert)",L_Fdbk_NeighborhoodCity:"Neighborhood should be city",L_Fdbk_NeighborhoodLocationIncorrect:"Neighborhood location is incorrect",L_Fdbk_NeighborhoodMissing:"Neighborhood is missing",L_Fdbk_NeighborhoodNameIncorrect:"Neighborhood name is incorrect",L_Fdbk_ProblemAddress:"Address",L_Fdbk_ProblemAdministrativeDistricts:"Country/Region/County",L_Fdbk_ProblemAirport:"Airport",L_Fdbk_ProblemBridge:"Bridge",L_Fdbk_ProblemCity:"City",L_Fdbk_ProblemLand:"Landform",L_Fdbk_ProblemNeighborhood:"Neighborhood",L_Fdbk_ProblemRoad:"Roads",L_Fdbk_ProblemWater:"Waterbody",L_Fdbk_RoadClosed:"Road is closed",L_Fdbk_RoadLocationIncorrect:"Road location is incorrect",L_Fdbk_RoadMissing:"Road is missing",L_Fdbk_RoadNameIncorrect:"Road name is incorrect or missing",L_Fdbk_RoadOneWay:"Road should be one way",L_Fdbk_RoadOneWayOpposite:"Road is one way in the wrong directions",L_Fdbk_RoadRemove:"Road needs to be removed",L_Fdbk_RoadTwoWay:"Road should be two way",L_Fdbk_RoadTypeIncorrect:"Road type is incorrect (highway vs street)",L_Fdbk_WaterLocationIncorrect:"Waterbody is in the incorrect location",L_Fdbk_WaterNameIncorrect:"Waterbody has incorrect name",L_Fdbk_WaterTypeIncorrect:"Incorrect type of Waterbody (eg: ocean should be sea)",L_Fdbk_WaterMissing:"Waterbody is missing",L_Fdbk_None:"None",L_Fdbk_SelectProblem:"Select ...",L_Fdbk_ReportAProblem:"Report a map problem",L_Fdbk_GeneralFeedback:"Tell us what you think",L_Fdbk_ActiveCard:"Problem with {0}",L_Fdbk_DescribeProblem:"Describe the problem here",L_Fdbk_ShowOnMap:"Click on the map to place a pushpin on the problem area (Zoom by double-clicking)",L_Fdbk_Hdr:"Help us understand any problems you noticed with the map.",L_Fdbk_SelectSubProblem:"Select ...",L_Fdbk_SpecificMapIssue:"Did you encounter a specific problem on the map?",L_Fdbk_ReportAProblemOnMap:"Click here to report",L_Fdbk_NotProblemOnMap:"Not a problem on the map?",L_Fdbk_SendGeneralFeedback:"Tell us what you think",L_Fdbk_ReportSomethingElse:"Report something else",L_Fdbk_ReportAProblemOnSearchResult:"Report a Problem",L_Fdbk_HelpUsUnderstand:"Help us understand more about the problem.",L_Fdbk_Option_DidNotFind:"I was not looking for {0}",L_Fdbk_Option_IssueWithSearchResult:"Issue with {0}",L_Fdbk_SpecificIssueWith:"Tell us the specific issue with {0}",L_Fdbk_MovePinToCorrect_Message:"Drag the pushpin on the map to the correct location.",L_Fdbk_MovePinToCorrect_Message_For_Missing_Entity:"Drag the map pushpin to the business location.",L_Fdbk_DidNotFindLookingFor_Message:"What were you looking for?",L_Fdbk_TellUsAboutMissingBusiness_Message:"Enter business details",L_Fdbk_AddMissingBusinessCardTitle:"Add missing business",L_Fdbk_WhenISearch_Message:"When I searched for {0}, I was looking for",L_Fdbk_IfYouKnow_Message:"Drag the pushpin on the map to the correct location.",L_Fdbk_DontKnowWhere:"I don't know where this place is.",L_Fdbk_Pin_Not_Move_Reminder:"You have not yet moved the pushpin on the map to the correct location. Please move the pushpin to the location mentioned in your description.",L_Fdbk_Overall_Experience:"How was your overall experience?",L_Fdbk_Overall_Happy:"Happy",L_Fdbk_Overall_Unhappy:"Unhappy",L_Fdbk_Send:"Send",L_Fdbk_Submit_Text:"Submit",L_Fdbk_SubmitAnyway_Text:"Submit Anyway",L_Fdbk_Edit:"Edit",L_Fdbk_BackToEdit_Text:"Back To Edit",L_Fdbk_Dismiss_Text:"Dismiss",L_Fdbk_Dismiss:"Dismiss",L_Fdbk_Done:"Done",L_Fdbk_Next:"Next",L_Fdbk_ReturnToSearchResult:"return to search result",L_Fdbk_Back:"Back",L_Fdbk_NoFoundSelect:"Select...",L_Fdbk_NoFoundAddress:"An address",L_Fdbk_NoFoundBusiness:"A business",L_Fdbk_NoFoundPopulatedPlace:"A populated place (city, neighborhood, country/region, postcode, etc.)",L_Fdbk_NoFoundPopulatedOther:"Something else",L_Fdbk_Drag_Pin_Correct_Tip:"Drag to the correct location",L_Fdbk_Pushpin_Message:"Drag the pushpin on the map to describe the problem (if necessary).",L_Fdbk_ThankYou:"Thank you for submitting feedback!",L_Fdbk_ProblemType_Reminder:"Please select a problem type.",L_Fdbk_Pushpin_Reminder:"You have not yet moved the pushpin on the map to the problem area. Please move the pushpin to the location mentioned in your description.",L_Fdbk_Require_Alias_Reminder:"Please fill in employee alias.",L_Fdbk_GeneralFeedback_Reminder:"You have not filled out the feedback form. Please give us more information.",L_Fdbk_BusinessNotFound_RequiredFields_Missing_ErrorMessage:"Enter all the required fields",L_Fdbk_BusinessNotFound_PushpinNotMoved_ErrorMessage:"Move the pushpin on the map to the correct location",L_Fdbk_ReportAProblemOnMap_Reminder:"Please complete all required fields.",L_Fdbk_ReportAProblemOnMap_Required:"Required field",L_Fdbk_ReportNoFound_Required:"Required",L_Fdbk_ReportAProblemOnMap_RequiredSign:"*",L_Fdbk_Drag_Pin_Tip:"Drag to the location of the problem",L_Fdbk_Business_Name:"Name",L_Fdbk_Business_Name_Placeholder_Text:"Business Name",L_Fdbk_Business_Name_With_RequiredSign:"*Business Name",L_Fdbk_Business_Name_Required_Error_Message:"Enter Business Name",L_Fdbk_Business_Address:"Address",L_Fdbk_Business_Address_Required_Error_Message:"Enter Addressline / Street / Locality",L_Fdbk_Business_City_Required_Error_Message:"Enter City",L_Fdbk_Business_City:"City",L_Fdbk_Business_City_With_RequiredSign:"*City",L_Fdbk_Business_State:"State or Province",L_Fdbk_Business_State_PostalCode_Label:"State & Zip",L_Fdbk_Business_PostalCode:"Postal Code",L_Fdbk_Business_Phone:"Phone",L_Fdbk_Business_Website:"Website",L_Fdbk_Business_Closed:"Closed or doesn't exist",L_Fdbk_Business_NameIs:"{0} is:",L_Fdbk_Business_DetailsIncorrect:"Details Incorrect",L_Fdbk_Business_MarkIncorrect:"Details incorrect",L_Fdbk_Optional:"Optional",L_Fdbk_UserComments:"Comments",L_Fdbk_Business_Contact:"Phone",L_Fdbk_Business_PermanentlyClosed:"Permanently Closed",L_Fdbk_Business_DosentExist:"Doesn’t Exist",L_Fdbk_Business_Private:"Private",L_Fdbk_Business_Duplicate:"Duplicate",L_Fdbk_Business_Spam:"Spam",L_Fdbk_Provide_More_Feedback:"Additional details (Phone and Website)",L_Fdbk_New_ThankYou:"Thank you!",L_Fdbk_Bing_Better:"Your feedback helps make Bing better!",L_Fdbk_Map_Location:"Map Location",L_Fdbk_Add_Entity:"Are you trying to add a missing business?",L_Fdbk_Move_Pushpin:"Move Pushpin",L_Fdbk_UserComments_Alt:"Please provide additional details that can help us verify the business.",L_Menu_SuggestAnEdit_Link_Text:"Suggest an edit",L_Tooltip_Expand_Text:"Expand",L_Tooltip_Collapse_Text:"Collapse",L_Tooltip_Undo_Text:"Undo",L_Fdbk_Not_Avaliable:"Not Available",L_Fdbk_WrongDirections:"Wrong directions",L_Fdbk_LocationInDirectionsIncorrect:"{0} is in the wrong location",L_Fdbk_WhichStepIsWrong:"Which step is wrong?",L_Fdbk_AddStep:"Add step",L_Fdbk_BetterRoute:"I know of a better route that is not shown",L_Fdbk_IncorrectTimesTransit:"Incorrect times for transit services",L_Fdbk_IncorrectLocationTransitStop:"Incorrect location of a transit stop",L_Tooltip_Close_Text:"Close",L_Fdbk_Business_HoursOfOperation:"Hours of Operations",MarkIncorrect:"Mark Incorrect",AddHours:"Add hours",WhichDays:"Which days?",DayFriday:"Friday",DayFridayShort:"Fri",DayMonday:"Monday",DayMondayShort:"Mon",DaySaturday:"Saturday",DaySaturdayShort:"Sat",DaySunday:"Sunday",DaySundayShort:"Sun",DayThursday:"Thursday",DayThursdayShort:"Thu",DayTuesday:"Tuesday",DayTuesdayShort:"Tue",DayWednesday:"Wednesday",DayWednesdayShort:"Wed",ErrorIncorrectHours:"Close time can't be less than open time",ErrorMissingHours:"Add some hours",ErrorSelectDays:"Select which days",AddMoreHours:"Add more hours",ButtonUpdate:"Update",Open24x7:"Open 24 x 7",ButtonCancel:"Cancel",ButtonAdd:"Add",SendEmail:"Email me about my changes",DidYouMean:"Did you mean?",DidYouMeanThisPlace:"Wait, did you mean this place?",SimilarBusinessOnBing:"We found similar business on Bing!",RichAttributeFeedbackHeader:"Select features which describe this business.",L_FdbkEditButtonLabel:"Click to edit {0}"};window.$MicrosoftMaps8.ResourceManager?window.$MicrosoftMaps8.ResourceManager.init("Feedbacks",n):window.$MicrosoftMaps8.ResourcesObject=n})();var f=window.$MicrosoftMaps8,o=f.Internal,d=o.TaskData,tt=f.Anchor,or=o._BaseMapTemplateSelector,bt=o.BaseTask,it=o.BaseTaskViewModel,sr=f.BitmapImageTemplate,hr=o._ComponentNames,rt=o.Control,kt=o.ControlTemplate,a=f.DataHandlerKeys,ut=o._Debug,dt=f.DefaultTemplateSelector,b=d.DirectionsMode,gt=d.DistanceUnit,ni=o._EntryPoints,e=o._FeatureNames,u=f.GlobalConfig.features.feedback,cr=o.GeolocationProvider,r=o._Gimme,k=f.GlobalConfig,v=f.GlobalDataEventHandler,h=o._Helper,ft=f.ImageFromCssHelper,et=o._JSEvent,ti=f.CommonControls.ListDropdownViewModel,ot=f.LocalSearchEntity,lr=o._LocalStorageCache,c=o._LoggerConstants,ii=o.MapInteractionBehavior,s=o.MapHelper,w=f.Location,ri=f.MapsFeedback,ar=f.MapTypeId,vr=f.MapView,ui=f.CommonControls.ModalDialogViewModel,st=f.MoveableSimplePointPrimitive,g=o._Network,ht=o._ObservableObject,nt=o._ObservableCollection,ct=o._OverlayEntity,fi=o._Overlay,lt=f.Point,ei=f.CommonControls.PopOutButtonViewModel,yr=o.Permalink,pr=f.PrimitiveOverlayHelper,n=f.ResourceManager.Feedbacks,wr=o.ReverseGeocoder,oi=f.SimplePointPrimitive,br=o._TaskDataHandlerHelper,y=f.TaskTypes,at=d.TimeTypes,vt=f.VectorMapLayer,kr=f.ZoomLevel,si='<div class="bm_feedbackBetaButton" data-tag="Feedback.Button">    <a class="bm_feedbackBetaButtonLink" event:click="onFeedbackClick" event:mouseover="onMouseOver" event:mouseout="onMouseOut" href="#" id="mapsFeedback" aria-label="{TemplateBinding resources.L_Fdbk_Reminder}" role="button" data-tag="Feedback.Links.MapFeedback">        <div id="bm_feedbackBetaButtonIcon"><\/div>        <div id="bm_feedbackBetaButtonText">            <TextBlock Text="{TemplateBinding resources.L_Fdbk_Link}" />        <\/div>    <\/a><\/div>',hi='<div class="bm_feedbackDragOverlay" data-events-for="ms-composite">    <div class="feedbackDragPin" data-events-for="ms-composite" style:visibility="{Binding ShowPin Converter=boolToVisibility}"><\/div>    <div class="feedbackDragPinMessage" style:visibility="{Binding ShowTip Converter=boolToVisibility}">        <TextBlock Text="{Binding dragPinTip}"/>    <\/div><\/div>',ci='<div class="feedbackPanelRoot">    <div class="feedbackPanel">        <div class="returnArrowDiv" data-tag="returnArrowDiv">            <a class="commonButton backArrowButton feedbackBackButton" title="{Binding resources.L_Fdbk_Back}" event:click="onReturnToSearchResultClick" href="#" role="button"  data-tag="returnToSearchResultButton">                <div class="feedbackBackButtonText">                    <TextBlock Text="{Binding resources.L_Fdbk_Back}"/>                <\/div>            <\/a>        <\/div>        <div class="feedbackDivPanel" style:display="{Binding showFeedbackPanel Converter=boolToDisplay}" data-tag="directionsFeedbackDivPanel">            <div class="feedbackSubTittle">                <h3>                    <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnSearchResult}"/>                <\/h3>            <\/div>            <div class="feedbackCardInputDiv" data-tag="directionsIssueDropDownDiv">                <div class="feedbackCardLabel">                    <span class="labelDirectionsIssue">                        <TextBlock Text="{Binding resources.L_Fdbk_SubProblem}"/>                    <\/span>                <\/div>                <div class="feedbackSelect" data-tag="directionsIssueDropDown">                    <SelectControl ItemsSource="{Binding directionsIssueTypes}" SelectedItem="{Binding directionsIssueType Mode=TwoWay}" event:dropdown="onDropdown"/>                <\/div>            <\/div>            <div class="feedbackCardInputDiv" data-tag="directionStepsIssueDiv" style:display="{Binding showStepsDiv Converter=boolToDisplay}" >                <DraggableList ItemsSource="{Binding steps}">\t\t\t\t    <DraggableList.ItemTemplate>\t\t\t\t\t    <DataTemplate>                            <div>\t\t\t\t\t\t        <div class="feedbackCardInputDiv">                                    <div class="feedbackCardLabel">                                        <span class="labelDirectionsStepIssue">                                            <TextBlock Text="{Binding resources.L_Fdbk_WhichStepIsWrong}"/>                                        <\/span>                                    <\/div>                                    <div class="feedbackSelect" data-tag="directionsStepIssueDropDown">                                        <SelectControl ItemsSource="{Binding directionsSteps}" SelectedItem="{Binding directionsIssueStep Mode=TwoWay}" event:dropdown="onDropdown"/>                                    <\/div>                                <\/div>                                <div class="feedbackCardInputDiv" data-tag="commentsDirectionStepDiv">                                    <div class="feedbackCardLabel">                                        <TextBlock Text="{Binding resources.L_Fdbk_MapIssueDescription}"/>                                    <\/div>                                    <div class="feedbackCardText">                                        <textarea class="stepComments" rows="3" value="{Binding commentsDirectionsStep Mode=TwoWay}" maxlength="2000"/>                                    <\/div>                                <\/div>                            <\/div>\t\t\t\t\t    <\/DataTemplate>\t\t\t\t    <\/DraggableList.ItemTemplate>\t\t\t    <\/DraggableList>                            <a title="{Binding resources.L_Fdbk_AddStep}" class="fbDirStepAdd" href="#" event:click="onAddStepClick" data-tag="fbDirStepAdd"><\/a>            <\/div>            <div class="feedbackCardMovePinReminderDiv" style:display="{Binding showMovePushpinMessage Converter=boolToDisplay}" data-tag="movePushpinMessage">                <TextBlock Text="{Binding resources.L_Fdbk_MovePinToCorrect_Message}"/>            <\/div>            <div class="feedbackCardInputDiv" data-tag="commentsDirectionIssueDiv" style:display="{Binding showCommentsDiv Converter=boolToDisplay}" >                <div class="feedbackCardLabel" id="feedbackCardCommentsLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_MapIssueDescription}"/>                <\/div>                <div class="feedbackCardText">                    <textarea class="feedbackComments" rows="6" value="{Binding commentsDirectionsIssue Mode=TwoWay}" maxlength="2000" data-tag="commentsDirectionsIssue" aria-labelledby="feedbackCardCommentsLabel"/>                <\/div>            <\/div>            <div class="feedbackCardSearchResultButton">                <a class="textButton" title="{Binding resources.L_Fdbk_Send}" event:click="onDirectionsFeedbackSendClick" href="#" role="button" data-tag="resultFeedbackIssueSendButton">                    <TextBlock Text="{Binding resources.L_Fdbk_Send}"/>                <\/a>            <\/div>        <\/div>        <div class="feedbackDivPanel" style:display="{Binding showReportSomethingElsePanel Converter=boolToDisplay}" data-tag="reportSomethingElsePanel">            <div class="feedbackCardReportSomethingElseLink">                <a href="#" event:click="onReportSomethingElseLinkClick" data-tag="reportSomethingElseLink">                    <TextBlock Text="{Binding resources.L_Fdbk_ReportSomethingElse}"/>                <\/a>            <\/div>        <\/div>        <div class="thankYouPanel" style:display="{Binding showThankYouPanel Converter=boolToDisplay}" role="status" aria-expanded="{Binding showThankYouPanel}" data-tag="searchResulThankYouPanel">            <div class="thankYouMessage">                <TextBlock Text="{Binding resources.L_Fdbk_ThankYou}"/>            <\/div>        <\/div>        <div class="messagePanel" style:display="{Binding showMessagePanel Converter=boolToDisplay}" role="status" aria-expanded="{Binding showMessagePanel}" data-tag="searchResultMessagePanel">            <div class="reminderMessage" data-tag="searchResultReminderMessage">                <TextBlock Text="{Binding reminderMessage}"/>            <\/div>        <\/div>    <\/div><\/div>',li='<div class="feedbackPanelRoot">    <div class="feedbackPanel">        <div class="feedbackDivPanel" style:display="{Binding showGeneralFeedbackPanel Converter=boolToDisplay}" data-tag="generalFeedbackPanel">            <div class="generalFeedbackOverall">                <div class="feedbackCardLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_Overall_Experience}"/>                <\/div>                <div class="overallSelections">                    <a class="happyButton" title="{Binding resources.L_Fdbk_Overall_Happy}" href="#" event:click="onOverallHappyButtonClick" data-tag="overallFeedbackHappyButton" role="button" aria-pressed="{Binding happySelected}">                    <\/a>                    <a class="unhappyButton" title="{Binding resources.L_Fdbk_Overall_Unhappy}" href="#" event:click="onOverallUnhappyButtonClick" data-tag="overallFeedbackUnhappyButton" role="button" aria-pressed="{Binding unHappySelected}">                    <\/a>                <\/div>            <\/div>            <div class="feedbackCardInputDiv" data-tag="commentsGeneralDiv">                <div class="feedbackCardLabel" id="feedbackCardCommentsLabel">                    <TextBlock Text="{Binding newFeedbackInputHeader}"/>                <\/div>                <div class="feedbackCardText">                    <textarea class="feedbackComments" rows="6" placeholder="{Binding newFeedbackTextWatermark}" value="{Binding commentsGeneral Mode=TwoWay}" maxlength="2000" data-tag="commentsGeneral" aria-labelledby="feedbackCardCommentsLabel"/>                <\/div>            <\/div>            <div class="feedbackCardInputDiv" style:display="{Binding emailDisplay}" data-tag="emailDiv">                <div class="feedbackCardLabel" id="feedbackCardEmailLabel">                    <TextBlock Text="{Binding emailLabel}"/>                <\/div>                <div class="feedbackCardText">                    <input type="text" placeholder="{Binding resources.L_Fdbk_EmailWatermark}" value="{Binding email Mode=TwoWay}" maxlength="400" data-tag="email" aria-labelledby="feedbackCardEmailLabel"/>                <\/div>                <a href="{Binding privacyPolicyLink}" target="_blank" class="privacyPolicyLink" style:display="{Binding privacyPolicyLinkDisplay}" role="link">                    <TextBlock Text="{Binding resources.L_Fdbk_PrivacyPolicyLink}"/>                <\/a>            <\/div>            <div class="feedbackCardLink" data-tag="reportAProblemOnMapLinkDiv">                <div class="feedbackCardLabel" id="fdbkCardMapIssueLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_SpecificMapIssue}"/>                <\/div>                <a href="#" class="reportProblemOnMapLink" role="button" event:click="onReportAProblemOnMapClick" data-tag="reportAProblemOnMapLink" aria-labelledby="fdbkCardMapIssueLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnMap}"/>                <\/a>            <\/div>            <div class="feedbackCardFoot">                <a class="textButton" title="{Binding resources.L_Fdbk_Send}" event:click="onGeneralFeedbackSendClick" href="#" role="button" data-tag="generalFeedbackSendButton">                    <TextBlock Text="{Binding resources.L_Fdbk_Send}"/>                <\/a>            <\/div>        <\/div>        <div class="feedbackDivPanel" style:display="{Binding showProblemOnMapPanel Converter=boolToDisplay}" data-tag="problemOnMapPanel">            <div class="pushpinMessage">                <TextBlock Text="{Binding resources.L_Fdbk_Pushpin_Message}"/>            <\/div>            <div class="feedbackCardInputDiv problemSelect" data-tag="problemTypesDropDownDiv">                <div class="feedbackCardLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_Problem}"/>                    <span class="requireSign">                        <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnMap_RequiredSign}"/>                    <\/span>                <\/div>                <div class="feedbackSelect" data-tag="problemTypesDropDown">                    <SelectControl ItemsSource="{Binding problemTypes}" SelectedItem="{Binding problemType Mode=TwoWay}" event:dropdown="onDropdown"/>                <\/div>            <\/div>            <div class="feedbackCardInputDiv" data-tag="subProblemTypesDropDownDiv">                <div class="feedbackCardLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_SubProblem}"/>                <\/div>                <div class="feedbackSelect" data-tag="subProblemTypesDropDown">                    <SelectControl ItemsSource="{Binding subProblemTypes}" SelectedItem="{Binding subProblemType Mode=TwoWay}" event:dropdown="onDropdown"/>                <\/div>            <\/div>            <div class="feedbackCardInputDiv" data-tag="commentsBaseMapDiv">                <div class="feedbackCardLabel" id="feedbackCardIssueLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_MapIssueDescription}"/>                    <span class="requireSign">                        <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnMap_RequiredSign}"/>                    <\/span>                <\/div>                <div class="feedbackCardText">                    <textarea rows="6" class="feedbackDescribeProblem" placeholder="{Binding resources.L_Fdbk_DescribeProblem}" value="{Binding commentsBaseMap Mode=TwoWay}" maxlength="2000" data-tag="commentsBaseMap" aria-labelledby="feedbackCardIssueLabel"/>                <\/div>            <\/div>            <div class="requireMessage">                <span class="requireSign">                    <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnMap_RequiredSign}"/>                <\/span>                <span class="requireLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnMap_Required}"/>                <\/span>            <\/div>            <div class="feedbackCardLink" data-tag="sendGeneralFeedbackLinkDiv">                <div class="feedbackCardLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_NotProblemOnMap}"/>                <\/div>                <a href="#" event:click="onSendGeneralFeedbackClick" data-tag="sendGeneralFeedbackLink">                    <TextBlock Text="{Binding resources.L_Fdbk_SendGeneralFeedback}"/>                <\/a>            <\/div>            <div class="feedbackCardFoot">                <a class="textButton" title="{Binding resources.L_Fdbk_Send}" event:click="onProblemOnMapSendClick" href="#" role="button" data-tag="problemOnMapSendButton">                    <TextBlock Text="{Binding resources.L_Fdbk_Send}"/>                <\/a>            <\/div>        <\/div>        <div class="thankYouPanel" style:display="{Binding showThankYouPanel Converter=boolToDisplay}" role="status" aria-labelledby="thankYouMessageBase" aria-expanded="{Binding showThankYouPanel}" data-tag="thankYouPanel">            <div class="thankYouMessage" id="thankYouMessageBase">                <TextBlock Text="{Binding resources.L_Fdbk_ThankYou}"/>            <\/div>            <div class="feedbackCardFoot">                <a class="textButton thankYouPanel" title="{Binding resources.L_Fdbk_Done}" event:click="onFeedbackDoneClick" href="#" role="button" tabindex="0" data-tag="feedbackDoneButton">                    <TextBlock Text="{Binding resources.L_Fdbk_Done}"/>                <\/a>            <\/div>        <\/div>        <div class="messagePanel" style:display="{Binding showMessagePanel Converter=boolToDisplay}" role="status" aria-expanded="{Binding showMessagePanel}" data-tag="messagePanel">            <div class="reminderMessage" data-tag="reminderMessage">                <TextBlock Text="{Binding reminderMessage}"/>            <\/div>        <\/div>    <\/div><\/div>',ai='<div class="feedbackPanelRoot">    <div class="returnArrowDiv" style:display="{Binding showReturnArrowDiv Converter=boolToDisplay}" data-tag="returnArrowDiv">        <a class="commonButton backArrowButton feedbackBackButton" title="{Binding resources.L_Fdbk_ReturnToSearchResult}" event:click="onReturnToSearchResultClick" href="#" role="button" data-tag="returnToSearchResultButton">            <div class="feedbackBackButtonText">                <TextBlock Text="{Binding resources.L_Fdbk_ReturnToSearchResult}" />            <\/div>        <\/a>    <\/div>    <div id="raBody" class="RapPopUp_Body" style:display="{Binding showRichAttributePanel Converter=boolToDisplay}">        <div class="b_PopupTextAreaSection">            <span>                <TextBlock Text="{Binding resources.RichAttributeFeedbackHeader}" />            <\/span>        <\/div>        <div class="b_PopupButtonSection">            <ItemsControl ItemsSource="{Binding featureList}">                <ItemsControl.ItemTemplate>                    <DataTemplate>                        <div class="rafOption">                            <div class="rafOptionText">                                <TextBlock text="{Binding Name}" />                            <\/div>                            <ItemsControl ItemsSource="{Binding Value}">                                <ItemsControl.ItemTemplate>                                    <DataTemplate>                                        <div class="ra_CB_Div  ">                                            <label>                                                <input type="checkbox" id="{Binding Name}" class="ra_CB" />                                                <TextBlock text="{Binding Name}" />                                            <\/label>                                        <\/div>                                    <\/DataTemplate>                                <\/ItemsControl.ItemTemplate>                            <\/ItemsControl>                        <\/div>                    <\/DataTemplate>                <\/ItemsControl.ItemTemplate>            <\/ItemsControl>        <\/div>        <div class="b_PopupSubmitButtonSection">            <a id="rafDoneLink" class="btnCommon btnDone" title="{Binding resources.L_Fdbk_Submit_Text}" href="#" event:click="SubmitAndShowThankYou" role="button">                <TextBlock Text="{Binding resources.L_Fdbk_Submit_Text}" />            <\/a>        <\/div>    <\/div>    <div class="ra_ThankYouPanelDiv" id="raThankYouPanel" role="status" aria-expanded="{Binding showThankYouPanel}" style:display="{Binding showThankYouPanel Converter=boolToDisplay}">        <div class="ra_ThankYou">            <TextBlock Text="{Binding resources.L_Fdbk_New_ThankYou}" />        <\/div>        <div class="ra_ThankYouMessage">            <TextBlock Text="{Binding resources.L_Fdbk_Bing_Better}" />        <\/div>    <\/div><\/div>',vi='<div class="feedbackPanelRoot">    <div class="returnArrowDiv"  style:display="{Binding showReturnArrowDiv Converter=boolToDisplay}" data-tag="returnArrowDiv">        <a class="commonButton backArrowButton feedbackBackButton" title="{Binding resources.L_Fdbk_ReturnToSearchResult}" event:click="onReturnToSearchResultClick" href="#" role="button"  data-tag="returnToSearchResultButton">            <div class="feedbackBackButtonText">                <TextBlock Text="{Binding resources.L_Fdbk_ReturnToSearchResult}"/>            <\/div>        <\/a>    <\/div>    <div class="addMissingBusinessDiv" style:display="{Binding showAddMissingEntityLink Converter=boolToDisplay}" id="showAddMissingEntityLinkDiv">        <div style="margin-top: 16px;position:absolute;left:15px">                            <a class="labelAddMissingEntityLink" role="button" event:click="addMissingEntityLinkClicked" href="#" id="labelAddMissingEntityLinkId" aria-label="{Binding resources.L_Fdbk_Add_Entity}">                <TextBlock Text="{Binding resources.L_Fdbk_Add_Entity}" style="margin-left:20px"/>            <\/a>        <\/div>                <\/div>        <div style="margin-top: 40px" style:display="{Binding showBasicOptions} Converter=boolToDisplay}" id="showBasicOptionsDiv">        <span style="margin-bottom:0px" class="labelDisplayBusinessNameIs"><\/span>        <div id="isClosedOptions" style="margin-top: 8px;margin-left: 20px" role="radiogroup">            <label>                <input type="radio" id="permanentlyClosed" class="radio" checked="{Binding isPermClosed Mode=TwoWay}" event:change="businessClosed" name="isClosedOptions" data-tag="isClosedOptions" role="radio" aria-checked="{Binding isPermClosed}"/>                <TextBlock text="{Binding resources.L_Fdbk_Business_PermanentlyClosed}" />            <\/label>            <label>                <input type="radio" id="detailsIncorrect" class="radio" checked="{Binding isMarkedDetailsIncorrect Mode=TwoWay}" event:change="detailsIncorrect" name="isClosedOptions" data-tag="isClosedOptions" role="radio" aria-checked="{Binding isMarkedDetailsIncorrect}"/>                <TextBlock text="{Binding resources.L_Fdbk_Business_MarkIncorrect}" />            <\/label>        <\/div>    <\/div>    <div id="expandIncorrectOptionsText" class="pleft10">        <div class="markWrongLabel">            <TextBlock text="{Binding resources.MarkIncorrect}" />        <\/div>    <\/div>    <div id="suggestionsDiv">        <textarea class="dummyfocus" style:display="none" tabindex="-1"><\/textarea>        <div style="margin-top: 26px;" id="showNameOptionsDiv">            <div class="fbDonotKnowWhere" style="margin-top: 8px;margin-left:20px">                <TextBlock Text="{Binding resources.L_Fdbk_Business_Name}" style="margin-left:20px"/>                <div class="markWrong">                    <label>                        <input type="checkbox" id="nameWrong" event:change="businessNameMarkIncorrect" value="{Binding isNameMarkIncorrect Mode=TwoWay}" aria-label="{Binding resources.L_Fdbk_Business_Name}" aria-checked="{Binding isNameMarkIncorrect}"/>                    <\/label>                <\/div>            <\/div>            <div style="margin-top: 8px; margin-left: 20px">                <a class="labelDisplayBusinessName" role="button" event:click="businessNameClicked" href="#" id="businessDisplayNameId" aria-label="{Binding resources.L_Fdbk_Business_Name Converter=completeLabel}"><\/a>            <\/div>            <div style="margin-top: 8px; margin-left: 20px;">                <input type="text" style="margin-top:8px; padding-bottom:3px" class="fbBusinessName" value="{Binding businessName Mode=TwoWay}" maxlength="400" id="fbBusinessName"/>            <\/div>        <\/div>        <div style="margin-top:16px;" id="showAddressOptionsDiv">            <div class="fbDonotKnowWhere" style="margin-top: 8px;margin-left:20px">                <TextBlock Text="{Binding resources.L_Fdbk_Business_Address}" style=""/>                <div class="markWrong">                    <label>                        <input type="checkbox" id="addressWrong" event:change="businessAddressMarkIncorrect" value="{Binding isAddressMarkIncorrect Mode=TwoWay}" aria-label="{Binding resources.L_Fdbk_Business_Address}" aria-checked="{Binding isAddressMarkIncorrect}" />                    <\/label>                <\/div>            <\/div>            <div style="margin-top: 8px; margin-left: 20px">                <a class="labelDisplayBusinessAddress" role="button" event:click="businessAddressClicked" href="#" id="businessDisplayAddressId" aria-label="{Binding resources.L_Fdbk_Business_Address Converter=completeLabel}"><\/a>             <\/div>             <div style="margin-top: 8px; margin-left: 20px;">                <input type="text" style="margin-top:8px;padding-bottom:3px"  class="fbBusinessAddress" placeholder="{Binding resources.L_Fdbk_Business_Address}" value="{Binding businessAddress Mode=TwoWay}" maxlength="400" id="fbBusinessAddress"/>                <input type="text" style="margin-top:8px;padding-bottom:3px" class="fbBusinessCity" placeholder="{Binding resources.L_Fdbk_Business_City}" value="{Binding businessCity Mode=TwoWay}" maxlength="400" id="fbBusinessCity"/>                <input type="text"  style="margin-top:8px;padding-bottom:3px" class="fbBusinessState" placeholder="{Binding resources.L_Fdbk_Business_State}" value="{Binding businessState Mode=TwoWay}" maxlength="400" id="fbBusinessState"/>                <input type="text" style="margin-top:8px;padding-bottom:3px" class="fbBusinessPostalCode" placeholder="{Binding resources.L_Fdbk_Business_PostalCode}" value="{Binding businessPostalCode Mode=TwoWay}"maxlength="400" data-tag="fbBusinessPostalCode" id="fbBusinessPostalCode"/>            <\/div>        <\/div>        <div style="margin-top: 16px;"  id="showContactOptionsDiv">            <div class="fbDonotKnowWhere" style="margin-top: 8px;margin-left:20px">                <TextBlock Text="{Binding resources.L_Fdbk_Business_Contact}" style=""/>                <div class="markWrong">                    <label>                        <input type="checkbox" id="phoneWrong" event:change="businessPhoneMarkIncorrect" value="{Binding isPhoneMarkIncorrect Mode=TwoWay}" aria-label="{Binding resources.L_Fdbk_Business_Contact}" aria-checked="{Binding isPhoneMarkIncorrect}"/>                    <\/label>                <\/div>            <\/div>             <div style="margin-top: 8px; margin-left: 20px">                <a class="labelDisplayBusinessPhone" role="button" event:click="businessPhoneClicked" href="#" id="businessDisplayPhoneId" aria-label="{Binding resources.L_Fdbk_Business_Contact Converter=completeLabel}"><\/a>             <\/div>            <div style="margin-top: 8px; margin-left: 20px;">                <input type="text"  style="margin-top:8px;padding-bottom:3px" class="fbBusinessPhone" value="{Binding businessPhone Mode=TwoWay}" maxlength="400" id="fbBusinessPhone"/>            <\/div>        <\/div>        <div style="margin-top:16px;" id="showWebsiteOptionsDiv">            <div class="fbDonotKnowWhere" style="margin-top: 8px;margin-left:20px">                <TextBlock Text="{Binding resources.L_Fdbk_Business_Website} " style="margin-left:20px"/>                <div class="markWrong">                    <label>                        <input type="checkbox" id="websiteWrong" event:change="businessWebsiteMarkIncorrect" value="{Binding isWebsiteMarkIncorrect Mode=TwoWay}" aria-label="{Binding resources.L_Fdbk_Business_Website}" aria-checked="{Binding isWebsiteMarkIncorrect}"/>                    <\/label>                <\/div>            <\/div>            <div style="margin-top: 8px; margin-left: 20px">                <a class="labelDisplayBusinessWebsite" role="button" event:click="businessWebsiteClicked" href="#" id="labelDisplayBusinessWebsiteId" aria-label="{Binding resources.L_Fdbk_Business_Website Converter=completeLabel}"><\/a>             <\/div>             <div style="margin-top: 8px; margin-left: 20px;">                <input type="text" style="margin-top:8px;padding-bottom:3px" class="fbBusinessWebsite" value="{Binding businessWebsite Mode=TwoWay}" maxlength="400" id="fbBusinessWebsite"/>             <\/div>        <\/div>        <div style="margin-top:16px;" style:display="{Binding showMapPinOptions} Converter=boolToDisplay}" id="showMapPinOptionsDiv">            <div class="fbDonotKnowWhere" style="margin-top: 8px;margin-left:20px">                <TextBlock Text="{Binding resources.L_Fdbk_Map_Location}" style="margin-left:20px"/>                <div class="markWrong">                    <label>                        <input type="checkbox" id="locationWrong" event:change="businessLocationMarkIncorrect" value="{Binding isLocationMarkIncorrect Mode=TwoWay}" role="checkbox" aria-label="{Binding resources.L_Fdbk_Map_Location}" aria-checked="{Binding isLocationMarkIncorrect}"/>                    <\/label>                <\/div>            <\/div>            <div style="margin-top: 8px; margin-left: 20px;margin-left:20px">                <a class="labelDisplayMovePin" role="button" event:click="mapMovePinClicked" href="#" id="labelMapPinId" aria-label="{Binding resources.L_Fdbk_Map_Location Converter=completeLabel}"><\/a>             <\/div>        <\/div>        <div style="margin-top:16px; margin-left:20px;" id="showHoursOptionsDiv">            <div class="fbDonotKnowWhere" style="margin-top:8px;height:20px">                <label style="float:left"><TextBlock Text="{Binding resources.L_Fdbk_Business_HoursOfOperation}" style="margin-left:20px" /><\/label>                <div id="markIncorrect" class="markWrong">                    <input type="checkbox" id="hoursWrong" event:change="markWrong" value="{Binding isHoursMarkIncorrect Mode=TwoWay}" style="float:right;margin-right:0" role="checkbox" aria-checked="{Binding isHoursMarkIncorrect}"/>                <\/div>            <\/div>            <div style="margin-top:8px;" id="hoursContainer">                <div id="showHours">                <\/div>                <div id="addHoursBtn">                    <a id="addWorkingHoursButton" class="anchorBtn" href="#" event:click="addHours" title="{Binding resources.AddHours}"><TextBlock Text="{Binding resources.AddHours}" aria-label="{Binding resources.L_Fdbk_Business_HoursOfOperation Converter=completeLabel}" /><\/a>                <\/div>                <div id="addHours">                    <div id="addDayDiv">                        <div id="daysDropDownId">                            <div id="dropdown" class="dropdown">                                <span class="dropdown-text" tabindex="0" role="button" aria-expanded="{Binding isDropdownOpened}" id="dropdownTextId" title="{Binding resources.WhichDays}" event:click="DropdownClickMethod" event:keydown="DropdownClickMethod"><\/span>                                <ul id="dropdown-menu" class="dropdown-menu" role="menu">                                    <li role="menuitem">                                        <input type="checkbox" value="Mon" id="MondayCheckbox" class="dropdown-item" event:click="DropdownChangeMethod" />                                        <label for="MondayCheckbox" style="display:inline-block"><TextBlock Text="{Binding resources.DayMonday}" /><\/label>                                    <\/li>                                    <li role="menuitem">                                        <input type="checkbox" value="Tue" id="TuesdayCheckbox" class="dropdown-item" event:click="DropdownChangeMethod" />                                        <label for="TuesdayCheckbox" style="display:inline-block"><TextBlock Text="{Binding resources.DayTuesday}" /><\/label>                                    <\/li>                                    <li role="menuitem">                                        <input type="checkbox" value="Wed" id="WednesdayCheckbox" class="dropdown-item" event:click="DropdownChangeMethod" />                                        <label for="WednesdayCheckbox" style="display:inline-block"><TextBlock Text="{Binding resources.DayWednesday}" /><\/label>                                    <\/li>                                    <li role="menuitem">                                        <input type="checkbox" value="Thu" id="ThursdayCheckbox" class="dropdown-item" event:click="DropdownChangeMethod" />                                        <label for="ThursdayCheckbox" style="display:inline-block"><TextBlock Text="{Binding resources.DayThursday}" /><\/label>                                    <\/li>                                    <li role="menuitem">                                        <input type="checkbox" value="Fri" id="FridayCheckbox" class="dropdown-item" event:click="DropdownChangeMethod" />                                        <label for="FridayCheckbox" style="display:inline-block"><TextBlock Text="{Binding resources.DayFriday}" /><\/label>                                    <\/li>                                    <li role="menuitem">                                        <input type="checkbox" value="Sat" id="SaturdayCheckbox" class="dropdown-item" event:click="DropdownChangeMethod" />                                        <label for="SaturdayCheckbox" style="display:inline-block"><TextBlock Text="{Binding resources.DaySaturday}" /><\/label>                                    <\/li>                                    <li role="menuitem">                                        <input type="checkbox" value="Sun" id="SundayCheckbox" class="dropdown-item" event:click="DropdownChangeMethod" />                                        <label for="SundayCheckbox" style="display:inline-block"><TextBlock Text="{Binding resources.DaySunday}" /><\/label>                                    <\/li>                                <\/ul>                            <\/div>                        <\/div>                        <div id="listOfNewHours"><\/div>                        <div id="addMoreHoursBtn">                            <a id="newDayAddHoursButton" event:click="addHoursToNewWorkingDayClickMethod" href="#" title="{Binding resources.AddMoreHours}"><TextBlock Text="{Binding resources.AddMoreHours}" role="button" aria-label="{Binding resources.L_FdbkEditButtonLabel}" /><\/a>                        <\/div>                        <div id="newHoursNoError">                        <\/div>                        <div id="newHoursMissingDaysError">                            <TextBlock Text="{Binding resources.ErrorSelectDays}" />                        <\/div>                        <div id="newHoursMissingHoursError">                            <TextBlock Text="{Binding resources.ErrorMissingHours}" />                        <\/div>                        <div id="newHoursInvalidHoursError">                            <TextBlock Text="{Binding resources.ErrorIncorrectHours}" />                        <\/div>                        <div style="display: inline-block;">                            <a class="textButton btnHoursEntry hoursButtonStyle" title="{Binding resources.ButtonAdd}" event:click="addRowForNewDay" href="#" role="button" id="addHoursButton" style="margin-right: 10px;">                                <TextBlock Text="{Binding resources.ButtonAdd}" />                            <\/a>                            <a class="textButton btnHoursEntry hoursButtonStyle" title="{Binding resources.ButtonUpdate}" event:click="addRowForNewDay" href="#" role="button" id="updateHoursButton" style="margin-right: 10px;"><TextBlock Text="{Binding resources.ButtonUpdate}" /><\/a>                            <a class="textButton btnHoursEntry hoursButtonStyle" title="{Binding resources.ButtonCancel}" event:click="hideNewWorkingDaysClickMethod" href="#" role="button" id="cancelHoursButton"><TextBlock Text="{Binding resources.ButtonCancel}" /><\/a>                        <\/div>                    <\/div>                <\/div>                <div id="open24x7Div">                    <input type="checkbox" id="open24x7" event:change="markOpen24x7" style="float:left"/>                    <label for="open24x7" style="display:inline-block; float:left"><TextBlock Text="{Binding resources.Open24x7}"/><\/label>                <\/div>            <\/div>        <\/div>        <div style="margin-top: 26px;margin-left:12px" style:display="{Binding showUserCommentsOptions} Converter=boolToDisplay}" id="showUserCommentsOptionsDiv" >            <div class="feedbackCardText">                <textarea id="feedbackComments" class="feedbackComments" rows="4" value="{Binding rapComments Mode=TwoWay}" aria-label="{Binding resources.L_Fdbk_UserComments_Alt}"                                maxlength="1000" data-tag="commentsSearchResultIssue" placeholder="{Binding resources.L_Fdbk_UserComments_Alt}" event:blur="onBlurFeedbackComments" event:focus="onFocusFeedbackComments"/>            <\/div>        <\/div>     <\/div>    <div style="margin-top: 26px;padding-bottom:12px;padding-right:12px" style:display="{Binding showSendFeedbackButton Converter=boolToDisplay}" id="showSendFeedbackButtonDiv">        <div style="padding-left: 10px; margin-top: 5px; margin-bottom: 5px" style:display="{Binding showSendEmailConsent Converter=boolToDisplay}" id="showUserEmailConsent" >            <label>                <input type="checkbox" id="userEmailCheckBox" />                <TextBlock text="{Binding resources.SendEmail}" />                <\/label>        <\/div>        <div class="feedbackCardSearchResultButton">            <a id="sendFeedbackButton" class="textButton" title="{Binding resources.L_Fdbk_Send}" href="#" event:click="onResultFeedbackSendClick" role="button" data-tag="resultFeedbackIssueSendButton">                <TextBlock Text="{Binding resources.L_Fdbk_Send}"/>            <\/a>        <\/div>    <\/div>    <div class="thankYouPanel" style:display="{Binding showThankYouPanel Converter=boolToDisplay}" role="status" aria-labelledby="thankYou bingBetter" aria-expanded="{Binding showThankYouPanel}" id="showThankYouPanelDiv">        <div style="font-size:15px;" tabindex="-1" id="thankYou">            <TextBlock Text="{Binding resources.L_Fdbk_New_ThankYou}" />        <\/div>        <div style="font-size:15px;padding-top:10px" id="bingBetter">            <TextBlock Text="{Binding resources.L_Fdbk_Bing_Better}" />        <\/div>        <div class="feedbackCardFoot">            <a class="textButton thankYouPanel" title="{Binding resources.L_Fdbk_Done}" event:click="onFeedbackDoneClick" href="#" role="button" tabindex="0" data-tag="feedbackDoneButton">                <TextBlock Text="{Binding resources.L_Fdbk_Done}" />            <\/a>        <\/div>    <\/div><\/div>',yi='<div class="feedbackPanelRoot">    <div class="feedbackPanel">        <div style:display="{Binding showSuggestions Converter=boolToDisplay}" class="meautosuggesttext">            <div>                <span class="feedbackDidYouMeanText">                    <TextBlock Text="{Binding resources.DidYouMeanThisPlace}" />                <\/span>            <\/div>            <div>                <span class="similarBusinessOnBingText">                    <TextBlock Text="{Binding resources.SimilarBusinessOnBing}" />                <\/span>            <\/div>        <\/div>        <textarea class="dummyfocus" style:display="none" tabindex="-1"><\/textarea>        <div class="me-overlay-listings" style:display="{Binding showSuggestions Converter=boolToDisplay}">            <div class="me-entity-listing-container">                <div class="me-b_rich">                    <ul class="me-b_vList"><\/ul>                <\/div>            <\/div>        <\/div>        <div class="feedbackDivPanel" data-tag="reportMissingEntityPanel" style:display="{Binding showFeedbackForm Converter=boolToDisplay}">            <div class="feedbackLookingforSelection meFeedback" data-tag="feedbackLookingforSelection">                <div class="requireMessage meFeedback">                    <span class="requireSign">                        <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnMap_RequiredSign}" />                    <\/span>                    <span class="requireLabel">                        <TextBlock Text="{Binding resources.L_Fdbk_ReportNoFound_Required}" />                    <\/span>                <\/div>                <div class="feedbackBusinessDiv meFeedback" data-tag="feedbackBusinessDiv">                                        <div class="inputFieldBlock name">                        <label><TextBlock Text="{Binding resources.L_Fdbk_Business_Name}" /><\/label>                        <span class="requireSign">*<\/span>                        <input type="text" class="mefbBusinessName" placeholder="{Binding resources.L_Fdbk_Business_Name_Placeholder_Text}" value="{Binding businessName Mode=TwoWay}" event:blur="onBlurFBRequiredInputFieldName" maxlength="400" data-tag="fbBusinessName" />                                       <\/div>                    <div class="validationErrorMessage">                        <TextBlock Text="{Binding resources.L_Fdbk_Business_Name_Required_Error_Message}" />                    <\/div>                         <div class="inputFieldBlock address">                                                <label><TextBlock Text="{Binding resources.L_Fdbk_Business_Address}" /><\/label>                        <span class="requireSign">*<\/span>                        <input type="text" class="fbBusinessAddress" placeholder="{Binding resources.L_Fdbk_Business_Address}" value="{Binding businessAddress Mode=TwoWay}" event:blur="onBlurFBRequiredInputFieldAddress" maxlength="400" data-tag="fbBusinessAddress" />                    <\/div>                    <div class="validationErrorMessage">                        <TextBlock Text="{Binding resources.L_Fdbk_Business_Address_Required_Error_Message}" />                    <\/div>                         <div class="inputFieldBlock city">                        <label><TextBlock Text="{Binding resources.L_Fdbk_Business_City}" /><\/label>                        <span class="requireSign">*<\/span>                        <input type="text" class="mefbBusinessCity" placeholder="{Binding resources.L_Fdbk_Business_City}" value="{Binding businessCity Mode=TwoWay}" event:blur="onBlurFBRequiredInputFieldAddress" maxlength="400" data-tag="fbBusinessCity" />                    <\/div>                    <div class="validationErrorMessage">                        <TextBlock Text="{Binding resources.L_Fdbk_Business_City_Required_Error_Message}" />                    <\/div>                    <div class="inputFieldBlock">                        <label><TextBlock Text="{Binding resources.L_Fdbk_Business_State_PostalCode_Label}" /><\/label>                                                <input type="text" class="mefbBusinessState" placeholder="{Binding resources.L_Fdbk_Business_State}" value="{Binding businessState Mode=TwoWay}" event:blur="onBlurFBRequiredInputFieldAddress" maxlength="400" data-tag="fbBusinessState" />                                               <input type="text" class="mefbBusinessPostalCode" placeholder="{Binding resources.L_Fdbk_Business_PostalCode}" value="{Binding businessPostalCode Mode=TwoWay}" event:blur="onBlurFBRequiredInputFieldAddress" maxlength="400" data-tag="fbBusinessPostalCode" />                    <\/div>                    <div class="feedbackCardInputDiv meFeedback inputFieldBlock feedbackCardText"  data-tag="commentsSearchResultNotFoundDiv">                        <label><TextBlock Text="{Binding resources.L_Fdbk_UserComments}" /><\/label>                        <textarea class="feedbackComments" rows="3"  placeholder="{Binding resources.L_Fdbk_Business_More_Details}" value="{Binding commentsSearchResultNotFound Mode=TwoWay}" maxlength="2000" data-tag="commentsSearchResultNotFound" />                        <br class="clearFloat meFeedback"/>                    <\/div>                    <div class="meProvideMoreFeedback">                        <CheckBox Content="{Binding resources.L_Fdbk_Provide_More_Feedback}" Checked="{Binding showAllFields Mode=TwoWay}" Value="" />                    <\/div>                    <div class="inputFieldBlock" style:display="{Binding showAllFields Converter=boolToDisplay}">                        <label><TextBlock Text="{Binding resources.L_Fdbk_Business_Phone}" /><\/label>                        <input type="text" class="mefbBusinessPhone" placeholder="{Binding resources.L_Fdbk_Business_Phone}" value="{Binding businessPhone Mode=TwoWay}" maxlength="400" data-tag="fbBusinessPhone" />                    <\/div>                    <div class="inputFieldBlock" style:display="{Binding showAllFields Converter=boolToDisplay}">                        <label><TextBlock Text="{Binding resources.L_Fdbk_Business_Website}" /><\/label>                        <input type="text" class="mefbBusinessWebsite" placeholder="{Binding resources.L_Fdbk_Business_Website}" value="{Binding businessWebsite Mode=TwoWay}" maxlength="400" data-tag="fbBusinessWebsite" />                    <\/div>                <\/div>            <\/div>                        <div class="{Binding showDragPushPinErrorMessage Converter=boolToDragPinMessageClass}" data-tag="movePushpinMessage">                <span>                    <TextBlock Text="{Binding resources.L_Fdbk_MovePinToCorrect_Message_For_Missing_Entity}" />                <\/span>            <\/div>            <div class="feedbackCardSearchResultButton meFeedback" data-tag="submitButtonDiv">                <div style:display="{Binding showSendEmailConsent Converter=boolToCaptureUserEmailDisplay}" class="fbCaptureUserEmailMsg meFeedback">                    <CheckBox Content="{Binding resources.SendEmail}" Checked="{Binding userEmailRequested Mode=TwoWay}" Value="" />                <\/div>                <a class="textButton meSendButton" title="{Binding resources.L_Fdbk_Send}" event:click="onMeFeedbackSubmitClick" href="#" role="button" data-tag="resultFeedbackNoFoundSendButton">                    <TextBlock Text="{Binding resources.L_Fdbk_Submit_Text}" />                <\/a>            <\/div>        <\/div>        <div class="feedbackCardSearchResultButton meFeedbackEditSubmit" data-tag="editSubmitAnywayButtonDiv" style:display="{Binding showSuggestions Converter=boolToDisplay}">            <div>                <a class="textButtonme meBacktoEditButton" title="{Binding resources.L_Fdbk_Edit}" event:click="onMeFeedbackBackToEditClick" href="#" role="button" data-tag="resultFeedbackBacktoEditButton" style:display="{Binding showBackToEditButton Converter=boolToDisplay}">                    <TextBlock Text="{Binding resources.L_Fdbk_BackToEdit_Text}" />                <\/a>                <a class="textButtonme meBacktoEditButton" title="{Binding resources.L_Fdbk_Dismiss}" event:click="onMeFeedbackBackToEditClick" href="#" role="button" data-tag="resultFeedbackDismissButton" style:display="{Binding showBackToEditButton Converter=boolToNotDisplay}">                    <TextBlock Text="{Binding resources.L_Fdbk_Dismiss_Text}" />                <\/a>                <a class="textButton meSubmitAnywayButton" title="{Binding resources.L_Fdbk_Send}" event:click="onMeFeedbackSubmitAnywayClick" href="#" role="button" data-tag="resultFeedbackSubmitAnywayButton">                    <TextBlock Text="{Binding resources.L_Fdbk_SubmitAnyway_Text}" />                <\/a>            <\/div>        <\/div>                <div class="thankYouPanel meFeedback" style:display="{Binding showThankYouPanel Converter=boolToDisplay}" role="status" aria-expanded="{Binding showThankYouPanel}" data-tag="searchResulThankYouPanel">            <div style="font-size:15px;" id="ms_ThankYou">                <TextBlock Text="{Binding resources.L_Fdbk_New_ThankYou}" />            <\/div>            <div style="font-size:15px;padding-top:10px" id="ms_ThankYouMessage">                <TextBlock Text="{Binding resources.L_Fdbk_Bing_Better}" />            <\/div>        <\/div>    <\/div><\/div>',pi='<div class="feedbackPanelRoot">    <div class="feedbackPanel">        <div class="returnArrowDiv"  style:display="{Binding showReturnArrowDiv Converter=boolToDisplay}" data-tag="returnArrowDiv">            <a class="commonButton backArrowButton feedbackBackButton" title="{Binding resources.L_Fdbk_ReturnToSearchResult}" event:click="onReturnToSearchResultClick" href="#" role="button"  data-tag="returnToSearchResultButton">                <div class="feedbackBackButtonText">                    <TextBlock Text="{Binding resources.L_Fdbk_ReturnToSearchResult}"/>                <\/div>            <\/a>        <\/div>        <div class="backArrowDiv"  style:display="{Binding showReturnArrowDiv Converter=boolToNotDisplay}" data-tag="backArrowDiv">            <a class="commonButton backArrowButton feedbackBackButton" title="{Binding resources.L_Fdbk_Back}" event:click="onBackToProblemTypeSelectClick" href="#" role="button" data-tag="backToProblemTypeSelectButton">                <div class="feedbackBackButtonText">                    <TextBlock Text="{Binding resources.L_Fdbk_Back}"/>                <\/div>            <\/a>        <\/div>                    <div class="feedbackDivPanel" style:display="{Binding showProblemSelectionPanel Converter=boolToDisplay}" data-tag="problemSelectionPanel">            <div class="feedbackSubTittle">                <h3>                    <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnSearchResult}"/>                <\/h3>            <\/div>            <div class="problemSelection" data-tag="fbOptsUnitsDiv">                <div class="feedbackCardLabelDiv">                    <TextBlock Text="{Binding resources.L_Fdbk_HelpUsUnderstand}"/>                <\/div>                <div class="fbOptsUnits" data-tag="fbOptsUnits">\t\t\t\t\t<label>\t\t\t\t\t\t<input type="radio" class="radio" checked="{Binding unitsNoFound Mode=TwoWay}" data-tag="fbOptsUnitsNoFound"/>\t\t\t\t\t\t<span class="labelNotLookingForSearchResult"><\/span>\t\t\t\t\t<\/label>                    <label>\t\t\t\t\t\t<input type="radio" class="radio" checked="{Binding unitsIssue Mode=TwoWay}" data-tag="fdOptsUnitsIssue"/>\t\t\t\t\t\t<span class="labelIssueWithSearchResult"><\/span>\t\t\t\t\t<\/label>\t\t\t\t<\/div>            <\/div>            <div class="feedbackCardSearchResultButton">                <a class="textButton" title="{Binding resources.L_Fdbk_Next}" event:click="onResultFeedbackNextClick" href="#" role="button" data-tag="nextButton">                    <TextBlock Text="{Binding resources.L_Fdbk_Next}"/>                <\/a>            <\/div>        <\/div>        <div class="feedbackDivPanel" style:display="{Binding showReportIssuePanel Converter=boolToDisplay}" data-tag="reportIssuePanel">            <div class="feedbackSubTittle">                <h3>                    <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnSearchResult}"/>                <\/h3>            <\/div>            <div class="feedbackCardInputDiv" data-tag="specificIssueDropDownDiv">                <div class="feedbackCardLabel">                    <span class="labelSpecificIssueWithSearchResult"><\/span>                <\/div>                <div class="feedbackSelect" data-tag="specificIssueDropDown">                    <SelectControl ItemsSource="{Binding subProblemTypes}" SelectedItem="{Binding subProblemType Mode=TwoWay}" event:dropdown="onDropdown"/>                <\/div>            <\/div>            <div class="feedbackCardMovePinReminderDiv" style:display="{Binding showMovePushpinMessage Converter=boolToDisplay}" data-tag="movePushpinMessage">                <TextBlock Text="{Binding resources.L_Fdbk_MovePinToCorrect_Message}"/>            <\/div>            <div class="feedbackCardInputDiv" data-tag="commentsSearchResultIssueDiv">                <div class="feedbackCardLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_MapIssueDescription}"/>                <\/div>                <div class="feedbackCardText">                    <textarea class="feedbackComments" rows="6" value="{Binding commentsSearchResultIssue Mode=TwoWay}" maxlength="2000" data-tag="commentsSearchResultIssue"/>                <\/div>            <\/div>            <div class="feedbackCardSearchResultButton">                <a class="textButton" title="{Binding resources.L_Fdbk_Send}" event:click="onResultFeedbackIssueSendClick" href="#" role="button" data-tag="resultFeedbackIssueSendButton">                    <TextBlock Text="{Binding resources.L_Fdbk_Send}"/>                <\/a>            <\/div>        <\/div>        <div class="feedbackDivPanel" style:display="{Binding showReportNoFoundPanel Converter=boolToDisplay}" data-tag="reportNoFoundPanel">            <div class="feedbackLookingforSelection" style:display="{Binding showLookingforDiv Converter=boolToDisplay}" data-tag="feedbackLookingforSelection">                <div class="feedbackSubTittle">                    <h3>                        <TextBlock Text="{Binding feedbackSubTitle}"/>                    <\/h3>                <\/div>                <div class="feedbackCardLabelDiv" data-tag="noFoundTypeDropDownDiv" style:display="{Binding showNoFoundDropDown Converter=boolToDisplay}">                    <div class="feedbackCardLabel">                        <span class="lableSearchQuery"><\/span>                    <\/div>                    <div class="feedbackSelect" data-tag="noFoundTypeDropDown">                        <SelectControl class="problemAreaSelect" ItemsSource="{Binding noFoundTypes}" SelectedItem="{Binding noFoundType Mode=TwoWay}" event:dropdown="onDropdown"/>                    <\/div>                <\/div>                <div class="feedbackBusinessDiv" style:display="{Binding showBusinessDiv Converter=boolToDisplay}" data-tag="feedbackBusinessDiv" >                    <input type="text" class="{Binding isFBBusinessNameFieldValid Converter=boolToFBBusinessNameFieldClass}" placeholder="{Binding resources.L_Fdbk_Business_Name_With_RequiredSign}" value="{Binding businessName Mode=TwoWay}" event:blur="onBlurFBRequiredInputField" maxlength="400" data-tag="fbBusinessName"/>                    <input type="text" class="fbBusinessAddress" placeholder="{Binding resources.L_Fdbk_Business_Address}" value="{Binding businessAddress Mode=TwoWay}" maxlength="400" data-tag="fbBusinessAddress"/>                    <input type="text" class="{Binding isFBBusinessCityFieldValid Converter=boolToFBBusinessCityFieldClass}" placeholder="{Binding resources.L_Fdbk_Business_City_With_RequiredSign}" value="{Binding businessCity Mode=TwoWay}" event:blur="onBlurFBRequiredInputField" maxlength="400" data-tag="fbBusinessCity"/>                    <input type="text" class="fbBusinessState" placeholder="{Binding resources.L_Fdbk_Business_State}" value="{Binding businessState Mode=TwoWay}" maxlength="400" data-tag="fbBusinessState"/>                    <input type="text" class="fbBusinessPostalCode" placeholder="{Binding resources.L_Fdbk_Business_PostalCode}" value="{Binding businessPostalCode Mode=TwoWay}" maxlength="400" data-tag="fbBusinessPostalCode"/>                    <input type="text" class="fbBusinessPhone" placeholder="{Binding resources.L_Fdbk_Business_Phone}" value="{Binding businessPhone Mode=TwoWay}" maxlength="400" data-tag="fbBusinessPhone"/>                    <input type="text" class="fbBusinessWebsite" placeholder="{Binding resources.L_Fdbk_Business_Website}" value="{Binding businessWebsite Mode=TwoWay}" maxlength="400" data-tag="fbBusinessWebsite"/>                <\/div>            <\/div>            <div class="{Binding showDragPushPinErrorMessage Converter=boolToDragPinMessageClass}" style:display="{Binding showMovePushpinMessage Converter=boolToDisplay}" data-tag="movePushpinMessage">                <span class="requireSign" style:display="{Binding noFoundType Converter=noFoundTypeToRequiredSignDisplay}" >                    <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnMap_RequiredSign}" />                <\/span>                <span>                    <TextBlock Text="{Binding resources.L_Fdbk_MovePinToCorrect_Message}" />                <\/span>            <\/div>            <div class="feedbackCardInputDiv" data-tag="commentsSearchResultNotFoundDiv">                <div class="feedbackCardLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_MapIssueDescription}"/>                <\/div>                <div class="feedbackCardText">                    <textarea class="feedbackComments" rows="{Binding feedbackCommentsTextAreaHeight}" value="{Binding commentsSearchResultNotFound Mode=TwoWay}" maxlength="2000" data-tag="commentsSearchResultNotFound"/>                <\/div>            <\/div>            <div class="requireMessage" style:display="{Binding noFoundType Converter=noFoundTypeToRequiredSignDisplay}" >                <span class="requireSign">                    <TextBlock Text="{Binding resources.L_Fdbk_ReportAProblemOnMap_RequiredSign}" />                <\/span>                <span class="requireLabel">                    <TextBlock Text="{Binding resources.L_Fdbk_ReportNoFound_Required}" />                <\/span>            <\/div>            <div class="feedbackCardSearchResultButton">                <div style:display="{Binding noFoundType Converter=noFoundTypeToCaptureUserEmailDisplay}" class="fbCaptureUserEmailMsg" >                    <CheckBox Content="{Binding resources.SendEmail}" Checked="{Binding userEmailRequested Mode=TwoWay}" Value="" />                <\/div>                <a class="textButton" title="{Binding resources.L_Fdbk_Send}" event:click="onResultFeedbackNoFoundSendClick" href="#" role="button" data-tag="resultFeedbackNoFoundSendButton">                    <TextBlock Text="{Binding resources.L_Fdbk_Send}"/>                <\/a>            <\/div>        <\/div>        <div class="feedbackDivPanel" style:display="{Binding showReportSomethingElsePanel Converter=boolToDisplay}" data-tag="reportSomethingElsePanel">            <div class="feedbackCardReportSomethingElseLink">                <a href="#" event:click="onReportSomethingElseLinkClick" data-tag="reportSomethingElseLink">                    <TextBlock Text="{Binding resources.L_Fdbk_ReportSomethingElse}"/>                <\/a>            <\/div>        <\/div>        <div class="thankYouPanel" style:display="{Binding showThankYouPanel Converter=boolToDisplay}" role="dialog" aria-expanded="{Binding showThankYouPanel}" aria-label="{Binding resources.L_Fdbk_ReturnToSearchResult}" data-tag="searchResulThankYouPanel">            <div class="backArrowDiv">                <a class="commonButton backArrowButton feedbackBackButton" title="{Binding resources.L_Fdbk_ReturnToSearchResult}" event:click="onReturnToSearchResultClick" href="#" role="button" data-tag="returnButtonInThankYouPanel">                    <div class="feedbackBackButtonText">                        <TextBlock Text="{Binding resources.L_Fdbk_ReturnToSearchResult}"/>                    <\/div>                <\/a>            <\/div>                        <div class="thankYouMessage">                <TextBlock Text="{Binding resources.L_Fdbk_ThankYou}"/>            <\/div>        <\/div>        <div class="messagePanel" style:display="{Binding showMessagePanel Converter=boolToDisplay}" role="status" aria-expanded="{Binding showMessagePanel}" data-tag="searchResultMessagePanel">            <div class="reminderMessage" id="reminderMessageSearch" data-tag="searchResultReminderMessage">                <TextBlock Text="{Binding reminderMessage}"/>            <\/div>        <\/div>    <\/div><\/div>',l=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),wi=function(t){function i(i){var u=this,r={};return u=t.call(this,r,i,hi)||this,r.defineProperty("showTip",null,null,{defaultValue:!1}),r.defineProperty("showPin",null,null,{defaultValue:!1}),r.defineProperty("dragPinTip"),u.resources=n,u}return l(i,t),i}(it),yt=function(n){function t(t){var i=this,r=new w(0,0),u=new lt(13,32);return i=n.call(this,null,r,u)||this,i._overlayViewModel=new wi(t),i.setOverlayElement(i._overlayViewModel.getControl()),i}return l(t,n),t.prototype.setShowTip=function(n){this._overlayViewModel.setShowTip(n)},t.prototype.setShowPin=function(n){this._overlayViewModel.setShowPin(n)},t.prototype.setDragPinTip=function(n){this._overlayViewModel.setDragPinTip(n)},t}(fi),i=function(){function n(){}return n.GetStargateProblemValue=function(n){var t="";switch(n){case 1:t="Problem with roads";break;case 2:t="Problem with addresses";break;case 5:t="Problem with admininistrative districts";break;case 9:t="Problem with airports";break;case 8:t="Problem with bridges";break;case 3:t="Problem with city";break;case 6:t="Problem with land features";break;case 4:t="Problem with neighborhoods";break;case 7:t="Problem with water bodies";break;case 11:t="Expected location result not returned";break;case 12:t="Some other problem";break;default:case 0:t="No problem selected"}return t},n.GetStargateIssueEntityType=function(n){var t="";switch(n){case 1:t="Road";break;case 2:t="Address";break;case 5:t="Admininistrative district";break;case 9:t="Airport";break;case 8:t="Bridge";break;case 3:t="City";break;case 6:t="Landform";break;case 4:t="Neighborhood";break;case 7:t="Waterbody";break;case 12:t="Something else";break;default:case 0:t="No problem selected"}return t},n.GetStargateSubProblemValue=function(n){var t="";switch(n){case 1:t="Road name is incorrect or missing";break;case 2:t="Road needs to be removed";break;case 3:t="Road location is incorrect";break;case 4:t="Road is missing";break;case 5:t="Road is closed";break;case 6:t="Road type is incorrect (highway or street)";break;case 7:t="Road should be one way";break;case 8:t="Road should be two ways";break;case 9:t="Road is one way in the wrong direction";break;case 10:t="Address is missing from road";break;case 11:t="Address is in wrong location";break;case 12:t="Address is on the wrong side of the road";break;case 13:t="Postal code has incorrect zip code";break;case 14:t="Postal code is missing";break;case 15:t="City name is incorrect";break;case 16:t="City location is incorrect";break;case 17:t="City is missing";break;case 18:t="City should be neighborhood";break;case 19:t="Neighborhood name is incorrect";break;case 20:t="Neighborhood location is incorrect";break;case 21:t="Neighborhood is missing";break;case 22:t="Neighborhood should be city";break;case 23:t="The boundary between countries is incorrect";break;case 24:t="The boundary between states/provinces is incorrect";break;case 25:t="The boundary between counties is incorrect";break;case 26:t="A political entity is missing (country, state, county, province etc.)";break;case 27:t="Political entity is wrong type";break;case 28:t="Country has incorrect or missing name";break;case 29:t="State/province has incorrect or missing name";break;case 30:t="County has incorrect or missing name";break;case 31:t="Name of land feature is incorrect";break;case 32:t="Land feature is wrong type (forest should be a desert etc.)";break;case 33:t="Land feature is missing";break;case 34:t="Land feature is the wrong location";break;case 35:t="Water body is missing";break;case 36:t="Water body is in an incorrect location";break;case 37:t="Water body has incorrect name";break;case 38:t="Incorrect type of water body (ocean should be sea etc.)";break;case 39:t="Bridge is closed";break;case 40:t="Bridge name is incorrect or missing";break;case 41:t="Bridge is missing";break;case 42:t="Bridge needs to be removed";break;case 43:t="Bridge is in wrong location";break;case 44:t="Airport in wrong location";break;case 45:t="Airport has incorrect or missing name";break;case 46:t="Airport is missing";break;case 47:t="Name is incorrect";break;case 48:t="Location is incorrect";break;case 49:t="Address of location is incorrect";break;case 50:t="Expected result not returned";break;case 51:t="Something else";break;case 0:default:t="No subproblem selected"}return t},n.GetStargateNoFoundPlaceType=function(n){var t="";switch(n){case 1:t="Address";break;case 2:t="Business";break;case 3:t="Populated Place";break;default:case 0:t="Other"}return t},n.GetDirectionsIssue=function(n){var t="Other";return n===1?t="Inaccurate Directions":n===3?t="A better route that is not shown":n===4?t="Incorrect times for transit services":n===5?t="Incorrect location of a transit stop":n>=10&&(t="Inaccurate location origin/destination"),t},n.GetDirectionsMode=function(n){var t="driving";return n===b.transit?t="transit":n>=b.walking&&(t="walking"),t},n.GetDirectionsTimeType=function(n){return n===at.arrival?"arrival":"departure"},n.FeedbackType="Report a problem",n.ParamFt_BaseMap="Maps.Basemap",n.ParamFt_Local="Maps.Local",n.ParamFt_Search="Maps.Search",n.ParamFt_Directions="Maps.Directions",n.ParamSrc_BaseMap="Basemap",n.ParamSrc_Address="Address",n.ParamSrc_Location="Location",n.ParamSrc_Local="Local",n.ParamSrc_Directions="Directions",n.SubScenario_NotFound="Didn't find result",n.SubScenario_Issue="Issue with result",n.GeoEntityType_Address="Address",n.GeoEntityType_Place="PopulatedPlace",n.GeoEntityType_Business="Business",n.GeoEntityType_Other="Other",n.Identifier_Unknown="Unknown",n.SchemaVersion="2.0",n.ClientType_MapWebsite="MapWebsite",n.FeedbackType_SAT="SAT",n.FeedbackType_DSAT="DSAT",n.FeedbackType_Suggestion="Suggestion",n.FORM_General="General",n.FORM_ProblemOnMap="Problem on Map",n.FORM_ProblemWithSearch="Problem With Search",n.FORM_ProblemWithDirections="Problem With Directions",n.Scenario_General="General",n.Scenario_Map="Map",n.Scenario_Local="Local",n.Scenario_Direction="Direction",n.IssueEntityType_Address="Address",n.IssueEntityType_Place="Place",n.IssueEntityType_Business="Business",n.IssueEntityType_Other="Other",n.Issue_DidnotFindAddress="Didn't find Address",n.Issue_DidnotFindLocation="Didn't find Location",n.Issue_DidnotFindBusiness="Didn't find Business",n.Issue_DidnotFindOther="Didn't find Something else",n.Partner_SUrFLegacy="SUrFLegacy",n}(),p=function(t){function i(i,r,u,f){var e=t.call(this,i,r,u)||this;return e.resources=n,e.feedbackTask=f,e.invalidated=new et,e.showPushpinReminderMessage=!0,e.isSubmitted=!1,e._controlTemplateFactory=r,e.initLocationOfPushpin=s.getMapCenter(e.getMap()),e}return l(i,t),i.prototype.onTaskStateChanged=function(n){n.animationState===1&&this.setFocusToDefaultElement();n.activationState===1&&n.prominence===1?this.feedbackType===1||this.isSubmitted||this.showPushpin():n.activationState===2&&this.feedbackType!==1&&this._feedbackPushpin&&this.hidePushpin()},i.prototype.setFocusToDefaultElement=function(){var n=this;Microsoft.Maps.setTimeout(function(){var t=n.getDefaultFocusElement();t&&t.length>0&&t[0].focus()},20)},i.prototype.getDefaultFocusElement=function(){return this.getControl().select("a,textarea")},i.prototype.createPushpin=function(){var n=this,r=new ct("","",null),t;this._feedbackPushpin=new st(this.initLocationOfPushpin,r,ft.getImageFromCss("feedbackPushpin"),new tt(13,32));t=this.getMap();this._defaultFeedbackLayer=new vt(ii.getUniqueId(),this,new dt(t),i.feedbackLayerZIndex);this._feedbackPushpin.layer=this._defaultFeedbackLayer;this._feedbackPushpin.entity.collisionBehavior=2;this._defaultFeedbackLayer.setRenderTarget(1);this.disposables.push(this._defaultFeedbackLayer.primitiveHoverStarted.add(function(t){return n._onPrimitiveHover(t,!0)}));this.disposables.push(this._defaultFeedbackLayer.primitiveHoverStopped.add(function(t){return n._onPrimitiveHover(t,!1)}));this.disposables.push(this._defaultFeedbackLayer.primitiveMoveContinued.add(function(t){return n._onPrimitiveMoveContinued(t)}));this.disposables.push(this._defaultFeedbackLayer.primitiveMoveStopped.add(function(t){return n._onPrimitiveMoveStopped(t)}));this.disposables.push(t.mapModeChanged.add(function(t){return n._onMapModeChanged(t.newMode)}));t.getLayers().insert(this._defaultFeedbackLayer);this.updateDragPin(!0);this.showPushpinTipWithTimer()},i.prototype.showPushpinTipWithTimer=function(){var n=this;this.showPushiPinTip(!0);this._timeOutFn=Microsoft.Maps.setTimeout(function(){n.showPushiPinTip(!1);window.clearTimeout(n._timeOutFn)},u.feedbackPinTipExpiry)},i.prototype._onPrimitiveHover=function(n,t){this.showPushiPinTip(t)},i.prototype._onPrimitiveMoveContinued=function(n){var t=n.location;this.updateDragPin(!0,t);this.showPushiPinTip(!1)},i.prototype._onPrimitiveMoveStopped=function(n){var t=n.location;this.updatePushpin(n.location);this.onPushPinUpdate();this.updateDragPin(!0,t);this.feedbackTask.primitiveInteracted.invoke()},i.prototype.updateDragPin=function(n,t){this._feedbackPushpin&&(n?(t||(t=this.getPushpinLocation()),i.showDragPin(this.getMap(),this._controlTemplateFactory,t,n)):i.hideDragPin(this.getMap()))},i.showDragPin=function(n,t,r,u){i._feedbackPushpinOverlay||(i._feedbackPushpinOverlay=new yt(t));i._pushpinOverlayShowing||(n.getOverlays().insert(i._feedbackPushpinOverlay),i._pushpinOverlayShowing=!0);i._feedbackPushpinOverlay.setAlignment(r);i._feedbackPushpinOverlay.setShowPin(u)},i.hideDragPin=function(n){i._feedbackPushpinOverlay&&(i._pushpinOverlayShowing=!1,i._feedbackPushpinOverlay.setShowTip(!1),n.getOverlays().remove(i._feedbackPushpinOverlay))},i.prototype.updatePushpin=function(n){n!=null&&(this._feedbackPushpin.geometry.x=n.longitude,this._feedbackPushpin.geometry.y=n.latitude,this._feedbackPushpin.geometry.bounds=[n.latitude,n.longitude,n.latitude,n.longitude],this.invalidated.invoke())},i.prototype.onPushPinUpdate=function(){},i.prototype.showPushpin=function(){i._taskOfPushpinOverlayShowing=this.feedbackTask.id;this._feedbackPushpin?(this._defaultFeedbackLayer.setVisible(!0),this.setMapViewIfPrimitivesOutOfBound(this.getMap(),this.getPushpinLocation()),this.invalidated.invoke(),this.updateDragPin(!0),this._defaultFeedbackLayer&&this._defaultFeedbackLayer.setZIndex(i.feedbackLayerZIndex+1)):this.createPushpin()},i.prototype.hidePushpin=function(){this._defaultFeedbackLayer.setVisible(!1);this._hideTaskDragPin();this._defaultFeedbackLayer&&this._defaultFeedbackLayer.setZIndex(i.feedbackLayerZIndex+1)},i.prototype.removePushPin=function(){this._feedbackPushpin&&(this._hideTaskDragPin(),this.getMap().getLayers().remove(this._defaultFeedbackLayer),this._feedbackPushpin=null)},i.prototype._hideTaskDragPin=function(){i._taskOfPushpinOverlayShowing===this.feedbackTask.id&&this.updateDragPin(!1)},i.prototype.getMap=function(){return this.feedbackTask.map},i.prototype.getPushpinLocation=function(){var n=this.initLocationOfPushpin;return this._feedbackPushpin&&(n=new w(this._feedbackPushpin.geometry.y,this._feedbackPushpin.geometry.x)),n},i.prototype.isPushpinMoved=function(){return!w.areEqual(this.initLocationOfPushpin,this.getPushpinLocation())},i.prototype.getPrimitives=function(n,t){var i=[];this._feedbackPushpin&&i.push(this._feedbackPushpin);t&&t({primitives:i})},i.prototype.setMapViewIfPrimitivesOutOfBound=function(n,t){var i=s.getMapBounds(n,!0);i.contains(t)||s.setMapCenter(n,t,n.getMercatorZoomLevel())},i.prototype._onMapModeChanged=function(n){var t=this;this.feedbackType===1||this.isSubmitted||(n===2?this.updateDragPin(!1):this._defaultFeedbackLayer.getVisible()&&Microsoft.Maps.setTimeout(function(){t.updateDragPin(!0)},100))},i.prototype.hasInput=function(){return!1},i.prototype.isPushpinVisible=function(){return this._defaultFeedbackLayer&&this._defaultFeedbackLayer.getVisible&&this._defaultFeedbackLayer.getVisible()},i.prototype.showPushiPinTip=function(t){i._feedbackPushpinOverlay&&(t&&i._feedbackPushpinOverlay.setDragPinTip(this.feedbackType===2?n.L_Fdbk_Drag_Pin_Tip:n.L_Fdbk_Drag_Pin_Correct_Tip),i._feedbackPushpinOverlay.setShowTip(t))},i.prototype.isDragPinShowing=function(){return i._pushpinOverlayShowing},i.prototype._focusInThankYouPanel=function(){window.clearTimeout(this.feedbackTimeoutHandler);this.feedbackTimeoutHandler=Microsoft.Maps.setTimeout(function(){var n=r(".textButton.thankYouPanel");n&&n.length&&n[0].focus()},this.feedbackTimeout)},i.feedbackLayerZIndex=1e4,i}(it),bi=function(r){function f(t,i,f){var e=this,o={};return e=r.call(this,o,t,li,i)||this,e.feedbackType=f,e.newFeedbackInputHeader=n.L_Fdbk_GeneralCardInputHeader,e.newFeedbackTextWatermark=n.L_Fdbk_GeneralCardTextWatermark,e.emailDisplay=u.emailEnabled?"":"none",e.emailLabel=n.L_Fdbk_Email,e.privacyPolicyLinkDisplay=u.emailEnabled?"":"none",e.privacyPolicyLink=u.privacyPolicyLink,e.overallRating=-1,e.feedbackTimeout=250,o.defineProperty("showGeneralFeedbackPanel"),o.defineProperty("showProblemOnMapPanel"),o.defineProperty("showThankYouPanel"),o.defineProperty("showMessagePanel"),o.defineProperty("reminderMessage"),o.defineProperty("problemType",e._onProblemTypeChanged),o.defineProperty("subProblemType",e._onSubProblemTypeChanged),o.defineProperty("unHappySelected",null,null,{defaultValue:!1}),o.defineProperty("happySelected",null,null,{defaultValue:!1}),e._prePopulateProblemDropdowns(),e.setShowGeneralFeedbackPanel(f!==2),e.setShowProblemOnMapPanel(f===2),e.setShowThankYouPanel(!1),e.setShowMessagePanel(!1),e.setReminderMessage(""),e}return l(f,r),f.prototype.dispose=function(){window.clearTimeout(this.feedbackTimeoutHandler);r.prototype.dispose},f.prototype.onOverallHappyButtonClick=function(n){this._onOverallButtonClick(n,1)},f.prototype.onOverallUnhappyButtonClick=function(n){this._onOverallButtonClick(n,0)},f.prototype._onOverallButtonClick=function(n,t){n.preventDefault();var i=t?this._getOverallHappyButton():this._getOverallUnhappyButton(),r=t?this._getOverallUnhappyButton():this._getOverallHappyButton();this.overallRating===t?(i.remove_class("overallSelected"),this._setHappyButtonsState(-1),this.overallRating=-1):(i.add_class("overallSelected"),r.remove_class("overallSelected"),this._setHappyButtonsState(t),this.overallRating=t)},f.prototype._setHappyButtonsState=function(n){n===-1?(this.setHappySelected(!1),this.setUnHappySelected(!1)):n===0?(this.getUnHappySelected()||this.setUnHappySelected(!0),this.setHappySelected(!1)):n===1&&(this.getHappySelected()||this.setHappySelected(!0),this.setUnHappySelected(!1))},f.prototype.onGeneralFeedbackSendClick=function(r){var h;if(r.preventDefault(),this.overallRating===-1&&this.commentsGeneral.length===0){this._showMessagePanel(!0,n.L_Fdbk_GeneralFeedback_Reminder);t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_General,SR:"RI"});return}var u=s.getMapBounds(this.getMap(),!1),o=s.getMapCenter(this.getMap()),l=s.getMercatorZoomLevel(this.getMap()),f=i.FeedbackType_Suggestion;this.overallRating===1?f=i.FeedbackType_SAT:this.overallRating===0&&(f=i.FeedbackType_DSAT);h={FORM:i.FORM_General,MapStyle:this.getMap().getMapType().displayName,MapViewBoundingBox:{NELatLon:{Latitude:u.getNorth(),Longitude:u.getEast()},SWLatLon:{Latitude:u.getSouth(),Longitude:u.getWest()}},MapViewCenter:{Latitude:o.latitude,Longitude:o.longitude},Zoom:l,FeedbackType:f,Scenario:i.Scenario_General,UserComment:this.commentsGeneral,Issue:this._createKeywords("Feedback"),alias:this.email,send_mail:!0};this.feedbackTask.sendSurfFeedback(h,"","");this.setShowGeneralFeedbackPanel(!1);this.setShowMessagePanel(!1);this.setShowThankYouPanel(!0);this._focusInThankYouPanel();this.isSubmitted=!0;t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_General,SR:"SM"})},f.prototype.onProblemOnMapSendClick=function(r){if(r.preventDefault(),this.getProblemType().value===0||this.commentsBaseMap.length===0){this._showMessagePanel(!0,n.L_Fdbk_ReportAProblemOnMap_Reminder);t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_BaseMap,SR:"RI"});return}var u=s.getMapBounds(this.getMap(),!1),f=s.getMapCenter(this.getMap()),o=s.getMercatorZoomLevel(this.getMap()),h=this.getProblemType(),l=this.getSubProblemType(),a={FORM:i.FORM_ProblemOnMap,MapStyle:this.getMap().getMapType().displayName,MapViewBoundingBox:{NELatLon:{Latitude:u.getNorth(),Longitude:u.getEast()},SWLatLon:{Latitude:u.getSouth(),Longitude:u.getWest()}},MapViewCenter:{Latitude:f.latitude,Longitude:f.longitude},Zoom:o,FeedbackType:i.FeedbackType_DSAT,Scenario:i.Scenario_Map,IssueEntity:{GeoLocation:{Latitude:this.getPushpinLocation().latitude,Longitude:this.getPushpinLocation().longitude},ReverseGeocodeAddress:{AddressLine:""}},IssueEntityType:i.GetStargateIssueEntityType(h.value),Issue:i.GetStargateSubProblemValue(l.value),UserComment:this.commentsBaseMap,IsPushpinMoved:this.isPushpinMoved()};this.feedbackTask.sendSurfFeedback(a,i.ParamFt_BaseMap,i.ParamSrc_BaseMap);this.isSubmitted=!0;t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_BaseMap,SR:"SM"});this.setShowProblemOnMapPanel(!1);this.setShowMessagePanel(!1);this.setShowThankYouPanel(!0);this._focusInThankYouPanel();this.hidePushpin()},f.prototype.onFeedbackDoneClick=function(n){n.preventDefault();window.clearTimeout(this.feedbackTimeoutHandler);v.invokeHandler(a.taskDataHandlerKey,{action:"removeStackForTask",id:this.feedbackTask.id})},f.prototype.onReportAProblemOnMapClick=function(n){this._switchPanel(n,2);this.showPushpin()},f.prototype.onSendGeneralFeedbackClick=function(n){this._switchPanel(n,1);this.hidePushpin()},f.prototype._switchPanel=function(i,r){i.preventDefault();this._showMessagePanel(!1);this.showPushpinReminderMessage=!0;this.feedbackType=r;r===2?(this.setShowGeneralFeedbackPanel(!1),this.setShowProblemOnMapPanel(!0),this.feedbackTask.setTitle(n.L_Fdbk_ReportAProblem)):(this.setShowProblemOnMapPanel(!1),this.setShowGeneralFeedbackPanel(!0),this.feedbackTask.setTitle(n.L_Fdbk_GeneralFeedback));this.setFocusToDefaultElement();t.log(e.Feedback,c.Clicked,{FT:t.getFeedbackTypeLogValue(r)})},f.prototype._createKeywords=function(n){return n+";"+(this.overallRating!==-1?"OVERALL-"+this.overallRating.toString()+";":"")},f.prototype.getDefaultFocusElement=function(){var n,t;return this.feedbackType===2&&(n=this._getElementObj(".feedbackCardInputDiv.problemSelect"),n&&n.length&&(t=n.select(".selectControl"),t&&t.length))?t.select(".popOutButton.dropdownBtn"):this._getOverallHappyButton()},f.prototype._getOverallHappyButton=function(){return this._getElementObj(".happyButton")},f.prototype._getOverallUnhappyButton=function(){return this._getElementObj(".unhappyButton")},f.prototype._getElementObj=function(n){return this.getControl().select(n)},f.prototype._showMessagePanel=function(n,t){n?(this.setShowMessagePanel(!0),this.setReminderMessage(t)):(this.setShowMessagePanel(!1),this.setReminderMessage(""))},f.prototype.hasInput=function(n){var t=this.getProblemType(),i=this.getSubProblemType();return n===2?t&&t.value!==0||i&&i.value!==0||this.commentsBaseMap.length!==0:this.overallRating!==-1||this.commentsGeneral.length!==0},f.prototype._prePopulateProblemDropdowns=function(){this.problemTypes=[{text:n.L_Fdbk_SelectProblem,value:0},{text:n.L_Fdbk_ProblemRoad,value:1},{text:n.L_Fdbk_ProblemAddress,value:2},{text:n.L_Fdbk_ProblemCity,value:3},{text:n.L_Fdbk_ProblemNeighborhood,value:4},{text:n.L_Fdbk_ProblemAdministrativeDistricts,value:5},{text:n.L_Fdbk_ProblemLand,value:6},{text:n.L_Fdbk_ProblemWater,value:7},{text:n.L_Fdbk_ProblemBridge,value:8},{text:n.L_Fdbk_ProblemAirport,value:9},{text:n.L_Fdbk_Other,value:12}];this.subProblemTypes=new nt([]);this.setProblemType({text:n.L_Fdbk_SelectProblem,value:0});this.setSubProblemType({text:n.L_Fdbk_SelectSubProblem,value:0})},f.prototype._onProblemTypeChanged=function(t,i){if(i!=null){this.subProblemTypes.clear();var r=[];this.setSubProblemType({text:n.L_Fdbk_SelectSubProblem,value:0});switch(i.value){case 1:r.push({text:n.L_Fdbk_RoadNameIncorrect,value:1},{text:n.L_Fdbk_RoadRemove,value:2},{text:n.L_Fdbk_RoadLocationIncorrect,value:3},{text:n.L_Fdbk_RoadMissing,value:4},{text:n.L_Fdbk_RoadClosed,value:5},{text:n.L_Fdbk_RoadTypeIncorrect,value:6},{text:n.L_Fdbk_RoadOneWay,value:7},{text:n.L_Fdbk_RoadTwoWay,value:8},{text:n.L_Fdbk_RoadOneWayOpposite,value:9},{text:n.L_Fdbk_Other,value:51});break;case 2:r.push({text:n.L_Fdbk_AddressMissing,value:10},{text:n.L_Fdbk_AddressLocationIncorrect,value:11},{text:n.L_Fdbk_AddressSideIncorrect,value:12},{text:n.L_Fdbk_AddressZipIncorrect,value:13},{text:n.L_Fdbk_AddressZipMissing,value:14},{text:n.L_Fdbk_Other,value:51});break;case 3:r.push({text:n.L_Fdbk_CityNameIncorrect,value:15},{text:n.L_Fdbk_CityLocationIncorrect,value:16},{text:n.L_Fdbk_CityMissing,value:17},{text:n.L_Fdbk_CityNeighborhood,value:18},{text:n.L_Fdbk_Other,value:51});break;case 4:r.push({text:n.L_Fdbk_NeighborhoodNameIncorrect,value:19},{text:n.L_Fdbk_NeighborhoodLocationIncorrect,value:20},{text:n.L_Fdbk_NeighborhoodMissing,value:21},{text:n.L_Fdbk_NeighborhoodCity,value:22},{text:n.L_Fdbk_Other,value:51});break;case 5:r.push({text:n.L_Fdbk_AdminDistrictsCountryBoundary,value:23},{text:n.L_Fdbk_AdminDistrictsStateBoundary,value:24},{text:n.L_Fdbk_AdminDistrictsCountyBoundary,value:25},{text:n.L_Fdbk_AdminDistrictsEntityMissing,value:26},{text:n.L_Fdbk_AdminDistrictsWrongEntity,value:27},{text:n.L_Fdbk_AdminDistrictsCountryName,value:28},{text:n.L_Fdbk_AdminDistrictsStateName,value:29},{text:n.L_Fdbk_AdminDistrictsCountyName,value:30},{text:n.L_Fdbk_Other,value:51});break;case 6:r.push({text:n.L_Fdbk_LandFeatureNameIncorrect,value:31},{text:n.L_Fdbk_LandTypeIncorrect,value:32},{text:n.L_Fdbk_LandFeatureMissing,value:33},{text:n.L_Fdbk_LandLocationIncorrect,value:34},{text:n.L_Fdbk_Other,value:51});break;case 7:r.push({text:n.L_Fdbk_WaterMissing,value:35},{text:n.L_Fdbk_WaterLocationIncorrect,value:36},{text:n.L_Fdbk_WaterNameIncorrect,value:37},{text:n.L_Fdbk_WaterTypeIncorrect,value:38},{text:n.L_Fdbk_Other,value:51});break;case 8:r.push({text:n.L_Fdbk_BridgeClosed,value:39},{text:n.L_Fdbk_BridgeNameIncorrect,value:40},{text:n.L_Fdbk_BridgeMissing,value:41},{text:n.L_Fdbk_BridgeRemoved,value:42},{text:n.L_Fdbk_BridgeLocationIncorrect,value:43},{text:n.L_Fdbk_Other,value:51});break;case 9:r.push({text:n.L_Fdbk_AirportIncorrect,value:45},{text:n.L_Fdbk_AirportMissing,value:46},{text:n.L_Fdbk_AirportWrongLocation,value:44},{text:n.L_Fdbk_Other,value:51});break;case 12:r.push({text:n.L_Fdbk_Other,value:51});break;default:r.push({text:n.L_Fdbk_SelectSubProblem,value:0})}this.subProblemTypes.insertAll(r)}},f.prototype._onSubProblemTypeChanged=function(){},f.prototype._focusInThankYouPanel=function(){r.prototype._focusInThankYouPanel.call(this)},f}(p),ki=function(r){function u(t,i,u){var f=this,e={},o,s;return f=r.call(this,e,t,pi,i)||this,f.feedbackType=3,u&&(f.reportType=u.reportType?u.reportType:0,f._query=u.query?u.query:"",u.pushPinLocation&&(f.initLocationOfPushpin=u.pushPinLocation),u.taskStateId&&(f._taskStateId=u.taskStateId),u.scenarioKey&&(f._scenarioKey=u.scenarioKey),u.userFacts&&(f.userFacts=u.userFacts),u.rapEntryPoint&&(f._rapEntryPoint=u.rapEntryPoint)),f.isLabelAdded=!1,e.defineProperty("showProblemSelectionPanel"),e.defineProperty("showReportIssuePanel"),e.defineProperty("showReportNoFoundPanel"),e.defineProperty("showReportSomethingElsePanel"),e.defineProperty("showThankYouPanel"),e.defineProperty("showMessagePanel"),e.defineProperty("showReturnArrowDiv"),e.defineProperty("showBusinessDiv"),e.defineProperty("unitsNoFound",f._onUnitsNoFoundChanged),e.defineProperty("unitsIssue",f._onUnitsIssueChanged),e.defineProperty("showMovePushpinMessage"),e.defineProperty("subProblemType",f._onSubProblemTypeChanged),e.defineProperty("noFoundType",f._onNoFoundTypeChanged),e.defineProperty("showLookingforDiv"),e.defineProperty("reminderMessage"),e.defineProperty("showNoFoundDropDown"),e.defineProperty("feedbackSubTitle"),e.defineProperty("showDragPushPinErrorMessage"),e.defineProperty("isFBBusinessNameFieldValid"),e.defineProperty("isFBBusinessCityFieldValid"),e.defineProperty("feedbackCommentsTextAreaHeight"),e.defineProperty("userEmailRequested"),e.defineProperty("showSendEmailConsent"),f.reportType===1&&u.noFoundType===2?f.setShowDragPushPinErrorMessage(!1):f.setShowDragPushPinErrorMessage(!0),f.setIsFBBusinessNameFieldValid(!0),f.setIsFBBusinessCityFieldValid(!0),f._prePopulateSubProblemDropdowns(),f._prePopulateNoFoundTypes(),f.reportType===1||f.reportType===6?(f.setShowProblemSelectionPanel(!1),f.setShowReportNoFoundPanel(!0)):(f.setShowProblemSelectionPanel(!0),f.setShowReportNoFoundPanel(!1)),o=!0,s=!1,f.reportType===1&&u.noFoundType===2?(o=!1,s=!0,f.setShowNoFoundDropDown(!1),f.setFeedbackSubTitle(n.L_Fdbk_TellUsAboutMissingBusiness_Message),f.setShowMovePushpinMessage(!0),f.setNoFoundType({text:n.L_Fdbk_NoFoundBusiness,value:2})):(f.setShowNoFoundDropDown(!0),f.setFeedbackSubTitle(n.L_Fdbk_DidNotFindLookingFor_Message),f.setShowMovePushpinMessage(!1)),f.setShowReturnArrowDiv(!0),f.setShowReportIssuePanel(!1),f.setShowReportSomethingElsePanel(o),f.setShowBusinessDiv(s),f.setShowMessagePanel(!1),f.setShowThankYouPanel(!1),f.setShowLookingforDiv(!0),f.setShowSendEmailConsent(!1),f.setUserEmailRequested(!1),f}return l(u,r),u.prototype.onTaskStateChanged=function(t){!this.isLabelAdded&&(t.colorIndex||t.animationState)&&(this.getControl().select(".labelNotLookingForSearchResult").set_html(h._formatString(n.L_Fdbk_Option_DidNotFind,this._getStyleString(this.feedbackTask.getTitle()))),this.getControl().select(".labelIssueWithSearchResult").set_html(h._formatString(n.L_Fdbk_Option_IssueWithSearchResult,this._getStyleString(this.feedbackTask.getTitle()))),this.getControl().select(".labelSpecificIssueWithSearchResult").set_html(h._formatString(n.L_Fdbk_SpecificIssueWith,this._getStyleString(this.feedbackTask.getTitle()))),this.getControl().select(".lableSearchQuery").set_html(h._formatString(n.L_Fdbk_WhenISearch_Message,this._getStyleString(this._query))),this.userFacts&&this.userFacts.Id&&(this.userFacts.EmailAddress||JSON.parse(this.userFacts.EnableEmailBackfill.toLowerCase()))&&(this.setUserEmailRequested(!0),this.setShowSendEmailConsent(!0)),this.isLabelAdded=!0);r.prototype.onTaskStateChanged.call(this,t)},u.prototype.onReturnToSearchResultClick=function(n){n.preventDefault();v.invokeHandler(a.taskDataHandlerKey,{action:"remove",id:this.feedbackTask.id})},u.prototype.onReportSomethingElseLinkClick=function(t){t.preventDefault();v.invokeHandler(a.taskDataHandlerKey,{type:y.feedbackTask,state:{entryPoint:3,feedbackTaskType:2,title:n.L_Fdbk_ReportAProblem}})},u.prototype.onResultFeedbackNextClick=function(t){t.preventDefault();this._problemTypeOptionsUnit?(this.setShowProblemSelectionPanel(!1),this.setShowMessagePanel(!1),this.setShowReturnArrowDiv(!1),this.setShowReportNoFoundPanel(this.getUnitsNoFound()),this.setShowReportIssuePanel(!this.getUnitsNoFound())):this._showMessagePanel(!0,n.L_Fdbk_ProblemType_Reminder)},u.prototype.onBackToProblemTypeSelectClick=function(n){n.preventDefault();this.setShowReportIssuePanel(!1);this.setShowReportNoFoundPanel(!1);this.setShowMessagePanel(!1);this.setShowProblemSelectionPanel(!0);this.setShowReturnArrowDiv(!0)},u.prototype.onResultFeedbackIssueSendClick=function(n){n.preventDefault();this._sendSerfData(!1,this.getSubProblemType().value===0,this.commentsSearchResultIssue)},u.prototype.onResultFeedbackNoFoundSendClick=function(n){n.preventDefault();this._sendSerfData(!0,this.getNoFoundType().value===0,this.commentsSearchResultNotFound)},u.prototype.boolToDragPinMessageClass=function(n){var t="feedbackCardMovePinReminderDiv";return n===!0&&(t+=" requiredInputMissing"),t},u.prototype.boolToFBBusinessNameFieldClass=function(n){var t="fbBusinessName";return n===!1&&(t+=" requiredInputMissing"),t},u.prototype.noFoundTypeToRequiredSignDisplay=function(n){var t="";return n&&n.value!==2&&(t="none"),t},u.prototype.noFoundTypeToCaptureUserEmailDisplay=function(n){var t="none";return this.getShowSendEmailConsent()===!0&&n&&n.value===2&&(t="inline"),t},u.prototype.boolToFBBusinessCityFieldClass=function(n){var t="fbBusinessCity";return n===!1&&(t+=" requiredInputMissing"),t},u.prototype.onBlurFBRequiredInputField=function(){this._validateNoResultFeedbackForm(this.getNoFoundType().value===0,this.commentsSearchResultNotFound,!1)},u.prototype.onPushPinUpdate=function(){(this.reportType===1||this.reportType===6)&&this.getNoFoundType().value===2&&this._validateNoResultFeedbackForm(this.getNoFoundType().value===0,this.commentsSearchResultNotFound,!1)},u.prototype._sendSerfData=function(n,r,u){var g=this._validateNoResultFeedbackForm(r,u,!0),f;if(g){var v=s.getMapBounds(this.getMap(),!1),w=s.getMapCenter(this.getMap()),nt=s.getMercatorZoomLevel(this.getMap()),b=50,y=this.getNoFoundType().value,l="",k=i.ParamFt_Search,o="",d="",h="",a="",p=i.Scenario_Map;n?(d=i.SubScenario_NotFound,y===1?(o=i.ParamSrc_Address,l=i.GeoEntityType_Address,h=i.IssueEntityType_Address,a=i.Issue_DidnotFindAddress):y===3?(o=i.ParamSrc_Location,l=i.GeoEntityType_Place,h=i.IssueEntityType_Place,a=i.Issue_DidnotFindLocation):y===2?(k=i.ParamFt_Local,o=i.ParamSrc_Local,l=i.GeoEntityType_Business,h=i.IssueEntityType_Business,p=i.Scenario_Local,a=i.Issue_DidnotFindBusiness):(o=i.ParamSrc_Location,l=i.GeoEntityType_Other,h=i.IssueEntityType_Other,a=i.Issue_DidnotFindOther)):(d=i.SubScenario_Issue,b=this.getSubProblemType().value,a=i.GetStargateSubProblemValue(b),this.reportType===2||this.reportType===3?(o=i.ParamSrc_Address,l=i.GeoEntityType_Address,h=i.IssueEntityType_Address):this.reportType===5?(o=i.ParamSrc_Location,l=i.GeoEntityType_Place,h=i.IssueEntityType_Place):(o=i.ParamSrc_BaseMap,l=i.GeoEntityType_Other,h=i.IssueEntityType_Other));this.reportType===6&&(p=i.Scenario_Local);f={FORM:i.FORM_ProblemWithSearch,Query:this._query,MapStyle:this.getMap().getMapType().displayName,MapViewBoundingBox:{NELatLon:{Latitude:v.getNorth(),Longitude:v.getEast()},SWLatLon:{Latitude:v.getSouth(),Longitude:v.getWest()}},MapViewCenter:{Latitude:w.latitude,Longitude:w.longitude},Zoom:nt,FeedbackType:i.FeedbackType_DSAT,Scenario:p,Issue:a,UserComment:u,SuggestedEntity:{GeoLocation:{Latitude:this.getPushpinLocation().latitude,Longitude:this.getPushpinLocation().longitude},SuggestedEntityType:h},IsPushpinMoved:this.isPushpinMoved(),ScenarioKey:this._scenarioKey};this.reportType===2||this.reportType===3?(f.IssueEntity={GeoLocation:{Latitude:this.initLocationOfPushpin.latitude,Longitude:this.initLocationOfPushpin.longitude},Name:this.feedbackTask.getTitle()},f.IssueEntityType=i.IssueEntityType_Address):this.reportType===5?(f.IssueEntity={GeoLocation:{Latitude:this.initLocationOfPushpin.latitude,Longitude:this.initLocationOfPushpin.longitude},Name:this.feedbackTask.getTitle(),Identifier:{Identifier:this._taskStateId}},f.IssueEntityType=i.IssueEntityType_Place):this.reportType===6&&(f.IssueEntityType=i.IssueEntityType_Business);n&&y===2&&(f.SuggestedEntity.Address={AddressLine:this.businessAddress,City:this.businessCity,PostalCode:this.businessPostalCode,Subdivision:this.businessState},f.SuggestedEntity.Name=this.businessName,f.SuggestedEntity.PrimaryPhone=this.businessPhone,f.SuggestedEntity.PrimaryWebsite=this.businessWebsite,this.userFacts&&this.userFacts.Id&&(f.Id=this.userFacts.Id),this.userFacts&&this.userFacts.EmailAddress&&(f.EmailAddress=this.userFacts.EmailAddress),f.UserEmailRequested=this.getUserEmailRequested()?!0:!1,f.ServerSideAPIEnabled=!0,this._rapEntryPoint&&(f.rapentrypoint=this._rapEntryPoint,f.rappartner="MapsV8"));(this.reportType===1||this.reportType===6)&&this.getNoFoundType().value===2?(f.Comments=f.UserComment,this.feedbackTask.sendLocalFeedback(f,"NEW",!0,2)):this.feedbackTask.sendSurfFeedback(f,k,o);this.isSubmitted=!0;t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_SearchResult,SR:"SM",RE:this._rapEntryPoint?this._rapEntryPoint:""});this.setShowReportIssuePanel(!1);this.setShowReportNoFoundPanel(!1);this.setShowReportSomethingElsePanel(!1);this.setShowMessagePanel(!1);this.setShowReturnArrowDiv(!0);this.setShowThankYouPanel(!0);this.hidePushpin()}},u.prototype._validateNoResultFeedbackForm=function(i,r,u){var f=!0,o,s="",h=this.getNoFoundType().value;return i&&r.length===0?(s=n.L_Fdbk_GeneralFeedback_Reminder,o="RI",f=!1):(this.reportType===1||this.reportType===6)&&h===2&&(this.getShowMovePushpinMessage()&&(this.isPushpinMoved()===!1?(s=n.L_Fdbk_BusinessNotFound_PushpinNotMoved_ErrorMessage,o="RP",f=!1,this.setShowDragPushPinErrorMessage(!0)):this.setShowDragPushPinErrorMessage(!1)),this.businessName!==null&&this.businessName.length===0?(s=n.L_Fdbk_BusinessNotFound_RequiredFields_Missing_ErrorMessage,o="RI",f=!1,this.setIsFBBusinessNameFieldValid(!1)):this.setIsFBBusinessNameFieldValid(!0),this.businessCity!==null&&this.businessCity.length===0?(s=n.L_Fdbk_BusinessNotFound_RequiredFields_Missing_ErrorMessage,o="RI",f=!1,this.setIsFBBusinessCityFieldValid(!1)):this.setIsFBBusinessCityFieldValid(!0)),f?this._showMessagePanel(!1):(this._showMessagePanel(!0,s),t.log(e.Feedback,u?c.Submitted:t.InlineValidationFailure,{FT:t.FeedbackType_SearchResult,SR:o,RE:this._rapEntryPoint?this._rapEntryPoint:""})),f},u.prototype._prePopulateSubProblemDropdowns=function(){this.subProblemTypes=[];this.subProblemTypes.push({text:n.L_Fdbk_SelectSubProblem,value:0});this.reportType===2?(this.subProblemTypes.push({text:n.L_Fdbk_AddressLocationIncorrect,value:11}),this.subProblemTypes.push({text:n.L_Fdbk_AddressZipIncorrect,value:13})):this.reportType===3?(this.subProblemTypes.push({text:n.L_Fdbk_AddressOfLocationIncorrect,value:49}),this.subProblemTypes.push({text:n.L_Fdbk_AddressZipIncorrect,value:13})):(this.subProblemTypes.push({text:n.L_Fdbk_nameIncorrect,value:47}),this.subProblemTypes.push({text:n.L_Fdbk_locationIncorrect,value:48}));this.subProblemTypes.push({text:n.L_Fdbk_Other,value:51});this.setSubProblemType({text:n.L_Fdbk_SelectSubProblem,value:0})},u.prototype._prePopulateNoFoundTypes=function(){this.noFoundTypes=[{text:n.L_Fdbk_NoFoundSelect,value:0},{text:n.L_Fdbk_NoFoundAddress,value:1},{text:n.L_Fdbk_NoFoundBusiness,value:2},{text:n.L_Fdbk_NoFoundPopulatedPlace,value:3},{text:n.L_Fdbk_NoFoundPopulatedOther,value:4}];this.setNoFoundType({text:n.L_Fdbk_NoFoundSelect,value:0})},u.prototype._showMessagePanel=function(n,t){n?(this.setShowMessagePanel(!0),this.setReminderMessage(t)):(this.setShowMessagePanel(!1),this.setReminderMessage(""))},u.prototype._onUnitsNoFoundChanged=function(n,t){this._problemTypeOptionsUnit&&this.setUnitsIssue(!t);t&&(this._problemTypeOptionsUnit=1)},u.prototype._onUnitsIssueChanged=function(n,t){this._problemTypeOptionsUnit&&this.setUnitsNoFound(!t);t&&(this._problemTypeOptionsUnit=2)},u.prototype._onSubProblemTypeChanged=function(n,t){n&&(this._showPushPinReminder(t.value===49||t.value===48),this.setShowMessagePanel(!1))},u.prototype._onNoFoundTypeChanged=function(n,t){n&&(this.setShowBusinessDiv(t.value===2),this._showPushPinReminder(t.value===1||t.value===2||t.value===3),this.setShowMessagePanel(!1));this.setFeedbackCommentsTextAreaHeight(t.value===2?3:6)},u.prototype._getStyleString=function(n){return'<span class="searchResultString">'+n.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"<\/span>"},u.prototype._showPushPinReminder=function(n){this.setShowMovePushpinMessage(n);this.showPushiPinTip(n)},u.prototype._focusInThankYouPanel=function(){r.prototype._focusInThankYouPanel.call(this)},u}(p),di=function(n){function f(t,i,r){var u=this,f={};return u=n.call(this,f,t,yi,i)||this,u.controlTemplateFactory1=t,u.feedbackType=6,r&&(u.reportType=r.reportType?r.reportType:0,u._query=r.query?r.query:"",r.pushPinLocation&&(u.initLocationOfPushpin=r.pushPinLocation),r.taskStateId&&(u._taskStateId=r.taskStateId),r.scenarioKey&&(u._scenarioKey=r.scenarioKey),r.userFacts&&(u.userFacts=r.userFacts),r.rapEntryPoint&&(u._rapEntryPoint=r.rapEntryPoint),u.parentTaskId=r.dataFacts?r.dataFacts.parentId?r.dataFacts.parentId:"":""),f.defineProperty("showFeedbackForm"),f.defineProperty("showBackToEditButton"),f.defineProperty("showSuggestions"),f.defineProperty("showThankYouPanel"),f.defineProperty("userEmailRequested"),f.defineProperty("showSendEmailConsent"),f.defineProperty("showDragPushPinErrorMessage"),f.defineProperty("showAllFields"),f.defineProperty("businessCity"),f.defineProperty("businessState"),u.setShowBackToEditButton(!0),u.setShowFeedbackForm(!0),u.setShowSuggestions(!1),u.setShowThankYouPanel(!1),u.setShowSendEmailConsent(!1),u.setUserEmailRequested(!1),u.setShowAllFields(!1),u._isPushpinManuallyUpdated=!1,u._isAddressGeocoded=!1,u.userFacts&&u.userFacts.Id&&(u.userFacts.EmailAddress||JSON.parse(u.userFacts.EnableEmailBackfill.toLowerCase()))&&(u.setUserEmailRequested(!0),u.setShowSendEmailConsent(!0)),u._reverseGeocodePushpin(function(n,t){u._isValidField(u.businessAddress)||u._isValidField(u.getBusinessCity())||u._isValidField(u.getBusinessState())||u._isValidField(u.businessPostalCode)||(u.setBusinessCity(n),u.setBusinessState(t),u._initialBusinessCity=n,u._initialBusinessState=t)}),u}return l(f,n),f.prototype.showAutoSuggPushpin=function(n){f.taskOfAutoSuggPushpinOverlayShowing=this.feedbackTask.id;this._autoSuggFeedbackLayer.setVisible(n);this.invalidated.invoke()},f.prototype.createAutoSuggPushpin=function(){var t=new ct("","",null),i=this.initLocationOfPushpin,n=new oi(i,t,ft.getImageFromCss("feedbackPushpin"));n.layer=this._autoSuggFeedbackLayer;n.entity.collisionBehavior=2;this._pushpins.push(n)},f.prototype.onReturnToSearchResultClick=function(n){n.preventDefault();v.invokeHandler(a.taskDataHandlerKey,{action:"remove",id:this.feedbackTask.id})},f.prototype.onMeFeedbackSubmitClick=function(n){var u,i,r;(n.preventDefault(),n.stopPropagation(),t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestSubmitClicked}),u=this._validateNoResultFeedbackForm(),u)&&(i=this,r=function(){var n=i.numberOfSuggFetched>0;i.isSnrRequestCompleted&&n?(i.setShowFeedbackForm(!1),i.hidePushpin(),i.setShowSuggestions(!0),t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestShowSugg,DATA:i.numberOfSuggFetched})):(i.processSubmitBeforeSendingData(),t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestSubmitDirectly}))},this.isSnrRequestCompleted?r(n):(Microsoft.Maps.setTimeout(function(){r(n)},1e3),t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestWaitForSNR})))},f.prototype.onMeFeedbackBackToEditClick=function(n){n.preventDefault();n.stopPropagation();this.getShowBackToEditButton()&&(this.setShowSuggestions(!1),this.setShowFeedbackForm(!0),this.showPushpin(),this.closeChildLocalDetailsCard(),t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestBackToEditClicked}))},f.prototype.closeChildLocalDetailsCard=function(){var f=document.querySelector("[data-subtaskid='"+this.feedbackTask.id+"']"),t,n,i,r,u;f&&(t=f.getAttribute("data-taskid"),t)&&((n=document.querySelectorAll("[data-taskid='"+t+"']"),!n||n.length<2)||(i=n[1],r=i.getAttribute("data-subtaskid"),r&&r.indexOf("LocalDetailsTask")==0&&(u=i.querySelector(".cardFace .panelClose"),u&&u.click())))},f.prototype.onMeFeedbackSubmitAnywayClick=function(n){n.preventDefault();n.stopPropagation();this.closeChildLocalDetailsCard();this.processSubmitBeforeSendingData();t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestSubmitAnywayClicked})},f.prototype.processSubmitBeforeSendingData=function(){var n=this;this._isAddressGeocoded===!1?this._geocodeAddressAndMovePushpin(function(t){n._isAddressGeocoded=t;n._sendSerfData()}):this._sendSerfData()},f.prototype.boolToDragPinMessageClass=function(n){var t="mefeedbackCardMovePinReminderDiv";return n===!0&&(t+=" requiredInputMissing"),t},f.prototype.boolToCaptureUserEmailDisplay=function(n){var t="none";return n===!0&&(t="inline"),t},f.prototype.onBlurFBRequiredInputFieldName=function(){if(this._validateField(this.businessName,".inputFieldBlock.name",f.nameValidationFailureIdentifier),u&&u.enableAutoSuggestOnMe&&this._isValidField(this.businessName)&&this._isValidField(this.getBusinessCity())&&this.lastBusinessName!=this.businessName){var n=this._isValidField(this.businessAddress)?this.businessAddress:"";n+=this.getBusinessCity();this.GetAutoSuggestions(this.businessName,n)}this.lastBusinessName=this.businessName},f.prototype.onBlurFBRequiredInputFieldAddress=function(n){var t=this;this._isAddressGeocoded=!1;n.target&&n.target.classList&&n.target.classList.contains("mefbBusinessCity")&&this._validateField(this.getBusinessCity(),".inputFieldBlock.city",f.cityValidationFailureIdentifier);this._geocodeAddressAndMovePushpin(function(n){t._isAddressGeocoded=n});u&&u.enableAutoSuggestOnMe&&n.target&&n.target.classList&&n.target.classList.contains("fbBusinessAddress")&&this.lastBusinessAddress!=this.businessAddress&&this._isValidField(this.businessName)&&this._isValidField(this.businessAddress)&&this.GetAutoSuggestions(this.businessName,this.businessAddress);this.lastBusinessAddress=this.businessAddress},f.prototype._validateField=function(n,i,r){var f=this._isValidField(n),u=this.feedbackTask.panelRoot.select(i);return u!==null&&u!==undefined&&(f===!1?u.add_class("requiredInputMissing"):u.remove_class("requiredInputMissing")),f===!1&&t.log(e.Feedback,t.InlineValidationFailure,{FT:t.FeedbackType_MissingEntity,SR:r,RE:this._rapEntryPoint?this._rapEntryPoint:""}),f},f.prototype._validateAddress=function(){var n=this._validateField(this.businessAddress,".inputFieldBlock.address",f.addressValidationFailureIdentifier),t=this.isPushpinMoved()||this._isPushpinManuallyUpdated,i=this._isValidField(this.businessPhone);return n?!0:t||i},f.prototype._isAddressValidForGeocode=function(){return this._isValidField(this.businessAddress)&&this._isValidField(this.getBusinessCity())},f.prototype._isValidField=function(n){return n!==undefined&&n!==null&&n.length!==0},f.prototype.onPushPinUpdate=function(){this.setShowDragPushPinErrorMessage(!1);this._isPushpinManuallyUpdated=!0},f.prototype._geocodeAddressAndMovePushpin=function(n){var t=this,i;this.feedbackTask.geoCoder&&this._isPushpinManuallyUpdated===!1&&this._isAddressValidForGeocode()?(i=this.businessAddress+", "+this.getBusinessCity()+", "+this.getBusinessState()+", "+this.businessPostalCode,this.feedbackTask.geoCoder.geocode(i,function(i){if(i.success&&i.results&&i.results.length>0&&i.results[0].confidence=="High"&&t._isPushpinManuallyUpdated===!1)if(t._isAutoGeocodeEnabled(i.results[0].address.countryRegionIso2)){var u=i.results[0].point,r=new w(u.coordinates[0],u.coordinates[1]);t.updatePushpin(r);t.updateDragPin(!0,r);s.setMapCenter(t.getMap(),r);s.setZoomLevel(t.getMap(),16);t.setShowDragPushPinErrorMessage(!1);n(!0)}else n(!1);else n(!1)},this.feedbackTask.map.getBounds(),1,!0,!0)):n(!1)},f.prototype._isAutoGeocodeEnabled=function(n){var t=!1,i;return u&&u.autoGeocodeMissingBusinessAddressMarkets&&(i=new RegExp(n,"i"),u.autoGeocodeMissingBusinessAddressMarkets.search(i)>=0&&(t=!0)),t},f.prototype._sendSerfData=function(){var l=this,r=s.getMapBounds(this.getMap(),!1),u=s.getMapCenter(this.getMap()),a=s.getMercatorZoomLevel(this.getMap()),f="",o="",h=i.Scenario_Map,n;if(f=i.IssueEntityType_Business,h=i.Scenario_Local,o=i.Issue_DidnotFindBusiness,n={FORM:i.FORM_ProblemWithSearch,Query:this._query,MapStyle:this.getMap().getMapType().displayName,MapViewBoundingBox:{NELatLon:{Latitude:r.getNorth(),Longitude:r.getEast()},SWLatLon:{Latitude:r.getSouth(),Longitude:r.getWest()}},MapViewCenter:{Latitude:u.latitude,Longitude:u.longitude},Zoom:a,FeedbackType:i.FeedbackType_DSAT,Scenario:h,Issue:o,UserComment:this.commentsSearchResultNotFound,Comments:this.commentsSearchResultNotFound,SuggestedEntity:{GeoLocation:{Latitude:this.getPushpinLocation().latitude,Longitude:this.getPushpinLocation().longitude},SuggestedEntityType:f},IsPushpinMoved:this.isPushpinMoved(),IsPushpinManuallyUpdated:this._isPushpinManuallyUpdated,ScenarioKey:this._scenarioKey},n.InitialBusinessCity=this._initialBusinessCity,n.InitialBusinessState=this._initialBusinessState,n.InitialPinLocation={Latitude:this.initLocationOfPushpin.latitude,Longitude:this.initLocationOfPushpin.longitude},n.IssueEntityType=i.IssueEntityType_Business,n.SuggestedEntity.Address={AddressLine:this.businessAddress,City:this.getBusinessCity(),PostalCode:this.businessPostalCode,Subdivision:this.getBusinessState()},n.SuggestedEntity.Name=this.businessName,n.SuggestedEntity.PrimaryPhone=this.businessPhone,n.SuggestedEntity.PrimaryWebsite=this.businessWebsite,this.userFacts&&this.userFacts.Id&&(n.Id=this.userFacts.Id),this.userFacts&&this.userFacts.EmailAddress&&(n.EmailAddress=this.userFacts.EmailAddress),n.UserEmailRequested=this.getUserEmailRequested()?!0:!1,n.ServerSideAPIEnabled=!0,this._rapEntryPoint){switch(this._rapEntryPoint){case 4:n.rapentrypoint="LocalListingMissingEntityLink";break;case 1:n.rapentrypoint="NoResultsCardMissingEntityLink";break;case 2:n.rapentrypoint="NoResultsCardRAPLink";break;case 3:n.rapentrypoint="RAPMenu";break;case 5:n.rapentrypoint="SuggestAnEditMissingEntityLink"}n.rappartner="MapsV8"}this._reverseGeocodePushpin(function(t,i,r){n.SuggestedEntity.Address.CountryCode=r;l.feedbackTask.sendLocalFeedback(n,"NEW",!0,2)});this.isSubmitted=!0;t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_MissingEntity,SR:"SM",RE:this._rapEntryPoint?this._rapEntryPoint:""});this.setShowFeedbackForm(!1);this.setShowSuggestions(!1);this.setShowThankYouPanel(!0);this.hidePushpin()},f.prototype._validateNoResultFeedbackForm=function(){var n=!0,i="",r=this._validateField(this.businessName,".inputFieldBlock.name",f.nameValidationFailureIdentifier),u=this._validateField(this.getBusinessCity(),".inputFieldBlock.city",f.cityValidationFailureIdentifier),o=this._validateAddress();return r===!1&&(i+=f.nameValidationFailureIdentifier,n=!1),o===!1&&(i+=f.addressValidationFailureIdentifier,n=!1),u===!1&&(i+=f.cityValidationFailureIdentifier,n=!1),n||t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_MissingEntity,SR:i,RE:this._rapEntryPoint?this._rapEntryPoint:""}),n},f.prototype._reverseGeocodePushpin=function(n){this.feedbackTask.reverseGeocoder?this.feedbackTask.reverseGeocoder.reverseGeocode(this.getPushpinLocation(),function(t){if(t&&t.success&&t.addressList&&t.addressList.length>0){var i=t.addressList[0].countryRegionIso2?t.addressList[0].countryRegionIso2:"",r=t.addressList[0].adminDistrict?t.addressList[0].adminDistrict:"",u=t.addressList[0].locality?t.addressList[0].locality:"";n(u,r,i)}else n("","","")},[],!0,0):n("","","")},f.showASEntityPin=function(n,t,i,r){f._autoSuggPushpinOverlay||(f._autoSuggPushpinOverlay=new yt(t));f._asPushpinOverlayShowing||(n.getOverlays().insert(f._autoSuggPushpinOverlay),f._asPushpinOverlayShowing=!0);f._autoSuggPushpinOverlay.setAlignment(i);f._autoSuggPushpinOverlay.setAnchor(new lt(i.latitude,i.longitude));f._autoSuggPushpinOverlay.setShowPin(r)},f.hideDragPin=function(n){f._autoSuggPushpinOverlay&&(f._asPushpinOverlayShowing=!1,f._autoSuggPushpinOverlay.setShowTip(!1),n.getOverlays().remove(f._autoSuggPushpinOverlay))},f.prototype.findAncestor=function(n,t){while((n=n.parentElement)&&n.className.indexOf(t)<0);return n},f.prototype.processItemClickEvent=function(n,t){var f=this,e=this.findAncestor(n.target,"me-listings-item"),o=e.getAttribute("data-entity"),s=r.Internals.parseJSON(o),i,h,c,u;(t=s.entity.id,this.autoSuggCurrentSelectedEntity!=t)&&(i=this.feedbackTask.panelRoot.select("a[data-entity]"),h=0,c=this,i.for_each(function(n){var s=n.getAttribute("data-entity"),i=r.Internals.parseJSON(s),o,e;i&&i.entity&&i.entity.id&&(o=r(n),e=i.entity.id,e&&(e==t?(o.add_class("hover"),u=t):e==f.autoSuggCurrentSelectedEntity&&o.remove_class("hover")))}),this.autoSuggCurrentSelectedEntity=u)},f.prototype.GetAutoSuggestions=function(n,i){var c=this,o=this,s=n+" in "+i;o.isSnrRequestCompleted=!1;o.numberOfSuggFetched=0;o.autoSuggListElements=[];o.feedbackTask.panelRoot.select(".me-b_vList").set_style({visibility:"hidden"});t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestInitiationIdentifier,QUERY:s});var l={clickHandler:function(n,t){return c.processItemClickEvent(n,t)}},a=function(n){var ot=Date.now(),st=ot-w,i,c,rt,v,nt,et;if(t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestSNRResponseTime,DATA:st}),o.feedbackTask.panelRoot.select(".me-b_vList").clear(),n!=null&&n.value!=null&&n.value.length>0){var p=n.value,ht=o.feedbackTask.id,a="";for(c in p)i=p[c],a+=i!=null&&i.bingId!=null?i.bingId+"|":"";a=a[a.length-1]=="|"?a.substring(a.length-1):a;t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestListingAnswerFetchedIdentifier,ID:a,RS:p.length});p=p.slice(0,3);for(c in p){var i=p[c],k=i.geo!=null?i.geo.latitude:null,d=i.geo!=null?i.geo.longitude:null,wt=i.geo,bt=i.routablePoint,b=i.bingId,g=i.name,tt=i.address.text,ct=i.menuUrl,ut=i.telephone,lt=i.url,at=i.image?i.image.contentUrl.substring(u.imageUrlPrefix.length)+"&w=76&h=108&c=7&rs=1&qlt=80&cdv=1":"",h=i.aggregateRating?i.aggregateRating.ratingValue/2:null,ft=i.aggregateRating?i.aggregateRating.reviewCount:null,it=null;if(i.review&&i.review.length>0)for(c in i.review)if(i.review[c].provider&&i.review[c].provider.length>0&&i.review[c].provider[0].name){it=i.review[c].provider[0].name;break}rt=sj_ce("li","","");v=sj_ce("a","","me-listings-item");v.setAttribute("href","#");var vt={geometryType:1,geometry:{x:k,y:d,bounds:[k,d,k,d]},entity:{title:g,id:"ypid: "+b,address:tt,menuUrl:ct,phone:ut,website:lt},routablePoint:{latitude:k,longitude:d}},yt={state:{entryPoint:"LocalListing",id:"ypid:"+b,flippingCard:!0,taskTitle:g},type:y.localDetailsTask,activateOptions:{parentId:ht}},pt={logData:{feature:t.FeedbackType_AutoSuggest,action:f.autoSuggestListingAnswerClickedIdentifier,data:{ID:"ypid:"+b,Q:g,PO:c+1}}};v.setAttribute("data-entity",r.Internals.stringify(vt));v.setAttribute("data-task",r.Internals.stringify(yt));v.setAttribute("data-instrumentation",r.Internals.stringify(pt));nt='<div><div class="me-b_imagePair me-tall_m"><div class="inner"><div class="cico" style="width:76px; height:108px;" ><img height="108" width="76" src="'+at+'" /><\/div><\/div><div class="me-b_vPanel" ><div><div class="me-b_factrow" >'+g+'<\/div><\/div><div><div class="me-b_factrow"><span title="'+tt+'" class="b_address" >'+tt+"<\/span><\/div> <\/div>";h&&ft&&it&&(nt+='<div><div class="me-b_factrow"><span class="csrc sc_rc1" role= "img" aria-label="Star Rating: '+h+' out of 5." ><span class='+(h&&h>0?h>.5?"sw_st":"sw_sth":"sw_ste")+"><\/span><span class="+(h&&h>1?h>1.5?"sw_st":"sw_sth":"sw_ste")+"><\/span><span class="+(h&&h>2?h>2.5?"sw_st":"sw_sth":"sw_ste")+"><\/span><span class="+(h&&h>3?h>3.5?"sw_st":"sw_sth":"sw_ste")+"><\/span><span class="+(h&&h>4?h>4.5?"sw_st":"sw_sth":"sw_ste")+"><\/span><\/span>"+it+" ("+ft+")<\/div><\/div>");nt+='<div><div class="me-b_factrow" >'+ut+"<\/div><\/div><\/div><\/div><\/div>";v.innerHTML=nt;rt.appendChild(v);et=r(v);o.autoSuggListElements.push(b);et.add_event("click",function(n){return l.clickHandler(n,b)});o.feedbackTask.panelRoot.select(".me-b_vList").append(rt);o.feedbackTask.panelRoot.select(".me-b_vList").set_style({visibility:"visible"});o.numberOfSuggFetched++}t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestCompletionIdentifier})}else t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestNoResultsFound,QUERY:s});o.isSnrRequestCompleted=!0},v=function(n){t.log(e.Feedback,t.FeedbackType_AutoSuggest,{FT:t.FeedbackType_AutoSuggest,SR:f.autoSuggestSnrErrorIdentifier,DATA:n});o.isSnrRequestCompleted=!0},h=k.dynamicProperties.market.toLowerCase(),p=u.snrSearchUrlPrefix+"?appid="+u.snrSearchAppId+"&q="+s+"&count="+u.snrSearchCount+"&mkt="+h+"&setlang="+h,w=Date.now();this.networkRequestId=g.downloadJson(p,null,a,v,null,null,1,null,null)},f.prototype.onTaskStateChanged=function(t){var u,i;n.prototype.onTaskStateChanged.call(this,t);t.activationState===1&&h._getIsSlideCardEnabled()&&(u=this.feedbackTask.panelRoot&&this.feedbackTask.panelRoot.length?this.feedbackTask.panelRoot[0]:null,u&&(i=r("."+f._hoverClassName,u),i&&i.length>0&&(i.remove_class(f._hoverClassName),this.setShowBackToEditButton(!0))));t.activationState===1&&t.prominence===1&&this.feedbackType!==1&&!this.isSubmitted&&this.getShowSuggestions()&&this.hidePushpin()},f.prototype._focusInThankYouPanel=function(){n.prototype._focusInThankYouPanel.call(this)},f.nameValidationFailureIdentifier="RN",f.cityValidationFailureIdentifier="RC",f.addressValidationFailureIdentifier="RA",f.autoSuggestInitiationIdentifier="IN",f.autoSuggestCompletionIdentifier="CM",f.autoSuggestSnrErrorIdentifier="ERR",f.autoSuggestListingAnswerClickedIdentifier="ASL_C",f.autoSuggestListingAnswerFetchedIdentifier="ASL_F",f.autoSuggestShowSugg="SS",f.autoSuggestNoResultsFound="NR",f.autoSuggestSubmitClicked="SC",f.autoSuggestWaitForSNR="WS",f.autoSuggestBackToEditClicked="BE",f.autoSuggestSubmitDirectly="SD",f.autoSuggestSubmitAnywayClicked="SA",f.autoSuggestSNRResponseTime="RT",f._hoverClassName="hover",f}(p),gi=function(r){function u(n,t,i){var u=this,f={};return u=r.call(this,f,n,ci,t)||this,u.feedbackType=5,i&&(u.reportType=i.reportType?i.reportType:0,i.pushPinLocation&&(u.initLocationOfPushpin=i.pushPinLocation),u._directionTaskState=i.taskState,i.directionStepsList&&(u._stepsList=i.directionStepsList),i.directionRouteIndex&&(u._directionRouteIndex=i.directionRouteIndex)),u.isLabelAdded=!1,f.defineProperty("showReportSomethingElsePanel"),f.defineProperty("showThankYouPanel"),f.defineProperty("showMessagePanel"),f.defineProperty("showFeedbackPanel"),f.defineProperty("showMovePushpinMessage"),f.defineProperty("directionsIssueType",u._onDirectionsIssueTypeChanged),f.defineProperty("reminderMessage"),f.defineProperty("movingPinMessage"),f.defineProperty("showCommentsDiv"),f.defineProperty("showStepsDiv"),u._prePopulateDirectionsIssueTypeDropdowns(),u.setShowFeedbackPanel(!0),u.setShowReportSomethingElsePanel(!0),u.setShowMessagePanel(!1),u.setShowMovePushpinMessage(!1),u.setShowThankYouPanel(!1),u.setShowStepsDiv(!1),u.setShowCommentsDiv(!0),u.steps=new nt,u}return l(u,r),u.prototype.onTaskStateChanged=function(n){this.getDirectionsIssueType().value>=10?r.prototype.onTaskStateChanged.call(this,n):(this.hidePushpin(),n.animationState===1&&this.setFocusToDefaultElement())},u.prototype.onReturnToSearchResultClick=function(n){n.preventDefault();v.invokeHandler(a.taskDataHandlerKey,{action:"remove",id:this.feedbackTask.id})},u.prototype.onReportSomethingElseLinkClick=function(t){t.preventDefault();v.invokeHandler(a.taskDataHandlerKey,{type:y.feedbackTask,state:{entryPoint:3,feedbackTaskType:2,title:n.L_Fdbk_ReportAProblem}})},u.prototype.onDirectionsFeedbackSendClick=function(r){var y,p,w,f,o;if(r.preventDefault(),this.getDirectionsIssueType().value===0&&this.commentsDirectionsIssue.length===0){this._showMessagePanel(!0,n.L_Fdbk_GeneralFeedback_Reminder);t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_Directions,SR:"RI"});return}var v=s.getMapBounds(this.getMap(),!1),k=s.getMapCenter(this.getMap()),tt=s.getMercatorZoomLevel(this.getMap()),u={FORM:i.FORM_ProblemWithDirections,MapStyle:this.getMap().getMapType().displayName,MapViewBoundingBox:{NELatLon:{Latitude:v.getNorth(),Longitude:v.getEast()},SWLatLon:{Latitude:v.getSouth(),Longitude:v.getWest()}},MapViewCenter:{Latitude:k.latitude,Longitude:k.longitude},Zoom:tt,FeedbackType:i.FeedbackType_DSAT,Scenario:i.Scenario_Direction,Issue:i.GetDirectionsIssue(this.getDirectionsIssueType().value),IsPushpinMoved:this.isPushpinMoved()},h=null,l=null,a=null,d=1,g=b.driving,nt=at.departure;if(this._directionTaskState&&(this._directionTaskState.waypoints&&(a=this._directionTaskState.waypoints,h=this._directionTaskState.waypoints[0],l=this._directionTaskState.waypoints[this._directionTaskState.waypoints.length-1]),this._directionTaskState.options&&(this._directionTaskState.options.unit!=gt.miles&&(d=0),nt=this._directionTaskState.options.timeType),g=this._directionTaskState.mode),h&&(u.From=this._getWayPointString(h),u.GeocodedFrom=this._getWayPointString(h),h.point&&(u.GeocodedFromLatLong={Latitude:h.point.latitude,Longitude:h.point.longitude})),l&&(u.To=this._getWayPointString(l),u.GeocodedTo=this._getWayPointString(l),l.point&&(u.GeocodedToLatLong={Latitude:l.point.latitude,Longitude:l.point.longitude})),this.getDirectionsIssueType().value===1){for(y={},f=0;f<this.steps.length;f++)p=f+1,y["Step"+p]={StepIndex:p,ProblemDetails:this.steps[f].getCommentsDirectionsStep(),StepDescription:this.steps[f].getDirectionsIssueStep().value};for(u.InaccurateSteps=y,u.DirectionsRouteRequest={AvoidOption:!1,DistanceUnitOption:d,MaxSolutionsOptions:3,OptimizeOption:"Time",RouteIndex:this._directionRouteIndex,RouteModeOption:i.GetDirectionsMode(g),TimeTypeOption:i.GetDirectionsTimeType(nt)},w={},f=0;f<a.length;f++)o=a[f],o&&(w["WayPoint"+f]={Address:this._getWayPointString(o),IsViaPoint:!1,Latitude:o.point.latitude,Longitude:o.point.longitude});u.DirectionsRouteRequest.WayPoints=w}else this.getDirectionsIssueType().value>=10?(a&&(o=a[this.getDirectionsIssueType().value-10],o.point&&(u.IssueEntity={GeoLocation:{Latitude:o.point.latitude,Longitude:o.point.longitude},Identifier:{Identifier:i.Identifier_Unknown},Name:o.name})),u.SuggestedEntity={GeoLocation:{Latitude:this.getPushpinLocation().latitude,Longitude:this.getPushpinLocation().longitude}},u.UserComment=this.commentsDirectionsIssue):u.UserComment=this.commentsDirectionsIssue;this.feedbackTask.sendSurfFeedback(u,i.ParamFt_Directions,i.ParamSrc_Directions);this.isSubmitted=!0;t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_Directions,SR:"SM"});this.setShowReportSomethingElsePanel(!1);this.setShowMessagePanel(!1);this.setShowFeedbackPanel(!1);this.setShowThankYouPanel(!0);this.hidePushpin()},u.prototype.onAddStepClick=function(n){n.preventDefault();this.addStep()},u.prototype._prePopulateDirectionsIssueTypeDropdowns=function(){var i,t,r;for(this.directionsIssueTypes=[],this.directionsIssueTypes.push({text:n.L_Fdbk_SelectSubProblem,value:0}),this._directionTaskState&&this._directionTaskState.mode===b.transit&&(this.directionsIssueTypes.push({text:n.L_Fdbk_BetterRoute,value:3}),this.directionsIssueTypes.push({text:n.L_Fdbk_IncorrectTimesTransit,value:4}),this.directionsIssueTypes.push({text:n.L_Fdbk_IncorrectLocationTransitStop,value:5})),this.directionsIssueTypes.push({text:n.L_Fdbk_WrongDirections,value:1}),i=this._directionTaskState&&this._directionTaskState.waypoints,t=0;t<i.length;t++)r=i[t].name?i[t].name:i[t].address,r&&this.directionsIssueTypes.push({text:h._formatString(n.L_Fdbk_LocationInDirectionsIncorrect,r),value:10+t});this.directionsIssueTypes.push({text:n.L_Fdbk_Other,value:2});this.setDirectionsIssueType({text:n.L_Fdbk_SelectSubProblem,value:0})},u.prototype._showMessagePanel=function(n,t){n?(this.setShowMessagePanel(!0),this.setReminderMessage(t)):(this.setShowMessagePanel(!1),this.setReminderMessage(""))},u.prototype._onDirectionsIssueTypeChanged=function(n){if(n){if(this.getDirectionsIssueType().value>=10){this.setShowMovePushpinMessage(!0);var t=this._directionTaskState.waypoints;this.initLocationOfPushpin=t[this.getDirectionsIssueType().value-10].point;this.updatePushpin(this.initLocationOfPushpin);this.showPushpin();this.showPushiPinTip(!0);this.setShowStepsDiv(!1);this.setShowCommentsDiv(!0)}else this.setShowMovePushpinMessage(!1),this.showPushiPinTip(!1),this.hidePushpin(),this.setShowStepsDiv(!1),this.setShowCommentsDiv(!0),this.getDirectionsIssueType().value===1&&(this.steps.length===0&&this.addStep(),this.setShowCommentsDiv(!1),this.setShowStepsDiv(!0));this.setShowMessagePanel(!1)}},u.prototype._getWayPointString=function(n){return n.name&&n.address?n.name+","+n.address:n.name?n.name:n.address},u.prototype.addStep=function(){var n=new er(this._stepsList,this);this.steps.insert(n)},u.prototype._focusInThankYouPanel=function(){r.prototype._focusInThankYouPanel.call(this)},u}(p),nr=function(i){function f(n,t,r){var f=this,e={};return f=i.call(this,e,n,vi,t)||this,f.isLabelAdded=!1,f.feedbackType=4,f.businessNameActive=!1,f.businessAddressActive=!1,f.businessPhoneActive=!1,f.businessWebsiteActive=!1,f.businessLocationActive=!1,f.closedOptionsActive=!1,f.eventHandlerAdded=!1,f.isNameMarkIncorrect=!1,f.isAddressMarkIncorrect=!1,f.isPhoneMarkIncorrect=!1,f.isWebsiteMarkIncorrect=!1,f.isHoursMarkIncorrect=!1,f.isLocationMarkIncorrect=!1,f.reportType=r&&r.reportType?r.reportType:0,f.query=r&&r.query?r.query:"",r&&r.localSearchEntity&&(f.localSearchEntity=ot.cloneFrom(r.localSearchEntity)),r&&r.entityYpid&&(f.ypid=r.entityYpid.split(":")[1]),r&&r.pushPinLocation&&(f.initLocationOfPushpin=r.pushPinLocation),r&&r.dataFacts&&(f.dataFacts=r.dataFacts),r&&r.userFacts&&(f.userFacts=r.userFacts),f.entityMarket=r.dataFacts.languageCultureName,f.entityName=r.entityName,f.isLabelAdded=!1,f.isClosed=!1,f.isMarkedDetailsIncorrect=!0,e.defineProperty("showReturnArrowDiv"),e.defineProperty("showBasicOptions"),e.defineProperty("showNameOptions"),e.defineProperty("showBusinessName"),e.defineProperty("showAddressOptions"),e.defineProperty("showBusinessAddress"),e.defineProperty("showContactOptions"),e.defineProperty("showBusinessPhone"),e.defineProperty("showWebsiteOptions"),e.defineProperty("showBusinessWebsite"),e.defineProperty("showUserComments"),e.defineProperty("showSendFeedbackButton"),e.defineProperty("showThankYouPanel"),e.defineProperty("showMovePushpinMessage"),e.defineProperty("showAddMissingEntityLink"),e.defineProperty("showSendEmailConsent"),e.defineProperty("isDropdownOpened"),f.isPermClosed=!1,f.dosentExist=!1,f.isPrivate=!1,f.isDuplicate=!1,f.isSpam=!1,f.setIsDropdownOpened(!1),f.setShowReturnArrowDiv(!0),f.setShowBasicOptions(!0),f.setShowNameOptions(!0),f.setShowBusinessName(!1),f.setShowAddressOptions(!0),f.setShowBusinessAddress(!1),f.setShowContactOptions(!0),f.setShowBusinessPhone(!1),f.setShowWebsiteOptions(!0),f.setShowBusinessWebsite(!1),f.setShowUserComments(!0),f.setShowSendFeedbackButton(!0),f.setShowMovePushpinMessage(!1),f.setShowThankYouPanel(!1),u.showAddMissingBusinessLink?f.setShowAddMissingEntityLink(!0):f.setShowAddMissingEntityLink(!1),f._eventHandlers=[],u.enableLocalFeedbackForHOOTask&&f.initHOO(r.dataFacts),f}return l(f,i),f.prototype.onTaskStateChanged=function(t){var f,r;!this.isLabelAdded&&(t.colorIndex||t.animationState)&&(this.getControl().select(".labelDisplayBusinessName").set_html(h._formatString(this.entityName)),this.getControl().select(".labelDisplayBusinessNameIs").set_html(h._formatString(n.L_Fdbk_Business_NameIs,this.entityName)),this.getControl().select(".labelDisplayBusinessAddress").set_html(h._formatString(this.dataFacts.Address?this.dataFacts.Address:this.dataFacts.address?this.dataFacts.address:n.L_Fdbk_Not_Avaliable)),this.getControl().select(".labelDisplayBusinessPhone").set_html(h._formatString(this.dataFacts.Phone?this.dataFacts.Phone:this.dataFacts.phone?this.dataFacts.phone:n.L_Fdbk_Not_Avaliable)),this.getControl().select(".labelDisplayBusinessWebsite").set_html(h._formatString(this.dataFacts.Website?this.dataFacts.Website:this.dataFacts.website?this.dataFacts.website:n.L_Fdbk_Not_Avaliable)),this.getControl().select(".labelDisplayMovePin").set_html(h._formatString("Move Pushpin")),this.isLabelAdded=!0,this._changeDivDisplay("isClosedOptions",!0),this._changeDivDisplay("businessNameUndoId",!1),this._changeDivDisplay("fbBusinessName",!1),this._changeDivDisplay("businessAddressUndoId",!1),this._changeDivDisplay("fbBusinessAddress",!1),this._changeDivDisplay("fbBusinessCity",!1),this._changeDivDisplay("fbBusinessState",!1),this._changeDivDisplay("fbBusinessPostalCode",!1),this._changeDivDisplay("businessPhoneUndoId",!1),this._changeDivDisplay("fbBusinessPhone",!1),this._changeDivDisplay("businessWebsiteUndoId",!1),this._changeDivDisplay("fbBusinessWebsite",!1),this._changeDivDisplay("businessHoursOfOperationUndoId",!1),u.enableLocalFeedbackForHOOTask?(this.initHours(),this._changeDivDisplay("showHoursOptionsDiv",!0),this.hideElement("addHours")):this._changeDivDisplay("showHoursOptionsDiv",!1),this._setWidth("fbBusinessName"),this._setWidth("fbBusinessAddress"),this._setWidth("fbBusinessCity"),this._setWidth("fbBusinessState"),this._setWidth("fbBusinessPostalCode"),this._setWidth("fbBusinessPhone"),this._setWidth("fbBusinessWebsite"),this.userFacts&&this.userFacts.Id&&(this.userFacts.EmailAddress||JSON.parse(this.userFacts.EnableEmailBackfill.toLowerCase()))&&(this.showElement("showUserEmailConsent"),f=this.getElement("userEmailCheckBox"),f.checked=!0),r=this.getElement("detailsIncorrect"),r&&(r.checked=!0,this.initDetailsIncorrect()));i.prototype.onTaskStateChanged.call(this,t)},f.prototype.onPushPinUpdate=function(){},f.prototype.noOp=function(n){n.preventDefault();return},f.prototype.onReturnToSearchResultClick=function(n){n.preventDefault();v.invokeHandler(a.taskDataHandlerKey,{action:"remove",id:this.feedbackTask.id})},f.prototype.onResultFeedbackSendClick=function(n){n.preventDefault();this._sendFeedbackData();t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_LocalResult,SR:"SM"});this._changeDivDisplay("showBasicOptionsDiv",!1);this._changeDivDisplay("expandIncorrectOptionsText",!1);this._changeDivDisplay("markIncorrectText",!1);this._changeDivDisplay("showNameOptionsDiv",!1);this._changeDivDisplay("showAddressOptionsDiv",!1);this._changeDivDisplay("showContactOptionsDiv",!1);this._changeDivDisplay("showWebsiteOptionsDiv",!1);this._changeDivDisplay("showUserCommentsOptionsDiv",!1);this._changeDivDisplay("showSendFeedbackButtonDiv",!1);this._changeDivDisplay("showMapPinOptionsDiv",!1);u.showAddMissingBusinessLink&&this._changeDivDisplay("showAddMissingEntityLinkDiv",!1);this._changeDivDisplay("showHoursOptionsDiv",!1);this.hidePushpin();this.setShowThankYouPanel(!0);this._setFocusInThankYouPanel()},f.prototype.businessNameClicked=function(n){var t,i,r;n.preventDefault();this.isPermClosed||(this._changeDivDisplay("fbBusinessName",!0),this._changeDivDisplay("businessNameUndoId",!0),t=this.getElement("businessDisplayNameId"),t.className+=" detailsStrikeThrough",i=this.getElement("fbBusinessName"),i.value=this.entityName,this.businessNameActive=!0,r=this.getElement("nameWrong"),r.checked=!0)},f.prototype.completeLabel=function(t){return h._formatString(n.L_FdbkEditButtonLabel,t)},f.prototype.businessNameUndo=function(n){var t,i;n.preventDefault();this._changeDivDisplay("businessNameUndoId",!1);this._changeDivDisplay("fbBusinessName",!1);t=this.getElement("businessDisplayNameId");t.className="labelDisplayBusinessName";i=this.getElement("fbBusinessName");this.businessNameActive=!1;i.value=""},f.prototype.businessNameMarkIncorrect=function(n){n.preventDefault();var t=sj_et(n);t.checked?this.businessNameClicked(n):this.businessNameUndo(n)},f.prototype.businessAddressClicked=function(n){var t,i,r,u,f,e;n.preventDefault();this.isPermClosed||(this._changeDivDisplay("businessAddressUndoId",!0),t=this.getElement("businessDisplayAddressId"),t.className+=" detailsStrikeThrough",this._changeDivDisplay("fbBusinessAddress",!0),i=this.getElement("fbBusinessAddress"),i.value=this.dataFacts.addressFields?this.dataFacts.addressFields.addressLine:"",this._changeDivDisplay("fbBusinessCity",!0),r=this.getElement("fbBusinessCity"),r.value=this.dataFacts.addressFields?this.dataFacts.addressFields.city:"",this._changeDivDisplay("fbBusinessState",!0),u=this.getElement("fbBusinessState"),u.value=this.dataFacts.addressFields?this.dataFacts.addressFields.stateMunicipality:"",this._changeDivDisplay("fbBusinessPostalCode",!0),f=this.getElement("fbBusinessPostalCode"),f.value=this.dataFacts.addressFields?this.dataFacts.addressFields.postalCode:"",this.businessAddressActive=!0,e=this.getElement("addressWrong"),e.checked=!0)},f.prototype.businessAddressUndo=function(n){var t,i,r,u,f;n.preventDefault();this._changeDivDisplay("businessAddressUndoId",!1);t=this.getElement("businessDisplayAddressId");t.className="labelDisplayBusinessAddress";this._changeDivDisplay("fbBusinessAddress",!1);this._changeDivDisplay("fbBusinessCity",!1);this._changeDivDisplay("fbBusinessState",!1);this._changeDivDisplay("fbBusinessPostalCode",!1);i=this.getElement("fbBusinessAddress");i.value="";r=this.getElement("fbBusinessCity");r.value="";u=this.getElement("fbBusinessState");u.value="";f=this.getElement("fbBusinessPostalCode");f.value="";this.businessAddressActive=!1},f.prototype.businessAddressMarkIncorrect=function(n){var t=sj_et(n);t.checked?this.businessAddressClicked(n):this.businessAddressUndo(n)},f.prototype.businessPhoneClicked=function(t){var i,r,u;t.preventDefault();this.isPermClosed||(this._changeDivDisplay("businessPhoneUndoId",!0),i=this.getElement("businessDisplayPhoneId"),i.className+=" detailsStrikeThrough",this._changeDivDisplay("fbBusinessPhone",!0),r=this.getElement("fbBusinessPhone"),r.value=i.innerHTML===n.L_Fdbk_Not_Avaliable?"":i.innerHTML,this.businessPhoneActive=!0,u=this.getElement("phoneWrong"),u.checked=!0)},f.prototype.businessPhoneUndo=function(n){var t,i;n.preventDefault();this._changeDivDisplay("businessPhoneUndoId",!1);this._changeDivDisplay("fbBusinessPhone",!1);t=this.getElement("businessDisplayPhoneId");t.className+="labelDisplayBusinessPhone";i=this.getElement("fbBusinessPhone");i.value="";this.businessPhoneActive=!1},f.prototype.businessPhoneMarkIncorrect=function(n){var t=sj_et(n);t.checked?this.businessPhoneClicked(n):this.businessPhoneUndo(n)},f.prototype.businessWebsiteClicked=function(t){var i,r,u;t.preventDefault();this.isPermClosed||(this._changeDivDisplay("fbBusinessWebsite",!0),this._changeDivDisplay("businessWebsiteUndoId",!0),i=this.getElement("labelDisplayBusinessWebsiteId"),i.className+=" detailsStrikeThrough",r=this.getElement("fbBusinessWebsite"),r.value=i.innerHTML===n.L_Fdbk_Not_Avaliable?"":i.innerHTML,this.businessWebsiteActive=!0,u=this.getElement("websiteWrong"),u.checked=!0)},f.prototype.businessWebsiteUndo=function(n){var t,i;n.preventDefault();this._changeDivDisplay("fbBusinessWebsite",!1);this._changeDivDisplay("businessWebsiteUndoId",!1);t=this.getElement("labelDisplayBusinessWebsiteId");t.className+="labelDisplayBusinessWebsite";i=this.getElement("fbBusinessWebsite");i.value="";this.businessWebsiteActive=!1},f.prototype.businessWebsiteMarkIncorrect=function(n){var t=sj_et(n);t.checked?this.businessWebsiteClicked(n):this.businessWebsiteUndo(n)},f.prototype.mapMovePinClicked=function(n){n.preventDefault();this.businessLocationActive=!0;this.setShowMovePushpinMessage(!0);this.showPushiPinTip(!0);var t=this.getElement("locationWrong");t.checked=!0},f.prototype.businessLocationMarkIncorrect=function(n){var t=sj_et(n);this.businessLocationActive=t.checked?!0:!1},f.prototype.addMissingEntityLinkClicked=function(i){(i.preventDefault(),u.showAddMissingBusinessLink)&&(t.log(e.Feedback,t.MissingBusinessReported,{FT:t.FeedbackType_LocalResult,EX:"MB",AN:"RapEntryPoints#"+5..toString()}),v.invokeHandler(a.taskDataHandlerKey,{type:y.feedbackTask,activateOptions:{parentId:this.feedbackTask.id},state:{entryPoint:3,feedbackTaskType:6,title:n.L_Fdbk_AddMissingBusinessCardTitle,activeTaskId:this.feedbackTask.id,options:{reportType:1,noFoundType:2,userFacts:this.userFacts,rapEntryPoint:5}}}))},f.prototype.businessClosed=function(n){var t,i;n.preventDefault();this.isPermClosed&&(this.isMarkedDetailsIncorrect=!1,this.isClosed=!0,this.markHoursOfOperationIncorrect=!1,this.isLocationMarkIncorrect&&(t=this.getElement("locationWrong"),t.checked=!1),this.isNameMarkIncorrect&&(this.businessNameUndo(n),t=this.getElement("nameWrong"),t.checked=!1),this.isAddressMarkIncorrect&&(this.businessAddressUndo(n),t=this.getElement("addressWrong"),t.checked=!1),this.isPhoneMarkIncorrect&&(this.businessPhoneUndo(n),t=this.getElement("phoneWrong"),t.checked=!1),this.isWebsiteMarkIncorrect&&(this.businessWebsiteUndo(n),t=this.getElement("websiteWrong"),t.checked=!1),this.isHoursMarkIncorrect&&(t=this.getElement("hoursWrong"),t.checked=!1,this.markHoursOfOperationIncorrect=!1,this.isEditingHours=!1,this.undoEditHours(event)),this._changeDivDisplay("nameWrong",!1),this._changeDivDisplay("addressWrong",!1),this._changeDivDisplay("phoneWrong",!1),this._changeDivDisplay("websiteWrong",!1),this._changeDivDisplay("hoursWrong",!1),this._changeDivDisplay("markIncorrectText",!1),this._changeDivDisplay("locationWrong",!1),i="normalText",this.setStyle("businessDisplayNameId",i,!0),this.setStyle("businessDisplayAddressId",i,!0),this.setStyle("businessDisplayPhoneId",i,!0),this.setStyle("labelDisplayBusinessWebsiteId",i,!0),this.setStyle("labelMapPinId",i,!0),this.hideElement("addHoursBtn"),this.hideElement("open24x7Div"),this.renderHours())},f.prototype.detailsIncorrect=function(n){n.preventDefault();this.initDetailsIncorrect()},f.prototype.onFeedbackDoneClick=function(n){n.preventDefault();window.clearTimeout(this.feedbackTimeoutHandler);v.invokeHandler(a.taskDataHandlerKey,{action:"removeTaskAndReseatChild",id:this.feedbackTask.id})},f.prototype.initDetailsIncorrect=function(){if(this.isMarkedDetailsIncorrect){this.isClosed=!this.isMarkedDetailsIncorrect;this.isPermClosed=!this.isMarkedDetailsIncorrect;this.markHoursOfOperationIncorrect=!0;this._changeDivDisplay("nameWrong",!0);this._changeDivDisplay("addressWrong",!0);this._changeDivDisplay("phoneWrong",!0);this._changeDivDisplay("websiteWrong",!0);this._changeDivDisplay("hoursWrong",!0);this._changeDivDisplay("markIncorrectText",!0);this._changeDivDisplay("locationWrong",!0);var n="normalText";this.setStyle("businessDisplayNameId",n,!1);this.setStyle("businessDisplayAddressId",n,!1);this.setStyle("businessDisplayPhoneId",n,!1);this.setStyle("labelDisplayBusinessWebsiteId",n,!1);this.setStyle("labelMapPinId",n,!1);this.showElement("addHoursBtn");this.showElement("open24x7Div");this.renderHours()}},f.prototype.setStyle=function(n,t,i){var r=this.getElement(n);i?r.classList.add(t):r.classList.remove(t)},f.prototype.expandClosedOpts=function(n){var t,i,r,u;(n.preventDefault(),t=this.getControl().select(".commonButton")[1],t&&t.id=="expandClosedOptionsId")&&(i=this.getControl().select("#expandClosedOptionsText")[0],this.isClosed?(t.classList.remove("collapseButton"),t.classList.add("expandButton"),i.classList.add("collapsedBg"),this.isClosed=!1,this._changeDivDisplay("isClosedOptions",!1),this.isPermClosed=!1,this.dosentExist=!1,this.isPrivate=!1,this.isDuplicate=!1,this.isSpam=!1,this.isClosed=!1):(t.classList.add("collapseButton"),t.classList.remove("expandButton"),i.classList.remove("collapsedBg"),this._changeDivDisplay("isClosedOptions",!0),r=this.getControl().select(".commonButton")[2],u=this.getControl().select("#expandIncorrectOptionsId")[0],r.classList.remove("collapseButton"),r.classList.add("expandButton"),u.classList.add("collapsedBg"),this._changeDivDisplay("showNameOptionsDiv",!1),this._changeDivDisplay("showAddressOptionsDiv",!1),this._changeDivDisplay("showContactOptionsDiv",!1),this._changeDivDisplay("showWebsiteOptionsDiv",!1),this._changeDivDisplay("showMapPinOptionsDiv",!1),this._changeDivDisplay("showHoursOptionsDiv",!1),this.isMarkedDetailsIncorrect=!1,this.isClosed=!0,this.isPermClosed=!0))},f.prototype.expandIncorrectOpts=function(n){var t,i,r,u;(n.preventDefault(),t=this.getControl().select(".commonButton")[2],t&&t.id=="expandIncorrectOptionsId")&&(i=this.getControl().select("#expandIncorrectOptionsId")[0],this.isMarkedDetailsIncorrect?(t.classList.remove("collapseButton"),t.classList.add("expandButton"),i.classList.add("collapsedBg"),this.isMarkedDetailsIncorrect=!1,this._changeDivDisplay("showNameOptionsDiv",!1),this._changeDivDisplay("showAddressOptionsDiv",!1),this._changeDivDisplay("showContactOptionsDiv",!1),this._changeDivDisplay("showWebsiteOptionsDiv",!1),this._changeDivDisplay("showMapPinOptionsDiv",!1),this._changeDivDisplay("showHoursOptionsDiv",!1),this.isClosed=!0,this.isPermClosed=!1,this.dosentExist=!1,this.isPrivate=!1,this.isDuplicate=!1,this.isSpam=!1):(t.classList.add("collapseButton"),t.classList.remove("expandButton"),i.classList.remove("collapsedBg"),this._changeDivDisplay("isClosedOptions",!1),r=this.getControl().select(".commonButton")[1],u=this.getControl().select("#expandClosedOptionsText")[0],r.classList.remove("collapseButton"),r.classList.add("expandButton"),u.classList.add("collapsedBg"),this._changeDivDisplay("markIncorrectText",!0),this._changeDivDisplay("showNameOptionsDiv",!0),this._changeDivDisplay("showAddressOptionsDiv",!0),this._changeDivDisplay("showContactOptionsDiv",!0),this._changeDivDisplay("showWebsiteOptionsDiv",!0),this._changeDivDisplay("showMapPinOptionsDiv",!0),this._changeDivDisplay("showHoursOptionsDiv",!0),this.isMarkedDetailsIncorrect=!0,this.isClosed=!1,this.isPermClosed=!1,this.dosentExist=!1,this.isPrivate=!1,this.isDuplicate=!1,this.isSpam=!1))},f.prototype._changeDivDisplay=function(n,t){var i=this.getElement(n);i&&(i.style.display=t?"":"none")},f.prototype._setWidth=function(n){var t=this.getElement(n);t&&(t.style.width=this.feedbackTask.getCurrentWidth()-54+"px")},f.prototype._setIncorrectFields=function(){this._changeDivDisplay("showBasicOptionsDiv",!1);this._changeDivDisplay("showNameOptionsDiv",!1);this._changeDivDisplay("showAddressOptionsDiv",!1);this._changeDivDisplay("showContactOptionsDiv",!1);this._changeDivDisplay("showWebsiteOptionsDiv",!1);this._changeDivDisplay("showMapPinOptionsDiv",!1);this._changeDivDisplay("showHoursOptionsDiv",!1);this._changeDivDisplay("showUserCommentsOptionsDiv",!1)},f.prototype._sendFeedbackData=function(){var n=this.getSubmitData();this.feedbackTask.sendLocalFeedback(n,this.ypid,u.enableSurfV2Local)},f.prototype.getSubmitData=function(){var o={Name:this.entityName,Identifier:{Identifier:this.ypid},GeoLocation:{Latitude:this.initLocationOfPushpin.latitude,Longitude:this.initLocationOfPushpin.longitude},PrimaryPhone:this.dataFacts.Phone?this.dataFacts.Phone:this.dataFacts.phone?this.dataFacts.phone:"",PrimaryWebsite:this.dataFacts.Website?this.dataFacts.Website:this.dataFacts.website?this.dataFacts.website:"",IsClosed:!1,Segment:1,Market:this.entityMarket,Address:{AddressLine:this.dataFacts.addressFields?this.dataFacts.addressFields.addressLine:"",City:this.dataFacts.addressFields?this.dataFacts.addressFields.city:"",Subdivision:this.dataFacts.addressFields?this.dataFacts.addressFields.stateMunicipality:"",PostalCode:this.dataFacts.addressFields?this.dataFacts.addressFields.postalCode:""}},n={OriginalEntity:o},i,r,t,e;return u.enableLocalFeedbackForHOOTask&&(n.OriginalEntity.HoursOfOperation=this.inputHours!=undefined?{Open24x7:!1,Hours:this.inputHours}:undefined),n.SuggestedEntity={},this.isClosed?(n.Problem="closed",n.SuggestedEntity.IsClosed=!0,n.Comments="The user reported the business as",this.isPermClosed?n.Comments+=" Permanently Closed. ":this.dosentExist?n.Comments+=" Doesnt Exist. ":this.isPrivate?n.Comments+=" Private. ":this.isDuplicate?n.Comments+=" Duplicate Closed. ":this.isSpam&&(n.Comments+=" Spam. "),n.Comments+=this.handleEscapeChar(this.rapComments)):this.isMarkedDetailsIncorrect&&(this.businessNameActive&&(n.SuggestedEntity.Name=this.handleEscapeChar(this.businessName),n.SuggestedEntity.NameComment=this.handleEscapeChar(this.rapComments),t=this.getElement("nameWrong"),n.SuggestedEntity.IsNameMarkedIncorrect=t.checked),this.businessPhoneActive&&(n.SuggestedEntity.PrimaryPhone=this.handleEscapeChar(this.businessPhone),n.SuggestedEntity.PhoneComment=this.handleEscapeChar(this.rapComments),t=this.getElement("phoneWrong"),n.SuggestedEntity.IsPhoneMarkedIncorrect=t.checked),this.businessWebsiteActive&&(n.SuggestedEntity.PrimaryWebsite=this.handleEscapeChar(this.businessWebsite),n.SuggestedEntity.WebsiteComment=this.handleEscapeChar(this.rapComments),t=this.getElement("websiteWrong"),n.SuggestedEntity.IsWebsiteMarkedIncorrect=t.checked),this.businessAddressActive&&(n.SuggestedEntity.Address=this.dataFacts.addressFields===undefined?{AddressLine:this.handleEscapeChar("#Wrong"),City:this.handleEscapeChar("#Wrong"),PostalCode:this.handleEscapeChar("#Wrong"),Subdivision:this.handleEscapeChar("#Wrong")}:{AddressLine:this.handleEscapeChar(this.businessAddress),City:this.handleEscapeChar(this.businessCity),PostalCode:this.handleEscapeChar(this.businessPostalCode),Subdivision:this.handleEscapeChar(this.businessState)},n.SuggestedEntity.AddressComment=this.handleEscapeChar(this.rapComments),t=this.getElement("addressWrong"),n.SuggestedEntity.IsAddressMarkedIncorrect=t.checked),u.enableLocalFeedbackForHOOTask&&(this.open24x7?n.SuggestedEntity.HoursOfOperation={Open24x7:!0}:this.isEditingHours&&(i=this.getHoursForSubmission(),n.OriginalEntity.HoursOfOperation===undefined&&(r=!0,i.forEach(function(n){n.hours.length>0&&(r=!1)}),r&&(this.addRowForNewDay(undefined,!1),i=this.getHoursForSubmission())),n.SuggestedEntity.HoursOfOperation={Open24x7:!1,Hours:i}),t=this.getElement("hoursWrong"),n.SuggestedEntity.IsHoursMarkedIncorrect=t.checked),this.isPushpinMoved()?(n.SuggestedEntity.GeoLocation={Latitude:this.getPushpinLocation().latitude,Longitude:this.getPushpinLocation().longitude},this.rapComments&&(n.Comments=this.handleEscapeChar(this.rapComments)),n.SuggestedEntity.IsGeoLocationMarkedIncorrect=!0):this.businessLocationActive?(n.SuggestedEntity.GeoLocation={Latitude:this.initLocationOfPushpin.latitude,Longitude:this.initLocationOfPushpin.longitude},this.rapComments&&(n.Comments=this.handleEscapeChar(this.rapComments)),n.SuggestedEntity.IsGeoLocationMarkedIncorrect=!0):n.SuggestedEntity.IsGeoLocationMarkedIncorrect=!1,n.Comments=this.handleEscapeChar(this.rapComments)),this.userFacts&&this.userFacts.Id&&(n.Id=this.userFacts.Id),this.userFacts&&this.userFacts.EmailAddress&&(n.EmailAddress=this.userFacts.EmailAddress),e=this.getElement("userEmailCheckBox"),n.UserEmailRequested=e&&e.checked&&this.userFacts&&this.userFacts.Id?!0:!1,n.feedIds="",n.featureDataMap=[],this.isEmptyOrNull(this.dataFacts.feedbackMetaData)&&(this.isEmptyOrNull(this.dataFacts.feedbackMetaData[f.FeedIds])&&(n.feedIds=this.dataFacts.feedbackMetaData[f.FeedIds]),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[f.IsDefinitiveEntity])&&n.featureDataMap.push({key:"1",value:this.dataFacts.feedbackMetaData[f.IsDefinitiveEntity]}),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[f.IsProtectedEntity])&&n.featureDataMap.push({key:"2",value:this.dataFacts.feedbackMetaData[f.IsProtectedEntity]}),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[f.PrimaryCategory])&&(n.PrimaryCategory=this.dataFacts.feedbackMetaData[f.PrimaryCategory],n.Category=this.dataFacts.feedbackMetaData[f.PrimaryCategory]),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[f.Categories])&&(n.Categories=this.dataFacts.feedbackMetaData[f.Categories]),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[f.WebResources])&&(n.WebResources=this.dataFacts.feedbackMetaData[f.WebResources])),n.ServerSideAPIEnabled=!0,n},f.prototype.isEmptyOrNull=function(n){return n!=undefined&&n!=null},f.prototype.handleEscapeChar=function(n){return[{regex:/"/g,replace:'\\"'},{regex:/[\n]/g,replace:"\\n"}].forEach(function(t){n=n.replace(t.regex,t.replace)}),n},f.prototype.onBlurFeedbackComments=function(t){t.preventDefault();var i=this.getElement("feedbackComments");i.setAttribute("placeholder",n.L_Fdbk_UserComments_Alt)},f.prototype.onFocusFeedbackComments=function(n){n.preventDefault();var t=this.getElement("feedbackComments");t.removeAttribute("placeholder")},f.prototype.initHOO=function(t){t.openHours!=undefined&&(this.inputHours=this.convertDataFactHooToInputHours(t.openHours));this.whichDays="";this.daysList=[{fullName:n.DayMonday,shortName:n.DayMondayShort},{fullName:n.DayTuesday,shortName:n.DayTuesdayShort},{fullName:n.DayWednesday,shortName:n.DayWednesdayShort},{fullName:n.DayThursday,shortName:n.DayThursdayShort},{fullName:n.DayFriday,shortName:n.DayFridayShort},{fullName:n.DaySaturday,shortName:n.DaySaturdayShort},{fullName:n.DaySunday,shortName:n.DaySundayShort}];this.addWorkingHoursResourceString="";this.markHoursOfOperationIncorrect=!1;this.open24x7=!1;this.currentDaysGroupForUpdate=undefined;this.currentRangesForUpdate=undefined;this.isAddScenario=!1;this.isEditingHours=!1;this.setIsDropdownOpened(!1);this.dropdownItemSelectedList=[];this.dropdown=this.getElement("dropdown");this.dropdownMenu=this.getElement("dropdown-menu");this.dropdownTextId=this.getElement("dropdownTextId");this.dropDownEscapeList=[];this.dropdownItemList=undefined;this.isSuggestionsOpen=!1;this.newHourDropDownIdList=[];this.registerDropdownClickMethod();this.registerDropdownChangeMethod();this.registerDropdownCloseMethod();this.registerEvents()},f.prototype.registerEvents=function(){},f.prototype.convertDataFactHooToInputHours=function(n){for(var u,r,i,f,e,s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o=[],t=0;t<n.length;t++){for(u={dayIndex:-1,isOpen24Hr:!1,hours:[]},u.dayIndex=s.indexOf(n[t].day),r=0;r<n[t].hoursRanges.length;r++)i={openHour:0,openMin:0,closeHour:0,closeMin:0},f=n[t].hoursRanges[r].start.split(":"),i.openHour=f[0],i.openMin=f[1],e=n[t].hoursRanges[r].end.split(":"),i.closeHour=e[0],i.closeMin=e[1],u.hours.push(i);o.push(u)}return o},f.prototype.initHours=function(){this.resetHours();try{this.transformInputHoursToEditableHours()}catch(n){this.resetHours()}this.renderHours()},f.prototype.transformInputHoursToEditableHours=function(){for(var n,r,f,u,t,e,i=0;i<this.inputHours.length;i++)if(n=this.inputHours[i],r=n.dayIndex-1,r<0&&(r=6),f=this.daysModel[r],n.isOpen24Hr)f.ranges.push({openTime:{hour:0,min:0},closeTime:{hour:0,min:0}});else for(u=0;u<n.hours.length;u++)t=n.hours[u],e={openTime:{hour:t.openHour,min:t.openMin},closeTime:{hour:t.closeHour,min:t.closeMin}},f.ranges.push(e)},f.prototype.resetHours=function(){this.daysModel=[];for(var n=0;n<7;n++)this.daysModel.push({editing:!1,ranges:[]})},f.prototype.renderHours=function(){var i=this.getElement("showHours"),u,f,h,n,t,e,o,s;if(i){for(u=r(i),u.clear(),this._clear("ChangeEditHours"),this._clear("RemoveEditHours"),f=sj_ce("table","hoursTable","labelDisplayHoursOfOperation"),h=r(f),u.append(f),n=this.groupDayModel(),t=0;t<n.length;t++)e=n[t],o=this.daysModel[e[0]].ranges,this.sortRangesByOpenTime(o),this.getHtmlForDays(e,o,t<n.length-1);s=this.getElement("addHours");n.length==0?(i.className="noHours",s.className="noHours",this.hideElement("markIncorrect")):(i.className="",s.className="",this.showElement("markIncorrect"))}},f.prototype.groupDayModel=function(){for(var i,r,t=[],u="na",n=0;n<7;n++)i=this.daysModel[n],r=this.hashRanges(i.ranges),i.ranges.length>0&&(r===u?t[t.length-1].push(n):t.push([n])),u=r;return t},f.prototype._addEventsToEventList=function(n,t,i,r){this._eventHandlers.push({group:n,item:t,eventName:i,handler:r})},f.prototype._clear=function(n){if(this._eventHandlers.forEach(function(t){n==undefined?t.item.remove_event(t.eventName,t.handler):n==t.group&&t.item.remove_event(t.eventName,t.handler)}),n==undefined)this._eventHandlers=[];else for(var t=0;t<this._eventHandlers.length;t++)n==this._eventHandlers[t].group&&(this._eventHandlers=this._eventHandlers.splice(t,1))},f.prototype.getHtmlForDays=function(n,t,i){var p=this,b=this.getElement("hoursTable"),a,d,et,f,g,h,nt,u,tt,s,it,y;if(b){var rt=r(b),l=[],o=function(n){var t,i,r;n.preventDefault();t=sj_et(n);i=JSON.parse(t.getAttribute("data-days-group"));t.getAttribute("data-ranges")&&(r=JSON.parse(t.getAttribute("data-ranges").replace(/&quot;/gi,'"')),p.changeEditHours(i,r))},k=function(n){n.preventDefault();var t=sj_et(n),i=JSON.parse(t.getAttribute("data-days-group")),r=t.getAttribute("data-range");p.removeHours(i,r);p.renderHours()};for(a=0;a<t.length;a++){var ut=t[a],ft=sj_ce("a","","deleteHoursButton"),c=r(ft);c.set_attr("href","#");c.set_attr("data-days-group","["+n.toString()+"]");c.set_attr("data-range",this.hashRange(ut));c.add_event("click",k);this._addEventsToEventList("RemoveEditHours",c,"click",k);l.push(c)}for(d=this.getDayTextForDaysGroup(n),et="",f=0;f<l.length;f++){var ct=l[f],ot=f==0?d:"",st="times",w="";f==l.length-1&&i&&(st+=" timesSpacer",w+=" lastDayHours");f==0&&(w+=" firstDayHours");var v="["+n.toString()+"]",ht=sj_ce("a"),e=r(ht);e.set_attr("data-days-group",v);e.set_attr("data-ranges",JSON.stringify(t).replace(/"/gi,"&quot;"));e.set_attr("role","button");e.set_attr("href","#");this.isMarkedDetailsIncorrect||e.set_attr("class","normalText");e.add_event("click",o);this._addEventsToEventList("ChangeEditHours",e,"click",o);e.set_html(ot);g=sj_ce("td");h=r(g);h.set_attr("data-days-group",v);h.set_attr("data-ranges",JSON.stringify(t).replace(/"/gi,"&quot;"));h.add_event("click",o);this._addEventsToEventList("ChangeEditHours",h,"click",o);h.append(e);nt=sj_ce("a");u=r(nt);u.set_attr("data-days-group",v);u.set_attr("data-ranges",JSON.stringify(t).replace(/"/gi,"&quot;"));u.set_attr("role","button");u.set_attr("href","#");this.isMarkedDetailsIncorrect||u.set_attr("class","normalText");u.add_event("click",o);this._addEventsToEventList("ChangeEditHours",u,"click",o);u.set_html(this.hashRange(t[f]));tt=sj_ce("td");s=r(tt);s.set_attr("data-days-group",v);s.set_attr("data-ranges",JSON.stringify(t).replace(/"/gi,"&quot;"));s.add_event("click",o);this._addEventsToEventList("ChangeEditHours",s,"click",o);s.append(u);this.isEditingHours&&this.isMarkedDetailsIncorrect&&s.append(l[f]);it=sj_ce("tr","",w);y=r(it);y.append(h);y.append(s);rt.append(y)}}},f.prototype.getDayTextForDaysGroup=function(n){return n.length===1?this.daysList[n[0]].shortName:this.daysList[n[0]].shortName+" - "+this.daysList[n[n.length-1]].shortName},f.prototype.removeHours=function(n,t){for(var i,e,r=0;r<n.length;r++){var o=n[r],u=this.daysModel[o],f=u.ranges;for(i=f.length-1;i>=0;i--)e=this.hashRange(f[i]),e==t&&u.ranges.splice(i,1)}},f.prototype.hashRanges=function(n){var i="",t,r;for(this.sortRangesByOpenTime(n),t=0;t<n.length;t++)r=n[t],i+=this.hashRange(r);return i},f.prototype.hashRange=function(n){return this.getTimeStringFromTimeSeries(n.openTime.hour,n.openTime.min)+" - "+this.getTimeStringFromTimeSeries(n.closeTime.hour,n.closeTime.min)},f.prototype.sortRangesByOpenTime=function(n){n.sort(function(n,t){return n.openTime.hour*60+n.openTime.min-(t.openTime.hour*60+t.openTime.min)})},f.prototype.getTimeStringFromTimeSeries=function(n,t){var i,r;return n==0?(i="12",r="AM"):n<12?(i=n+"",r="AM"):n==12?(i=n+"",r="PM"):(i=n-12+"",r="PM"),this.pad(i,2)+":"+this.pad(t+"",2)+" "+r},f.prototype.pad=function(n,t){for(var i=n;i.length<t;)i="0"+i;return i},f.prototype.addHours=function(n){n.preventDefault();this.isAddScenario=!0;this.changeEditHours([0,1,2,3,4],[{openTime:{hour:9,min:0},closeTime:{hour:17,min:0}}])},f.prototype.changeEditHours=function(n,t){var i,r;this.markHoursOfOperationIncorrect&&(this.hideElement("addHoursBtn"),this.isAddScenario?(this.hideElement("updateHoursButton"),this.showElement("addHoursButton")):(this.hideElement("addHoursButton"),this.showElement("updateHoursButton")),this.showAddDaysDiv(n,t),this.isEditingHours=!0,this.renderHours(),i=this.getElement("showHoursOptionsDiv"),i.scrollIntoView(!1),r=this.getElement("hoursWrong"),r.checked=!0);this.businessHoursOfOperationActive=!0},f.prototype.undoEditHours=function(n){sj_sp(n);sj_pd(n);this.isEditingHours=!1;this.resetHoursOfOperation(n);this.businessHoursOfOperationActive=!1;this.resetOpen24x7AndMarkIncorrectCheckBox()},f.prototype.resetOpen24x7AndMarkIncorrectCheckBox=function(){var t=this.getElement("open24x7"),n;t.disabled=!1;n=this.getElement("hoursWrong");n.disabled=!1},f.prototype.resetHoursOfOperation=function(){this.hideNewWorkingDays();this.initHours();this.renderHours();this.businessHoursOfOperationActive=!1},f.prototype.markWrong=function(n){n.preventDefault();var t=sj_et(n),i=this.getElement("hoursTable"),r=this.getElement("addHoursBtn");t.checked?(this.markHoursOfOperationIncorrect=!0,this.isEditingHours=!0,this.addHours(n)):(this.markHoursOfOperationIncorrect=!0,this.isEditingHours=!1,this.undoEditHours(n))},f.prototype.markOpen24x7=function(n){n.preventDefault();var r=sj_et(n),t=this.getElement("showHours"),i=this.getElement("hoursWrong");r.checked?(this.open24x7=!0,t.style.display="none",this.resetHoursOfOperation(n),i.disabled=!0,this.businessHoursOfOperationActive=!0,this.hideNewWorkingDays(),this.hideElement("addHoursBtn")):(this.open24x7=!1,t.style.display="inline",i.disabled=!1,this.businessHoursOfOperationActive=!1,this.showElement("addHoursBtn"))},f.prototype.hideNewWorkingDaysClickMethod=function(n){n.preventDefault();this.hideNewWorkingDays()},f.prototype.hideNewWorkingDays=function(){this.hideElement("addDayDiv");this.hideElement("addHours");this.showElement("addHoursBtn");this.isAddScenario=!1;this.currentRangesForUpdate=undefined;this.currentDaysGroupForUpdate=undefined;this.isEditingHours||(this.newRanges=[]);this.dropdownItemSelectedList=[]},f.prototype.showAddDaysDiv=function(n,t){this.getElement("addDayDiv").style.display="inline-block";this.getElement("addHours").style.display="inline-block";this.resetDayCheckboxes();this.resetErrorMessages();this.getElement("listOfNewHours").innerHTML="";this.newRanges=[];var i=this.getElement("dropdownTextId");i.innerText=this.whichDays;this.showElement("newDayAddHoursButton");this.loadSelectedValues(n,t)},f.prototype.loadSelectedValues=function(n,t){this.initializeAddDays(n);this.initializeHours(t)},f.prototype.initializeHours=function(n){if(n!=undefined||n!=null)for(var t=0;t<n.length;t++)this.addHoursToNewWorkingDay(n[t]);this.currentRangesForUpdate=this.clone(n)},f.prototype.initializeAddDays=function(n){var t,i,r;for(this.dropdownItemSelectedList=[],t=0;t<n.length;t++)i=this.daysList[n[t]],r=this.getElement(i.fullName.replace(/(\r\n|\n|\r)/gm,"")+"Checkbox"),r&&(r.checked=!0,this.dropdownItemSelectedList.push(i.shortName));this.renderDropdownText();this.currentDaysGroupForUpdate=this.clone(n)},f.prototype.clone=function(n){return JSON.parse(JSON.stringify(n))},f.prototype.resetErrorMessages=function(){this.hideAllErrors();this.getElement("newHoursNoError").style.display="none"},f.prototype.showMissingDaysErrorMessage=function(){this.hideAllErrors();this.getElement("newHoursMissingDaysError").style.display="inline-block"},f.prototype.showMissingHoursErrorMessage=function(){this.hideAllErrors();this.getElement("newHoursMissingHoursError").style.display="inline-block"},f.prototype.showInvalidHoursErrorMessage=function(){this.hideAllErrors();this.getElement("newHoursInvalidHoursError").style.display="inline-block"},f.prototype.hideAllErrors=function(){this.getElement("newHoursNoError").style.display="none";this.getElement("newHoursMissingDaysError").style.display="none";this.getElement("newHoursMissingHoursError").style.display="none";this.getElement("newHoursInvalidHoursError").style.display="none"},f.prototype.resetDayCheckboxes=function(){for(var i,t,n=0;n<this.daysList.length;n++)i=this.daysList[n],t=this.getElement(i.fullName.replace(/(\r\n|\n|\r)/gm,"")+"Checkbox"),t!=null&&(t.checked=!1)},f.prototype.addHoursToNewWorkingDayClickMethod=function(n){n.preventDefault();var t=undefined;this.addHoursToNewWorkingDay(t)},f.prototype.addHoursToNewWorkingDay=function(n){n!=undefined&&n!=null&&n.openTime!=null&&n.closeTime!=null?this.newRanges.push(n):this.newRanges.push({openTime:{hour:9,min:0},closeTime:{hour:17,min:0}});this.newRanges.length>=2&&this.hideElement("newDayAddHoursButton");this.renderNewHours()},f.prototype.showElement=function(n){var t=this.getElement(n);t!=null&&(t.style.display="inline-block")},f.prototype.hideElement=function(n){var t=this.getElement(n);t!=null&&(t.style.display="none")},f.prototype.renderNewHours=function(){var i,n;for(this.newHourDropDownIdList=[],i=r(this.getElement("listOfNewHours")),i.clear(),n=0;n<this.newRanges.length;n++){var u=this.newRanges[n],f=sj_ce("div","","bm_newHours"),t=r(f);t.append(this.getHtmlForDropDown(u,n,"openTime"));t.appendHTML("&nbsp;-&nbsp;");t.append(this.getHtmlForDropDown(u,n,"closeTime"));this.newHourDropDownIdList.push(n+"openTime");this.newHourDropDownIdList.push(n+"closeTime");i.append(t)}},f.prototype.getHtmlForDropDown=function(n,t,i){var l=this,it,a,rt,u,f,b,e,ut,s,ft,o,et,v,ot,h,st,c;this._clear(t+i);var y=function(n){sj_pd(n);sj_sp(n);var t=sj_et(n),i=t.getAttribute("data-range-index"),r=t.getAttribute("data-range-point");t.id.indexOf("ForAMPM")>=0?l.suggestionDropDownClick(i,r,!0):l.suggestionDropDownClick(i,r,!1)},p=function(n){sj_pd(n);var t=sj_et(n),i=t.getAttribute("data-range-index"),r=t.getAttribute("data-range-point");l.newHourTimeKeyPress(i,r)},k=function(n){sj_pd(n);var t=sj_et(n),i=t.getAttribute("data-range-index"),r=t.getAttribute("data-range-point");l.newHourTimeSelected(i,r)},w=function(n){sj_pd(n);sj_sp(n);var t=sj_et(n),i=t.getAttribute("data-range-index"),r=t.getAttribute("data-range-point");l.newAMPMSelectedFromSelectControl(i,r,t.getAttribute("value"))},d="padding-left:4px",ht=i==="openTime"?n.openTime===null?this.getTimeStringFromTimeSeries(9,0):this.getTimeStringFromTimeSeries(n.openTime.hour,n.openTime.min):n.closeTime===null?this.getTimeStringFromTimeSeries(17,0):this.getTimeStringFromTimeSeries(n.closeTime.hour,n.closeTime.min),at=i==="openTime"?n.openTime===null?"9~0":n.openTime.hour+"~"+n.openTime.min:n.closeTime===null?"17~0":n.closeTime.hour+"~"+n.closeTime.min,g=ht.split(" "),ct=g[0],lt=g[1],nt=i==="openTime"?n.openTime===null?"9~0":(n.openTime.hour<12?n.openTime.hour:n.openTime.hour-12)+"~"+n.openTime.min:n.closeTime===null?"5~0":(n.closeTime.hour<11?n.closeTime.hour:n.closeTime.hour-12)+"~"+n.closeTime.min,tt="";return tt+='<div class="newHourDropDown">',it=sj_ce("div",t+"DropDown","newHourDropDown"),a=r(it),a.set_attr("data-range-index",t),rt=sj_ce("div",t+i+"DropDown","dropdown"),u=r(rt),u.set_attr("data-range-index",t),u.set_attr("data-range-point",i),u.add_event("click",y),this._addEventsToEventList(t+i,u,"click",y),b=sj_ce("input",t+i+"DropDownText","dropdown-text"),f=r(b),f.set_attr("style","padding-right:10px;width:40px;border-width:0;"),f.set_attr("type","text"),u.set_attr("style","width:45px;margin-right:0;"),f.set_attr("maxlength","5"),f.set_attr("value",ct),f.set_attr("data-range-index",t),f.set_attr("data-range-point",i),f.add_event("keyup",p),this._addEventsToEventList(t+i,f,"keyup",p),u.append(f),tt+='<input onchange="newHourTimeSelected('+t+", '"+i+'\'));" value="'+nt+'"/>',b=sj_ce("input",t+i+"DropDownTextValue","dropdown-text-value"),e=r(b),e.set_attr("style","padding-right:10px;width:40px;border-width:0;"),e.set_attr("type","text"),e.set_attr("maxlength","3"),e.set_attr("value",nt),e.set_attr("data-range-index",t),e.set_attr("data-range-point",i),e.add_event("change",k),this._addEventsToEventList(t+i,e,"change",k),u.append(e),u.append(this.editorForRange(t,i,"")),ut=sj_ce("div",t+i+"DropDownForAMPM","dropdown"),s=r(ut),s.set_attr("style","width:35px;margin-right:0;"),s.set_attr("data-range-index",t),s.set_attr("data-range-point",i),s.add_event("click",y),this._addEventsToEventList(t+i,s,"click",y),ft=sj_ce("input",t+i+"DropDownTextForAMPM","dropdown-text"),o=r(ft),o.set_attr("style","padding-right:10px;width:20px;border-width:0;padding-left:5px;"),o.set_attr("type","text"),o.set_attr("maxlength","2"),o.set_attr("value",lt),o.set_attr("data-range-index",t),o.set_attr("data-range-point",i),o.add_event("keyup",p),this._addEventsToEventList(t+i,o,"keyup",p),s.append(o),et=sj_ce("ul",t+i+"DropDownMenuForAMPM","dropdown-menu"),v=r(et),v.set_attr("style","width:30px"),s.append(v),ot=sj_ce("li",t+i+"ForAM","dropdown-item"),h=r(ot),h.set_attr("style",d),h.set_attr("value","AM"),h.set_html("AM"),h.set_attr("data-range-index",t),h.set_attr("data-range-point",i),h.add_event("click",w),this._addEventsToEventList(t+i,h,"click",w),v.append(h),st=sj_ce("li",t+i+"ForPM","dropdown-item"),c=r(st),c.set_attr("style",d),c.set_attr("value","PM"),c.set_html("PM"),c.set_attr("data-range-index",t),c.set_attr("data-range-point",i),c.add_event("click",w),this._addEventsToEventList(t+i,c,"click",w),v.append(c),a.append(u),a.append(s),a},f.prototype.editorForRange=function(n,t,i){var f=sj_ce("ul",n+t+"DropDownMenu","dropdown-menu"),u=r(f);return u.set_attr("style","width:60px"),this.setDropDownList(u,n,t,i),u},f.prototype.setDropDownList=function(n,t,i,u){var a=this,c="padding-left:7px",e,o,l;this._clear(t+i+"ListItem");var h=function(n){var t=sj_et(n),i=t.getAttribute("data-range-index"),r=t.getAttribute("data-range-point"),u=t.getAttribute("data-range-hour"),f=t.getAttribute("data-range-min");a.newHourTimeSelectedFromSelectControl(n,i,r,u,f)},s=sj_ce("li","","dropdown-item"),f=r(s);for(f.set_attr("style",c),f.set_attr("value","-1~-1"),n.append(f),e=0;e<12;e++)for(o=0;o<60;o+=15)l=this.getTimeStringWithoutAMPM(e,o),l.substr(0,u.length)===u&&(s=sj_ce("li",e+"~"+o+t+i,"dropdown-item"),f=r(s),f.set_attr("style",c),f.set_attr("value",e+"~"+o),f.set_attr("data-range-index",t),f.set_attr("data-range-point",i),f.set_attr("data-range-hour",e.toString()),f.set_attr("data-range-min",o.toString()),f.set_html(this.getTimeStringWithoutAMPM(e,o)),f.add_event("click",h),this._addEventsToEventList(t+i+"ListItem",f,"click",h),n.append(f));s=sj_ce("li","0~0"+t+i,"dropdown-item");f=r(s);f.set_attr("style",c);f.set_attr("value","0~0");f.set_attr("data-range-index",t);f.set_attr("data-range-point",i);f.set_attr("data-range-hour","0");f.set_attr("data-range-min","0");f.set_html(this.getTimeStringWithoutAMPM(0,0));f.add_event("click",h);this._addEventsToEventList(t+i+"ListItem",f,"click",h);n.append(f)},f.prototype.getTimeStringWithoutAMPM=function(n,t){var i;return i=n==0?"12":n<12?n+"":n==12?n+"":n-12+"",this.pad(i,2)+":"+this.pad(t+"",2)},f.prototype.newHourTimeSelectedMethod=function(n){var t=sj_et(n),i=t.getAttribute("data-range-index"),r=t.getAttribute("data-range-point");this.newHourTimeSelected(i,r);sj_pd(n)},f.prototype.newHourTimeSelected=function(n,t){var r=n+t+"DropDownTextValue",u=this.getElement(r),f=u.value,e=this.getElement(n+t+"DropDownTextForAMPM"),o=e.value,i=f.split("~"),s=o=="PM"?parseInt(i[0])+12:parseInt(i[0]),h=parseInt(i[1]),c=this.newRanges[n];c[t]={hour:s,min:h};this.renderNewHours()},f.prototype.addRowForNewDay=function(n,t){var u,r,h,o,i,f,e,s;for(t===void 0&&(t=!0),t&&sj_pd(n),u=[],i=0;i<this.newRanges.length;i++)if(r=this.newRanges[i],r.openTime!=null&&r.closeTime!=null){if(r.closeTime.hour!=0&&r.closeTime.min!=0&&r.closeTime.hour*60+r.closeTime.min<r.openTime.hour*60+r.openTime.min){this.showInvalidHoursErrorMessage();return}u.push(r)}if(u.length==0){this.showMissingHoursErrorMessage();return}for(h=!1,i=0;i<this.daysList.length;i++)f=this.daysList[i],e=this.getElement(f.fullName+"Checkbox"),e.checked&&(h=!0);if(h){if(!this.isAddScenario)for(o=0;o<this.currentRangesForUpdate.length;o++)this.removeHours(this.currentDaysGroupForUpdate,this.hashRange(this.currentRangesForUpdate[o]));for(i=0;i<this.daysList.length;i++)if(f=this.daysList[i],e=this.getElement(f.fullName+"Checkbox"),e.checked)for(s=0;s<u.length;s++)this.daysModel[i].ranges.push(u[s]);this.hideNewWorkingDays();this.renderHours()}else this.showMissingDaysErrorMessage()},f.prototype.getHoursForSubmission=function(){for(var u,t,r,i,f=[],n=0;n<this.daysModel.length;n++){for(u=this.daysModel[n],t={dayIndex:-1,hours:[]},t.dayIndex=n===6?0:n+1,t.hours=[],r=0;r<u.ranges.length;r++)i=u.ranges[r],t.hours.push({openHour:i.openTime.hour,openMin:i.openTime.min,closeHour:i.closeTime.hour,closeMin:i.closeTime.min});f.push(t)}return f},f.prototype.disableHoursSuggestion=function(){this.hideNewWorkingDays();this.isEditingHours=!1;this.initHours()},f.prototype.registerDropdownClickMethod=function(){this.dropdownMenu=this.getElement("dropdown-menu");this.dropdownTextId=this.getElement("dropdownTextId")},f.prototype.DropdownClickMethod=function(n){if(this.dropdownMenu=this.getElement("dropdown-menu"),this.dropdownMenu.classList.contains("visible"))this.dropdownMenu.classList.remove("visible"),this.dropdownMenu.style.display="none",this.setIsDropdownOpened(!1);else{var t=n;if(t&&t.type==="keydown"&&t.keyCode!==13)return;this.closeAllOpenDropDownMenu();this.dropdownMenu.classList.add("visible");this.dropdownMenu.style.display="block";this.setIsDropdownOpened(!0)}sj_sp(n)},f.prototype.isClickedOutsideDropdown=function(n){for(var i=!0,t=sj_et(n),r=0;r<2;)t!=null&&t!=undefined&&(t.className.indexOf("dropdown-item")!=-1&&(i=!1),t=t.previousSibling),r++;return i},f.prototype.registerDropdownChangeMethod=function(){this.dropdownItemList=document.querySelectorAll(".dropdown-item");for(var n=0;n<this.dropdownItemList.length;n++);},f.prototype.DropdownChangeMethod=function(n){var t=sj_et(n);t.checked?this.dropdownItemSelectedList.push(t.value):this.dropdownItemSelectedList.splice(this.dropdownItemSelectedList.indexOf(t.value),1);this.renderDropdownText()},f.prototype.renderDropdownText=function(){for(var i=this.getElement("dropdownTextId"),t="",n=0;n<this.dropdownItemSelectedList.length;n++)t+=this.dropdownItemSelectedList[n],n<this.dropdownItemSelectedList.length-1&&(t+=" , ");i.innerHTML="<label>"+t+"<\/label>"},f.prototype.newHourTimeKeyPress=function(n,t){var s=this.getElement(n+t+"DropDownText"),f=s.value,e=r(this.getElement(n+t+"DropDownMenu")),i,u,o;for(e.clear(),this.setDropDownList(e,n,t,f),i=0;i<12;i++)for(u=0;u<60;u+=15)this.getTimeStringFromTimeSeries(i,u)===f&&(this.newHourTimeSelectedFromSelectControl(event,n,t,i,u),o=this.getElement(n+t+"DropDownMenu"),o.classList.remove("visible"),this.setIsDropdownOpened(!1))},f.prototype.newHourTimeSelectedFromSelectControl=function(n,t,i,u,f){var o,s,h,e;sj_sp(n);sj_pd(n);o=this.getElement(u+"~"+f+t+i);s=this.getElement(t+i+"DropDownText");s.value=o.innerHTML;h=this.getElement(t+i+"DropDownTextValue");h.value=u+"~"+f;e=r(this.getElement(t+i+"DropDownMenu"));e.clear();this.setDropDownList(e,t,i,"");this.newHourTimeSelected(t,i)},f.prototype.newAMPMSelectedFromSelectControl=function(n,t,i){var r=this.getElement(n+t+"DropDownTextForAMPM");r.value=i;this.newHourTimeSelected(n,t)},f.prototype.suggestionDropDownClick=function(n,t,i){var r;r=i?this.getElement(n+t+"DropDownMenuForAMPM"):this.getElement(n+t+"DropDownMenu");r.classList.contains("visible")?(r.classList.remove("visible"),r.style.display="none",this.isSuggestionsOpen=!1):(this.closeAllOpenDropDownMenu(),r.classList.add("visible"),r.style.display="block",this.isSuggestionsOpen=!0);sj_sp(event)},f.prototype.closeAllOpenDropDownMenu=function(){var t,n;for(this.dropdownMenu=this.getElement("dropdown-menu"),this.dropdownMenu.classList.remove("visible"),this.dropdownMenu.style.display="none",this.setIsDropdownOpened(!1),t=0;t<this.newHourDropDownIdList.length;t++)n=this.getElement(this.newHourDropDownIdList[t]+"DropDownMenu"),n.classList.remove("visible"),n.style.display="none",n=this.getElement(this.newHourDropDownIdList[t]+"DropDownMenuForAMPM"),n.classList.remove("visible"),n.style.display="none";this.isSuggestionsOpen=!1},f.prototype.registerDropdownCloseMethod=function(){var n=this,t=function(t){(n.isSuggestionsOpen||n.getIsDropdownOpened())&&n.isClickedOutsideDropdown(t)&&n.closeAllOpenDropDownMenu()};sj_be(_d,"click",t)},f.prototype.getElement=function(n){var t,i;return this.feedbackTask.panelRoot&&this.feedbackTask.panelRoot.length==1&&(i=this.feedbackTask.panelRoot[0],t=i.querySelector('[id="'+n.replace(/(\r\n|\n|\r)/gm,"")+'"]')),t},f.prototype._setFocusInThankYouPanel=function(){i.prototype._focusInThankYouPanel.call(this)},f.clientType="MapsV8",f.feedbackType="Page2.1",f.clientVersion="1.0",f.source="Local",f.issue="Business Suggestion",f.FeedIds="AllFeedIds",f.IsDefinitiveEntity="IsDefinitiveEntity",f.IsProtectedEntity="protectedEntity",f.Categories="Categories",f.PrimaryCategory="PrimaryCategory",f.WebResources="WebResources",f}(p),tr=function(){function n(n,t,i){this.Id=n;this.Name=t;this.Value=i}return n}(),ir=function(){function n(n,t){this.Id=n;this.Name=t;this.Value=[]}return n.prototype.SetRichAttribute=function(n){this.Value.forEach(function(t,i,r){t.Name==n&&(r[i].Value=r[i].Value===1?0:1)})},n}(),rr=function(i){function r(n,t,r){var u=this,f={};return u=i.call(this,f,n,ai,t)||this,u.feedbackType=7,u.eventHandlerAdded=!1,u.reportType=r&&r.reportType?r.reportType:0,u.query=r&&r.query?r.query:"",r&&r.localSearchEntity&&(u.localSearchEntity=ot.cloneFrom(r.localSearchEntity)),r&&r.entityYpid&&(u.ypid=r.entityYpid.split(":")[1]),r&&r.pushPinLocation&&(u.initLocationOfPushpin=r.pushPinLocation),r&&r.dataFacts&&(u.dataFacts=r.dataFacts),r&&r.userFacts&&(u.userFacts=r.userFacts),u.featureList=u.getRichAttributeFeatureList(),u.entityMarket=r.dataFacts.languageCultureName,u.entityName=r.entityName,u.isLabelAdded=!1,f.defineProperty("showReturnArrowDiv"),f.defineProperty("showThankYouPanel"),f.defineProperty("showRichAttributePanel"),u.setShowReturnArrowDiv(!0),u.setShowRichAttributePanel(!0),u.setShowThankYouPanel(!1),u._eventHandlers=[],u}return l(r,i),r.prototype.onTaskStateChanged=function(n){this.isLabelAdded||!(n.colorIndex||n.animationState)||this.isIntialized||(u.enableLocalFeedbackForHOOTask&&this.initHours(),this.init(),this.isIntialized=!0);i.prototype.onTaskStateChanged.call(this,n)},r.prototype.getRichAttributeFeatureList=function(){var t,u,n,f,r,e,i,o;if(this.dataFacts&&this.dataFacts.feedbackMetaData&&this.dataFacts.feedbackMetaData.RichAttribute&&this.dataFacts.feedbackMetaData.RichAttribute.FeatureList){for(t=this.dataFacts.feedbackMetaData.RichAttribute.FeatureList,u=[],n=0;n<t.length;n++)if(t[n]){if(f=new ir(t[n].Id,t[n].Name),t[n].PropertyList){for(r=t[n].PropertyList,e=[],i=0;i<r.length;i++)o=new tr(r[i].Id,r[i].Name,0),e.push(o);f.Value=e}u.push(f)}return u}},r.prototype.changeDisplay=function(n,t){t===void 0&&(t=!1);var i=_ge(n);i&&(t?i.classList.remove("hideEntry"):i.classList.add("hideEntry"))},r.prototype.SetRichAttribute=function(n,t){this.featureList.forEach(function(i,r,u){i.Name==n&&u[r].SetRichAttribute(t)})},r.prototype.init=function(){var n=this;n.featureList&&n.featureList.forEach(function(t){t.Value.forEach(function(i){sj_be(_ge(i.Name),"click",function(){n.SetRichAttribute(t.Name,i.Name)})})})},r.prototype.SubmitAndShowThankYou=function(n){n.preventDefault();this._sendFeedbackData();this.setShowRichAttributePanel(!1);this.setShowThankYouPanel(!0);t.log(e.Feedback,c.Submitted,{FT:t.FeedbackType_LocalCrowdSourcing,SR:"SM"})},r.prototype.onPushPinUpdate=function(){},r.prototype.noOp=function(n){n.preventDefault();return},r.prototype.onReturnToSearchResultClick=function(n){n.preventDefault();v.invokeHandler(a.taskDataHandlerKey,{action:"remove",id:this.feedbackTask.id})},r.prototype._sendFeedbackData=function(){var n=this.getSubmitData();this.feedbackTask.sendLocalFeedback(n,this.ypid,u.enableSurfV2Local,3)},r.prototype.getSubmitData=function(){var t={Name:this.entityName,Identifier:{Identifier:this.ypid},GeoLocation:{Latitude:this.initLocationOfPushpin.latitude,Longitude:this.initLocationOfPushpin.longitude},PrimaryPhone:this.dataFacts.Phone?this.dataFacts.Phone:this.dataFacts.phone?this.dataFacts.phone:"",PrimaryWebsite:this.dataFacts.Website?this.dataFacts.Website:this.dataFacts.website?this.dataFacts.website:"",IsClosed:!1,Segment:1,Market:this.entityMarket,Address:{AddressLine:this.dataFacts.addressFields?this.dataFacts.addressFields.addressLine:"",City:this.dataFacts.addressFields?this.dataFacts.addressFields.city:"",Subdivision:this.dataFacts.addressFields?this.dataFacts.addressFields.stateMunicipality:"",PostalCode:this.dataFacts.addressFields?this.dataFacts.addressFields.postalCode:""}},n={OriginalEntity:t};return this.inputHours!=undefined&&(n.OriginalEntity.HoursOfOperation={Open24x7:!1,Hours:this.inputHours}),n.SuggestedEntity={},n.SuggestedRichAttributes=this.featureList,n.RapEntryPoint=r.RapEntryPoint,n.RapPartner=r.RapPartner,this.userFacts&&this.userFacts.Id&&(n.Id=this.userFacts.Id),this.userFacts&&this.userFacts.EmailAddress&&(n.EmailAddress=this.userFacts.EmailAddress),n.feedIds="",n.featureDataMap=[],this.isEmptyOrNull(this.dataFacts.feedbackMetaData)&&(this.isEmptyOrNull(this.dataFacts.feedbackMetaData[r.FeedIds])&&(n.feedIds=this.dataFacts.feedbackMetaData[r.FeedIds]),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[r.IsDefinitiveEntity])&&n.featureDataMap.push({key:"1",value:this.dataFacts.feedbackMetaData[r.IsDefinitiveEntity]}),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[r.IsProtectedEntity])&&n.featureDataMap.push({key:"2",value:this.dataFacts.feedbackMetaData[r.IsProtectedEntity]}),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[r.PrimaryCategory])&&(n.Category=this.dataFacts.feedbackMetaData[r.PrimaryCategory]),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[r.Categories])&&(n.Categories=this.dataFacts.feedbackMetaData[r.Categories]),this.isEmptyOrNull(this.dataFacts.feedbackMetaData[r.WebResources])&&(n.WebResources=this.dataFacts.feedbackMetaData[r.WebResources])),n.ServerSideAPIEnabled=!0,n},r.prototype.isEmptyOrNull=function(n){return n!=undefined&&n!=null},r.prototype.initHOO=function(t){t.openHours!=undefined&&(this.inputHours=this.convertDataFactHooToInputHours(t.openHours));this.whichDays="";this.daysList=[{fullName:n.DayMonday,shortName:n.DayMondayShort},{fullName:n.DayTuesday,shortName:n.DayTuesdayShort},{fullName:n.DayWednesday,shortName:n.DayWednesdayShort},{fullName:n.DayThursday,shortName:n.DayThursdayShort},{fullName:n.DayFriday,shortName:n.DayFridayShort},{fullName:n.DaySaturday,shortName:n.DaySaturdayShort},{fullName:n.DaySunday,shortName:n.DaySundayShort}]},r.prototype.convertDataFactHooToInputHours=function(n){for(var u,r,i,f,e,s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o=[],t=0;t<n.length;t++){for(u={dayIndex:-1,isOpen24Hr:!1,hours:[]},u.dayIndex=s.indexOf(n[t].day),r=0;r<n[t].hoursRanges.length;r++)i={openHour:0,openMin:0,closeHour:0,closeMin:0},f=n[t].hoursRanges[r].start.split(":"),i.openHour=f[0],i.openMin=f[1],e=n[t].hoursRanges[r].end.split(":"),i.closeHour=e[0],i.closeMin=e[1],u.hours.push(i);o.push(u)}return o},r.prototype.initHours=function(){this.resetHours();try{this.transformInputHoursToEditableHours()}catch(n){this.resetHours()}},r.prototype.transformInputHoursToEditableHours=function(){for(var n,r,f,u,t,e,i=0;i<this.inputHours.length;i++)if(n=this.inputHours[i],r=n.dayIndex-1,r<0&&(r=6),f=this.daysModel[r],n.isOpen24Hr)f.ranges.push({openTime:{hour:0,min:0},closeTime:{hour:0,min:0}});else for(u=0;u<n.hours.length;u++)t=n.hours[u],e={openTime:{hour:t.openHour,min:t.openMin},closeTime:{hour:t.closeHour,min:t.closeMin}},f.ranges.push(e)},r.prototype.resetHours=function(){this.daysModel=[];for(var n=0;n<7;n++)this.daysModel.push({editing:!1,ranges:[]})},r.prototype.groupDayModel=function(){for(var i,r,t=[],u="na",n=0;n<7;n++)i=this.daysModel[n],r=this.hashRanges(i.ranges),i.ranges.length>0&&(r===u?t[t.length-1].push(n):t.push([n])),u=r;return t},r.prototype._addEventsToEventList=function(n,t,i,r){this._eventHandlers.push({group:n,item:t,eventName:i,handler:r})},r.prototype._clear=function(n){if(this._eventHandlers.forEach(function(t){n==undefined?t.item.remove_event(t.eventName,t.handler):n==t.group&&t.item.remove_event(t.eventName,t.handler)}),n==undefined)this._eventHandlers=[];else for(var t=0;t<this._eventHandlers.length;t++)n==this._eventHandlers[t].group&&(this._eventHandlers=this._eventHandlers.splice(t,1))},r.prototype.getDayTextForDaysGroup=function(n){return n.length===1?this.daysList[n[0]].shortName:this.daysList[n[0]].shortName+" - "+this.daysList[n[n.length-1]].shortName},r.prototype.removeHours=function(n,t){for(var i,e,r=0;r<n.length;r++){var o=n[r],u=this.daysModel[o],f=u.ranges;for(i=f.length-1;i>=0;i--)e=this.hashRange(f[i]),e==t&&u.ranges.splice(i,1)}},r.prototype.hashRanges=function(n){var i="",t,r;for(this.sortRangesByOpenTime(n),t=0;t<n.length;t++)r=n[t],i+=this.hashRange(r);return i},r.prototype.hashRange=function(n){return this.getTimeStringFromTimeSeries(n.openTime.hour,n.openTime.min)+" - "+this.getTimeStringFromTimeSeries(n.closeTime.hour,n.closeTime.min)},r.prototype.sortRangesByOpenTime=function(n){n.sort(function(n,t){return n.openTime.hour*60+n.openTime.min-(t.openTime.hour*60+t.openTime.min)})},r.prototype.getTimeStringFromTimeSeries=function(n,t){var i,r;return n==0?(i="12",r="AM"):n<12?(i=n+"",r="AM"):n==12?(i=n+"",r="PM"):(i=n-12+"",r="PM"),this.pad(i,2)+":"+this.pad(t+"",2)+" "+r},r.prototype.pad=function(n,t){for(var i=n;i.length<t;)i="0"+i;return i},r.prototype.getHoursForSubmission=function(){for(var u,t,r,i,f=[],n=0;n<this.daysModel.length;n++){for(u=this.daysModel[n],t={dayIndex:-1,hours:[]},t.dayIndex=n===6?0:n+1,t.hours=[],r=0;r<u.ranges.length;r++)i=u.ranges[r],t.hours.push({openHour:i.openTime.hour,openMin:i.openTime.min,closeHour:i.closeTime.hour,closeMin:i.closeTime.min});f.push(t)}return f},r.prototype._focusInThankYouPanel=function(){i.prototype._focusInThankYouPanel.call(this)},r.clientType="MapsV8",r.feedbackType="RichAttribute",r.clientVersion="1.0",r.source="Local",r.issue="Business Suggestion",r.FeedIds="AllFeedIds",r.IsDefinitiveEntity="IsDefinitiveEntity",r.IsProtectedEntity="protectedEntity",r.Categories="Categories",r.PrimaryCategory="PrimaryCategory",r.WebResources="WebResources",r.RapEntryPoint="RichAttributeSubmit",r.RapPartner="MapsV8",r}(p),ur=function(n){function i(t,i,r,u,f,e,o){var s=n.call(this,f)||this;return s.map=i,s._mapsFeedback=r,s.type=y.feedbackTask,s.displayState={colorIndex:5,groupName:"Feedback"},s._geoLocationProvider=u,s.geoCoder=e,s.reverseGeocoder=o,s._controlTemplateFactory=t,s._initFeedbackFocus=new et,s._searchImpressionGuids=[],s._traceIds=[],r&&(r.takeScreenShot(),r.generateReproUrl()),s}return l(i,n),i.prototype.activate=function(i,r){var f=this,u=1;r&&(this._taskState=r,u=r.feedbackTaskType);this.setTitle(r.title);u===6?this._currentViewModel=new di(this._controlTemplateFactory,this,r.options):u===3?this._currentViewModel=new ki(this._controlTemplateFactory,this,r.options):u==4?this._currentViewModel=new nr(this._controlTemplateFactory,this,r.options):u==7?this._currentViewModel=new rr(this._controlTemplateFactory,this,r.options):u==5?this._currentViewModel=new gi(this._controlTemplateFactory,this,r.options):(this._currentViewModel=new bi(this._controlTemplateFactory,this,u),this._initFeedbackFocus.add(function(){f._currentViewModel.setFocusToDefaultElement()}));u!==1&&this._currentViewModel.showPushpin();n.prototype.activate.call(this,i,r);this.addControl(this._currentViewModel.getControl());this._initFeedbackFocus.invoke();t.log(e.Feedback,c.Activated,{EP:t.getEntryPointLogValue(r.entryPoint),FT:t.getFeedbackTypeLogValue(u)});this.setPercentLoaded(1)},i.prototype.deactivate=function(){n.prototype.deactivate.call(this);this._currentViewModel.removePushPin();this._currentViewModel.dispose();t.log(e.Feedback,c.Deactivated,{FT:t.getFeedbackTypeLogValue(this._currentViewModel.feedbackType),FI:this._currentViewModel.isSubmitted?"SM":this._currentViewModel.hasInput(this._currentViewModel.feedbackType)?t.LogValue_True:t.LogValue_False,RE:this._taskState&&this._taskState.options&&this._taskState.options.rapEntryPoint?this._taskState.options.rapEntryPoint:""})},i.prototype.processCallback=function(n){var r,i,t,e,u,f;if(n.outData)for(r=n.outData,i=0;i<r.length;i++)t=r[i].data,t&&(e=r[i].processorId===this._taskState.activeTaskId,t.ImpressionGuid&&(u=t.ImpressionGuid,e&&(u=t.ImpressionGuid+"|Active"),this._searchImpressionGuids.indexOf(u)===-1&&this._searchImpressionGuids.push(u)),t.TraceId&&(f=t.TraceId,e&&(f=t.TraceId+"|Active"),this._traceIds.indexOf(f)===-1&&this._traceIds.push(f)))},i.prototype.serialize=function(){return this._taskState},i.prototype.setDisplayState=function(t){var i,r;n.prototype.setDisplayState.call(this,t);this._currentViewModel.onTaskStateChanged(t);t.activationState===1&&t.prominence===1&&(i={trackingDataRequested:!0},this._callProcess(i,y.localListingTask),this._callProcess(i,y.localDetailsTask),r={action:1},this._callProcess(r,y.directionsTask))},i.prototype._callProcess=function(n,t){var i={requestorType:y.feedbackTask,requestorId:this.id,type:t,requestState:n,useActiveTasks:!0};v.invokeHandler(a.taskProcessDataHandlerKey,i)},i.prototype.getMenuList=function(){return[]},i.prototype.getCardIconInfo=function(){return{iconClass:"fdbTsk"}},i.prototype.isSharable=function(){return!1},i.prototype.hasDefaultFocusElement=function(){return!0},i.prototype.sendLocalFeedback=function(n,t,i,r){i===void 0&&(i=!1);r===void 0&&(r=1);this._mapsFeedback&&this._mapsFeedback.sendLocalFeedback(n,t,i,r)},i.prototype.sendLocalReportProblemFeedback=function(n,t,i){this._mapsFeedback&&this._mapsFeedback.sendLocalReportProblemFeedback(n,t,i)},i.prototype.sendSurfFeedback=function(n,t,i){n.SearchImpressionGuid=this._searchImpressionGuids.join(" & ");n.TraceID=this._traceIds.join(" & ");this._mapsFeedback&&this._mapsFeedback.sendSurfFeedback(n,t,i,{})},i}(bt),t=function(){function n(){}return n.log=function(n,t,i,r){v.invokeHandler(a.instrumentationDataHandlerKey,{logData:{feature:n,action:t,data:i},flush:r})},n.getFeedbackTypeLogValue=function(t){var i=n.FeedbackType_General;return t===2?i=n.FeedbackType_BaseMap:t===3?i=n.FeedbackType_SearchResult:t===4?i=n.FeedbackType_LocalResult:t===7?i=n.FeedbackType_LocalCrowdSourcing:t===6&&(i=n.FeedbackType_MissingEntity),i},n.getEntryPointLogValue=function(t){var i=n.EntryPointType_PreviewWidget;return t===1?n.EntryPointType_Footer:t===3?i=n.EntryPointType_TaskLink:t===2?i=n.EntryPointType_TaskMenu:t===6&&(i=n.EntryPointType_TaskBarMenu),i},n.OpenPopoutMenu="O",n.OpenExternalLink="E",n.MissingBusinessReported="MBR",n.InlineValidationFailure="V",n.EntryPointType_PreviewWidget="PW",n.EntryPointType_Footer="F",n.EntryPointType_TaskMenu="TM",n.EntryPointType_TaskLink="TL",n.EntryPointType_TaskBarMenu="TB",n.FeedbackType_General="G",n.FeedbackType_BaseMap="B",n.FeedbackType_SearchResult="S",n.FeedbackType_Directions="D",n.FeedbackType_LocalResult="L",n.FeedbackType_LocalCrowdSourcing="LCS",n.FeedbackType_MissingEntity="ME",n.LogValue_True="T",n.LogValue_False="F",n.FeedbackType_AutoSuggest="AS",n}(),dr=function(n){function t(t,i,r,u,f){return n.call(this,t,i,r,u,null,f)||this}return l(t,n),t.log=function(n,t,i,r){v.invokeHandler(a.instrumentationDataHandlerKey,{logData:{feature:n,action:t,data:i},flush:r})},t}(ui),fr=function(){function n(n,t){this._primitive=n;this._dataSource=t}return n.prototype.updatePushpinLocation=function(n){n!=null&&(this._primitive.geometry.x=n.longitude,this._primitive.geometry.y=n.latitude,this._primitive.geometry.bounds=[n.latitude,n.longitude,n.latitude,n.longitude],this._dataSource.invalidated.invoke())},n.prototype.getLocation=function(){return new w(this._primitive.geometry.y,this._primitive.geometry.x)},n}(),gr=function(t){function i(i){var r=this,u={};return r=t.call(this,u)||this,r.resources=n,r._mapsFeedback=i,r._pushpinState=null,u.defineProperty("problemType",r._onProblemTypeChanged),u.defineProperty("subProblemType",r._onSubProblemTypeChanged),r._prePopulateProblemDropdowns(),r}return l(i,t),i.prototype.loadFeedbackMiniMap=function(n,t){var o=this,i,e;this._mapView=t;i=r(".fdbkMapContent");e={mapType:n,credentials:u.credentials,navigationOptions:{lockCameraAltitude:!1,lockCameraHeading:!0},enableInertia:!1};f.loadMap({element:i,mapOptions:e},function(n){return o._finishMiniMapSetup(n)})},i.prototype._prePopulateProblemDropdowns=function(){this.problemTypes=[{text:n.L_Fdbk_SelectProblem,value:0},{text:n.L_Fdbk_ProblemRoad,value:1},{text:n.L_Fdbk_ProblemAddress,value:2},{text:n.L_Fdbk_ProblemCity,value:3},{text:n.L_Fdbk_ProblemNeighborhood,value:4},{text:n.L_Fdbk_ProblemAdministrativeDistricts,value:5},{text:n.L_Fdbk_ProblemLand,value:6},{text:n.L_Fdbk_ProblemWater,value:7},{text:n.L_Fdbk_ProblemBridge,value:8},{text:n.L_Fdbk_ProblemAirport,value:9},{text:n.L_Fdbk_Other,value:12}];this.subProblemTypes=new nt([]);this.setProblemType({text:n.L_Fdbk_SelectProblem,value:0});this.setSubProblemType({text:n.L_Fdbk_SelectSubProblem,value:0})},i.prototype._finishMiniMapSetup=function(n){var t=this;this._feedbackMiniMap=n;this._feedbackMiniMap.setDesiredSize({width:-1,height:-1});this._feedbackMiniMap.setView(this._mapView,null);this._feedbackMiniMap.mapTapped.add(function(n){return t._onMapTapped(n)});this._createPushpin(this._feedbackMiniMap.getView().cameraLocation);this._showMiniMapNavigationBar();this.disposables.push(this._feedbackMiniMap)},i.prototype._showMiniMapNavigationBar=function(){var t=this,n=this._feedbackMiniMap.getNavigationBar();n?(n.setLocateMeButtonVisible(!1),n.setMapStyleSelectorControlVisible(!1),n.setRadialMenuControlVisible(!1),n.setZoomInButtonVisible(!0),n.setZoomOutButtonVisible(!0)):this._feedbackMiniMap.navigationBarLoaded.addOne(function(){return t._showMiniMapNavigationBar()})},i.prototype._onMapTapped=function(n){this._pushpinState!=null?this._updatePushpin(n):this._createPushpin(n.location)},i.prototype._createPushpin=function(n){var t=this;this._feedbackMiniMap.getContainer().instanceAsyncAll([{name:"DefaultTemplateSelector"},{name:"ListDataSource"}],function(i){var u=i.ListDataSource,f=new st(n,ht.fromObject({showOverlay:!1,id:"MiniMapPushpin"}),"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAwCAMAAABOmSgnAAAAUVBMVEVHcEz///////////////////////////////////////////////////9mZmby8vLZ2dlAQECzs7OAgIBzc3OmpqZTU1MzMzPIyMjm5uaQkJBfDQ3jAAAADXRSTlMAnyBaELxwgOtAMI/PU1Op3wAAAXhJREFUeF61lNmSgyAQRdXEJZrLjtv/f+gMBloQzMNUzX3r8ki3xy6q/8qrP/L6QtSg1GVubIFNafYbrTagHXOmA1azUMwKdFemBt+XJDtHfWXE7AFrPTWLlOogZOgDhK5SxB1H8HDOzJEU5/QtaB4BAILmQkt+sAbG4ogN9YoXTW2WM0BUGJod23IHLRtCN3UPKd+vhz5q74exJSo1eg+xj7rU+Ecv81DtIMNxhcDNCU2Yw6fDt2IIKljUTpUhRdDD+daldto5fxxQg/V+cIGmOjLAlfKqQLpXMdCi7HcyLS3Lc+CyDEk+PCufHqoMKSeAjsJcWpUZ/iBvQfjzk6UT/vvT3aT1pb2M09ATDRjimypJTyusLK1uX13y9gdQDN75bYFNxozcULgzJtgYspgSgGSxk2GJolxWriiXRYrKaYYga+ZDU92kC7LW+DrJZenDOikqZYTbLEk3TjmT2yyVKcplZYpKfyf7HyVZpOhbw7xZnq6r/pQfjupFwssSP1cAAAAASUVORK5CYII=",new tt(13,32)),r;u.addPrimitive(f);r=new vt("DefaultLayer",u,i.DefaultTemplateSelector,1e4);r.primitiveMoveContinued.add(function(n){return t._updatePushpin(n)});r.primitiveMoveStopped.add(function(n){return t._updatePushpin(n)});t._feedbackMiniMap.getLayers().insert(r);t._pushpinState=new fr(f,u)})},i.prototype._updatePushpin=function(n){this._pushpinState.updatePushpinLocation(n.location)},i.prototype._onProblemTypeChanged=function(t,i){if(i!=null){this.subProblemTypes.clear();var r=[];this.setSubProblemType({text:n.L_Fdbk_SelectSubProblem,value:0});switch(i.value){case 1:r.push({text:n.L_Fdbk_RoadNameIncorrect,value:1},{text:n.L_Fdbk_RoadRemove,value:2},{text:n.L_Fdbk_RoadLocationIncorrect,value:3},{text:n.L_Fdbk_RoadMissing,value:4},{text:n.L_Fdbk_RoadClosed,value:5},{text:n.L_Fdbk_RoadTypeIncorrect,value:6},{text:n.L_Fdbk_RoadOneWay,value:7},{text:n.L_Fdbk_RoadTwoWay,value:8},{text:n.L_Fdbk_RoadOneWayOpposite,value:9},{text:n.L_Fdbk_Other,value:51});break;case 2:r.push({text:n.L_Fdbk_AddressMissing,value:10},{text:n.L_Fdbk_AddressLocationIncorrect,value:11},{text:n.L_Fdbk_AddressSideIncorrect,value:12},{text:n.L_Fdbk_AddressZipIncorrect,value:13},{text:n.L_Fdbk_AddressZipMissing,value:14},{text:n.L_Fdbk_Other,value:51});break;case 3:r.push({text:n.L_Fdbk_CityNameIncorrect,value:15},{text:n.L_Fdbk_CityLocationIncorrect,value:16},{text:n.L_Fdbk_CityMissing,value:17},{text:n.L_Fdbk_CityNeighborhood,value:18},{text:n.L_Fdbk_Other,value:51});break;case 4:r.push({text:n.L_Fdbk_NeighborhoodNameIncorrect,value:19},{text:n.L_Fdbk_NeighborhoodLocationIncorrect,value:20},{text:n.L_Fdbk_NeighborhoodMissing,value:21},{text:n.L_Fdbk_NeighborhoodCity,value:22},{text:n.L_Fdbk_Other,value:51});break;case 5:r.push({text:n.L_Fdbk_AdminDistrictsCountryBoundary,value:23},{text:n.L_Fdbk_AdminDistrictsStateBoundary,value:24},{text:n.L_Fdbk_AdminDistrictsCountyBoundary,value:25},{text:n.L_Fdbk_AdminDistrictsEntityMissing,value:26},{text:n.L_Fdbk_AdminDistrictsWrongEntity,value:27},{text:n.L_Fdbk_AdminDistrictsCountryName,value:28},{text:n.L_Fdbk_AdminDistrictsStateName,value:29},{text:n.L_Fdbk_AdminDistrictsCountyName,value:30},{text:n.L_Fdbk_Other,value:51});break;case 6:r.push({text:n.L_Fdbk_LandFeatureNameIncorrect,value:31},{text:n.L_Fdbk_LandTypeIncorrect,value:32},{text:n.L_Fdbk_LandFeatureMissing,value:33},{text:n.L_Fdbk_LandLocationIncorrect,value:34},{text:n.L_Fdbk_Other,value:51});break;case 7:r.push({text:n.L_Fdbk_WaterMissing,value:35},{text:n.L_Fdbk_WaterLocationIncorrect,value:36},{text:n.L_Fdbk_WaterNameIncorrect,value:37},{text:n.L_Fdbk_WaterTypeIncorrect,value:38},{text:n.L_Fdbk_Other,value:51});break;case 8:r.push({text:n.L_Fdbk_BridgeClosed,value:39},{text:n.L_Fdbk_BridgeNameIncorrect,value:40},{text:n.L_Fdbk_BridgeMissing,value:41},{text:n.L_Fdbk_BridgeRemoved,value:42},{text:n.L_Fdbk_BridgeLocationIncorrect,value:43},{text:n.L_Fdbk_Other,value:51});break;case 9:r.push({text:n.L_Fdbk_AirportIncorrect,value:45},{text:n.L_Fdbk_AirportMissing,value:46},{text:n.L_Fdbk_AirportWrongLocation,value:44},{text:n.L_Fdbk_Other,value:51});break;case 12:r.push({text:n.L_Fdbk_Other,value:51});break;default:r.push({text:n.L_Fdbk_SelectSubProblem,value:0})}this.subProblemTypes.insertAll(r)}},i.prototype._onSubProblemTypeChanged=function(){},i.prototype._isValid=function(){return this.getProblemType().value!=0||this.comments.length>0},i.prototype.submit=function(){if(this._isValid()){var n=s.getMapBounds(this._feedbackMiniMap,!1),t=s.getMapCenter(this._feedbackMiniMap),r=this._pushpinState?this._pushpinState.getLocation():t,u=s.getMercatorZoomLevel(this._feedbackMiniMap),f=this.getProblemType(),e=this.getSubProblemType(),o={FeedbackType:"Report a problem",SubScenario:i.GetStargateProblemValue(f.value),ProblemType:i.GetStargateSubProblemValue(e.value),ProblemDescription:this.comments,ProblemLocation:{Latitude:r.latitude,Longitude:r.longitude},MapViewCenter:{Latitude:t.latitude,Longitude:t.longitude},MapViewBoundingBox:{NELatLon:{Latitude:n.getNorth(),Longitude:n.getEast()},SWLatLon:{Latitude:n.getSouth(),Longitude:n.getWest()}},MapStyle:this._feedbackMiniMap.getMapType().displayName,Zoom:u,ReverseGeocodeAddress:{AddressLine:""}};this._mapsFeedback.sendSurfFeedback(o,"Maps.Basemap","Basemap",{})}},i.GetStargateProblemValue=function(n){var t="";switch(n){case 1:t="Problem with roads";break;case 2:t="Problem with addresses";break;case 5:t="Problem with admininistrative districts";break;case 9:t="Problem with airports";break;case 8:t="Problem with bridges";break;case 3:t="Problem with city";break;case 6:t="Problem with land features";break;case 4:t="Problem with neighborhoods";break;case 7:t="Problem with water bodies";break;case 12:t="Some other problem";break;default:case 0:t="No problem selected"}return t},i.GetStargateSubProblemValue=function(n){var t="";switch(n){case 1:t="Road name is incorrect or missing";break;case 2:t="Road needs to be removed";break;case 3:t="Road location is incorrect";break;case 4:t="Road is missing";break;case 5:t="Road is closed";break;case 6:t="Road type is incorrect (highway or street)";break;case 7:t="Road should be one way";break;case 8:t="Road should be two ways";break;case 9:t="Road is one way in the wrong direction";break;case 10:t="Address is missing from road";break;case 11:t="Address is in wrong location";break;case 12:t="Address is on the wrong side of the road";break;case 13:t="Postal code has incorrect zip code";break;case 14:t="Postal code is missing";break;case 15:t="City name is incorrect";break;case 16:t="City location is incorrect";break;case 17:t="City is missing";break;case 18:t="City should be neighborhood";break;case 19:t="Neighborhood name is incorrect";break;case 20:t="Neighborhood location is incorrect";break;case 21:t="Neighborhood is missing";break;case 22:t="Neighborhood should be city";break;case 23:t="The boundary between countries is incorrect";break;case 24:t="The boundary between states/provinces is incorrect";break;case 25:t="The boundary between counties is incorrect";break;case 26:t="A political entity is missing (country, state, county, province etc.)";break;case 27:t="Political entity is wrong type";break;case 28:t="Country has incorrect or missing name";break;case 29:t="State/province has incorrect or missing name";break;case 30:t="County has incorrect or missing name";break;case 31:t="Name of land feature is incorrect";break;case 32:t="Land feature is wrong type (forest should be a desert etc.)";break;case 33:t="Land feature is missing";break;case 34:t="Land feature is the wrong location";break;case 35:t="Water body is missing";break;case 36:t="Water body is in an incorrect location";break;case 37:t="Water body has incorrect name";break;case 38:t="Incorrect type of water body (ocean should be sea etc.)";break;case 39:t="Bridge is closed";break;case 40:t="Bridge name is incorrect or missing";break;case 41:t="Bridge is missing";break;case 42:t="Bridge needs to be removed";break;case 43:t="Bridge is in wrong location";break;case 44:t="Airport in wrong location";break;case 45:t="Airport has incorrect or missing name";break;case 46:t="Airport is missing";break;case 51:t="Something else";break;case 0:default:t="No subproblem selected"}return t},i}(rt),pt=function(i){function o(t,u,e,o){var s=i.call(this)||this,c,l,h;return s.resources=n,s._mapsFeedback=t,s._map=t.getMap(),s._taskbar=o,c=f.GlobalConfig.features,l=c.optIn,s.disposables.push(s._map.viewChanged.add(function(){s._map.isPanning()||s.hideMenu()})),s.disposables.push(s._map.mapTapped.add(function(){return s.hideMenu()})),s.disposables.push(s._map.mapZoomStarted.add(function(){return s.hideMenu()})),s.disposables.push(s._map.primitiveTapped.add(function(){return s.hideMenu()})),s.disposables.push(s._map.mapTapped.add(function(){s.hideMenu()})),s.disposables.push(s._map.mapPanStarted.add(function(){s.hideMenu()})),o&&(s.disposables.push(o.feedbackInitialize.add(function(n){s.startFeedbackTask(n,6)})),s.disposables.push(o.dismissFeedbackMenu.add(function(){s.hideMenu()})),s.disposables.push(o.focusFeedbackMenu.add(function(){s._onEnter()}))),s.setTemplate(new kt(si,{onFeedbackClick:function(n){n.preventDefault();var t=n.pageX==0&&n.pageY==0;s.menuOpen=!0;s.startFeedbackTask(r(n.target),7)},onMouseOver:function(n){n.preventDefault();s.menuOpen=!0;s.startFeedbackTask(r(n.target),7)},onMouseOut:function(){s.hideMenu()},displayControl:function(){return""}})),t.getMap()&&(s.disposables.push(t.getMap().mapModeChanged.add(function(n){s._ShowHideFeedback(n.newMode,u)})),h=t.getMap().getMode(),h&&s._ShowHideFeedback(h.mapModeType,u)),s._initFeedbackPopoutMenu(),s.showBetaButton(h.mapModeType),s.menuOpen=!1,s}return l(o,i),o.prototype._createDialog=function(n){var t=new n(this._mapsFeedback);return t&&t.OpenDialog(),t},o.prototype._ShowHideFeedback=function(n,t){var i=n!==2;u.showBetaButton&&this.getRootElement().set_style({display:i?"block":"none"});t.set_style({display:i?"inline":"none"})},o.prototype.showBetaButton=function(n){var f=h._isSmallMapShownOnSerp()?!0:!1,e=!u.showBetaButton||n===2||f,t=r(".bm_bottomRightOverlay")[0],i=t&&t.getBoundingClientRect()?t.getBoundingClientRect().top:50;i=this._map.getActualSize().height-i;this.getRootElement().set_style({display:e?"none":"flex",bottom:i+"px"})},o.prototype.startFeedbackTask=function(i,f){var l,a;if(this._map.getMode().mapModeType===2)window.open(r(".streetsideReportAProblemText").get_attr("href"),"_blank");else{var o=this._mapsFeedback.getActiveTask(),c=o&&o.id,s=[];o&&o.isReportable()&&(l=o.getReportOptions(),o.getReportType()===4?u.enableLocalFeedbackTask&&o.shoudEnableSuggestAnEdit()&&s.push(this._getListData(4,f,o.getTitle(),c,o.id,o.getLocalReportOptions())):s.push(this._getListData(o.getReportType()===7?5:3,f,o.getTitle(),c,o.id,l)));s.push(this._getListData(2,f,n.L_Fdbk_ReportAProblem,c));s.push(this._getListData(1,f,n.L_Fdbk_GeneralFeedback,c));this._menuListDropdownViewModel?(this._menuListDropdownViewModel.setDropdown(s),this._menuListDropdownViewModel.setButtonElement(i),this._popOutButtonViewModel.setDropdown(this._menuListDropdownViewModel)):(this._menuListDropdownViewModel=new ti(i),this._menuListDropdownViewModel.setDropdown(s),this._popOutButtonViewModel=new ei(this._menuListDropdownViewModel),a=this._popOutButtonViewModel.buildPopOut(),this._feedbackPopoutMenuElement.append(a));this._showMenu(s,i,f,o);h._setFocusOnFirstMenuItem(r(".feedbackPopOut"));t.log(e.Feedback,t.OpenPopoutMenu,{EP:t.getEntryPointLogValue(f)})}},o.prototype._showMenu=function(n,t,i){var f=this,u=t[0].getBoundingClientRect(),c=document.body.getBoundingClientRect(),e,o,s,a,l;if(i===1?(e=parseInt(r(".b_footer").get_style("height").replace("px","")),k.isMapsAnswer||(e+=10),this._feedbackPopoutMenuElement.set_style({left:u.right+"px",right:"",top:"",bottom:n.length===3?e+48+"px":e+23+"px"})):i===6?this._feedbackPopoutMenuElement.set_style({left:u.right+"px",right:"",top:u.top+"px"}):i===7?(u=this.getRootElement()[0].getBoundingClientRect(),o=r(".bm_bottomRightOverlay")[0],s=o&&o.getBoundingClientRect()?o.getBoundingClientRect().top:c.bottom,s=this._map.getActualSize().height-u.top,s+=20,a=n.length===3?25:0,this._feedbackPopoutMenuElement.set_style({right:c.right-u.right-1+"px",left:"",top:"",bottom:s+u.height+a+"px"}),this._feedbackPopoutMenuElement.set_style({"border-radius":"4px"})):this._feedbackPopoutMenuElement.set_style({right:c.right-(u.left+u.right)/2+"px",left:"",top:"",bottom:n.length===3?"147px":"122px"}),this._popOutButtonViewModel.setDropdownClass("feedbackPopOutTop"),this._popOutButtonViewModel.setIsDisplayed(!0),i===6){var v=r(window).get_scroll_pos().x,y=window.innerHeight/window.document.documentElement.offsetHeight*100<80,p=!(v===0||y),w=window.innerWidth,h=r(".feedbackPopOutTop",this._feedbackPopoutMenuElement[0]).get_style("width");h=Number(h.replace("px",""));this._popOutButtonViewModel.setIsDisplayed(!1);l=u.right;l=p||w<u.right+h?u.left+v:u.right+h;this._feedbackPopoutMenuElement.set_style({left:l+"px"});this.disposables.push(this._popOutButtonViewModel.popOutHidden.add(function(){f._taskbar.dismissMenu.invoke()}));this._popOutButtonViewModel.setIsDisplayed(!0)}r(".dropdownEntry",this._feedbackPopoutMenuElement[0]).add_event("blur",function(n){f._onBlur(n)});r(".dropdownEntry",this._feedbackPopoutMenuElement[0]).add_event("keydown",function(n){f._onKeyDown(n)});r(".feedbackPopOutTop",this._feedbackPopoutMenuElement[0]).add_event("mouseout",function(n){f._onMouseOut(n)});r(".popOutInner",this._feedbackPopoutMenuElement[0]).add_event("pointerout",function(n){f._onMouseOut(n)})},o.prototype.hideMenu=function(){var n=this;window.clearTimeout(o._mouseOverDelayHandle);o._mouseOverDelayHandle=Microsoft.Maps.setTimeout(function(){var t;if(!n.menuOpen){var i=n._feedbackPopoutMenuElement[0]&&n._feedbackPopoutMenuElement.select(".dropdownEntry"),u=!1,f=n._feedbackPopoutMenuElement[0],r=f&&f.getElementsByClassName("feedbackPopOutTop")[0];if(r&&(r.querySelector(":hover")||r.querySelector(":active")||r.querySelector(":focus")))for(t=0;t<i.length;t++)if(i[t].parentElement.querySelector(":hover")||i[t].parentElement.querySelector(":active")||i[t].parentElement.querySelector(":focus")||i[t].querySelector(":focus")||i[t].querySelector(":hover")||i[t].querySelector(":active")){u=!0;break}u||n._popOutButtonViewModel&&n._popOutButtonViewModel.setIsDisplayed(!1)}},o._mouseTimeout)},o.prototype._onMouseOut=function(){var n=this;window.clearTimeout(o._mouseOverDelayHandle);o._mouseOverDelayHandle=Microsoft.Maps.setTimeout(function(){for(var i=n._feedbackPopoutMenuElement[0]&&n._feedbackPopoutMenuElement.select(".dropdownEntry"),t=0;t<i.length;t++)r(i[t]).remove_event("blur",function(t){n._onBlur(t)}),i[t].blur();n.hideMenu()},o._mouseTimeout-50)},o.prototype._onBlur=function(){this.hideMenu()},o.prototype._onEnter=function(){var n=this._feedbackPopoutMenuElement.select(".dropdownEntry");n.length>0&&n[0].focus()},o.prototype._onKeyDown=function(n){var t=n,i=t.keyCode||t.which,u,f;i===9&&t.shiftKey||i===37?t.srcElement===this._feedbackPopoutMenuElement.select(".dropdownEntry")[0]&&(this._taskbar.hoverFeedbackButton.invoke(),this.hideMenu()):i===40?(u=n.target.nextElementSibling,u&&r(u)[0].focus()):i===38&&(f=n.target.previousElementSibling,f&&r(f)[0].focus())},o.prototype._getListData=function(t,i,r,u,f,e){var o=r;return t===4?(o=n.L_Menu_SuggestAnEdit_Link_Text+" - "+r,r=o):(t===3||t===5)&&(o=h._formatString(n.L_Fdbk_ActiveCard,r)),{name:o,options:{type:y.feedbackTask,activateOptions:{parentId:f},state:{entryPoint:i,feedbackTaskType:t,activeTaskId:u,title:r,options:e}}}},o.prototype._initFeedbackPopoutMenu=function(){this._feedbackPopoutMenuElement=h._createElement("div");this._feedbackPopoutMenuElement.set_attr("class","feedbackPopOut");this._map.getRootElement().getParent().append(this._feedbackPopoutMenuElement)},o._mouseTimeout=100,o}(rt),ri=function(){function n(n,t,i,r,f,e,o){var s=this,h,c;this._taskBar=t;this._taskManager=i;this._permalink=r;this._map=n;this._menuClickOpen=!1;this._betaFeedbackLinksViewModel=new pt(this,f,o,this._taskBar);u.showBetaButton&&(h=this._betaFeedbackLinksViewModel.getRootElement(),c=n.getRootElement(),c.getParent().append(h));e&&e.set_style({display:"none"});f.add_event("click",function(n){n.stopImmediatePropagation();n.preventDefault();s._betaFeedbackLinksViewModel.menuOpen;s._menuClickOpen=!0;s._betaFeedbackLinksViewModel.startFeedbackTask(f,1)});f.add_event("mouseover",function(n){n.stopImmediatePropagation();n.preventDefault();s._betaFeedbackLinksViewModel.menuOpen=!0;s._menuClickOpen=!1;s._betaFeedbackLinksViewModel.startFeedbackTask(f,1)});f.add_event("mouseout",function(n){n.stopImmediatePropagation();n.preventDefault();s._menuClickOpen||(s._betaFeedbackLinksViewModel.menuOpen=!1);s._betaFeedbackLinksViewModel.hideMenu()});ut.getFunctionalTestHooksEnabled()&&ut.addDataTag(f,"Feedback.Handler.Attached");Feedback.Bootstrap.InitializeFeedback({structured:!0},"mapsOptOut",!1,!0,!1)}return n.prototype.getMap=function(){return this._map},n.prototype.getMapView=function(){return this._map.getView()},n.prototype.getMapType=function(){return this._map.getMapType().id},n.prototype.getMapZoom=function(){return s.getMercatorZoomLevel(this._map)},n.prototype.getActiveTask=function(){var n=this._taskManager.getFocusedStack();return n&&n.getForegroundTask()},n.prototype.showOrHideBetaButton=function(){this._betaFeedbackLinksViewModel.showBetaButton(this.getMap().getMode().mapModeType)},n.prototype.sendSurfFeedback=function(n,t,r,u){if(n.ImpressionGuid=_G.IG,n.ReproURL=this._getReproUrl(),n.SchemaVersion=i.SchemaVersion,n.ClientType=i.ClientType_MapWebsite,n.ClientMarket=k.dynamicProperties.market.toLowerCase(),n.html=this._getScreenShot(),n.width=_w.innerWidth,n.height=_w.innerHeight,n.partner=i.Partner_SUrFLegacy,!n.Query){var f=this._taskBar.getSearchTerm();f&&(n.Query=f)}this._postToSurf(n,t,r,u)},n.prototype.sendLocalFeedback=function(n,t,r,f){var s,h,c,e,a;r===void 0&&(r=!1);f===void 0&&(f=1);var l="Local",o="Page2.1";switch(f){case 2:o=i.FeedbackType_DSAT;n.ReproURL=this._getReproUrl();n.SchemaVersion=i.SchemaVersion;n.ClientMarket=k.dynamicProperties.market.toLowerCase();n.Query||(s=this._taskBar.getSearchTerm(),s&&(n.Query=s));break;case 3:o="RichAttribute"}h="MapsV8";c="1.0";n.Referrer=this._getReproUrl();n.RapDebugId=this.GUID();r||(e={},e.ct=h,e.ft=o,e.cv=c,e.src=l,e.id=t,this._postToLocalFeedback(u.surfApiEndpoint,n,e));a={};n.Identifier=t;n.FeedbackType=o;n.ClientType=h;n.ClientVersion=c;n.Source=l;n.Issue="Business Suggestion";n.ImpressionGuid=_G.IG;n.partner="LocalBusinessFeedback";this._postToLocalFeedback(u.surfApiEndpointV2,n,a)},n.prototype.sendLocalReportProblemFeedback=function(n,t){var i;n.Referrer=this._getReproUrl();n.RapDebugId=this.GUID();i={};n.Identifier=t;n.FeedbackType="Page2.1";n.ClientType="MapsV8";n.ClientVersion="1.0";n.Source="Local";n.Issue="Business Suggestion";n.ImpressionGuid=_G.IG;n.partner="LocalBusinessFeedback";this._postToLocalFeedback(u.surfApiEndpointV2,n,i)},n.prototype._postToLocalFeedback=function(n,t,i){var u={},f;u["Content-Type"]="application/json";f={queryParameters:i,headers:u};g.doPost(n,r.Internals.stringify(t),f)},n.prototype.getRandomNumber=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},n.prototype.GUID=function(){return(this.getRandomNumber()+this.getRandomNumber()+this.getRandomNumber()+this.getRandomNumber()+this.getRandomNumber()+this.getRandomNumber()+this.getRandomNumber()+this.getRandomNumber()).toLowerCase()},n.prototype._postToSurf=function(n,t,i,f){g.doPost(u.surfApiEndpointV2,r.Internals.stringify(n),f)},n.prototype.takeScreenShot=function(){this._screenShot=Feedback.PackageLoad.GetHTML()},n.prototype._getScreenShot=function(){return this._screenShot?this._screenShot:Feedback.PackageLoad.GetHTML()},n.prototype.generateReproUrl=function(){var n=this;this._permalink.getGeneralPermalink(this._map,function(t){n._reproUrl=t.permalink},function(){return n._reproUrl=""},ni.Feedback)},n.prototype._getReproUrl=function(){return this._reproUrl},n}(),er=function(t){function i(i,r){var u=this,f={};return u=t.call(this,f)||this,u.resources=n,u._panelViewModel=r,f.defineProperty("directionsIssueStep"),f.defineProperty("commentsDirectionsStep"),u._prePopulateDirectionsStepDropdowns(i),u}return l(i,t),i.prototype._prePopulateDirectionsStepDropdowns=function(t){var i=this;this.directionsSteps=[];this.directionsSteps.push({text:n.L_Fdbk_SelectSubProblem,value:""});t.forEach(function(n){i.directionsSteps.push({text:n,value:n})});this.setDirectionsIssueStep({text:n.L_Fdbk_SelectSubProblem,value:""})},i}(ht);f.MapsFeedback=ri;f.FeedbackTask=ur;f.CommonControls.BetaFeedbackLinksViewModel=pt}catch(wt){if(f.logger)f.logger.logCriticalError(wt);else throw wt;}}).call(window)